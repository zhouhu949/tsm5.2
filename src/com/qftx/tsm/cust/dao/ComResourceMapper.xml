<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.qftx.tsm.cust.dao.ComResourceMapper">
  <!-- 基础结果集 -->
	<resultMap type="com.qftx.tsm.cust.bean.ResCustInfoBean" id="BaseResultMap">
		<id column="RES_CUST_ID" property="resCustId" jdbcType="VARCHAR" />
		<result column="NAME" property="name" jdbcType="VARCHAR" />
		<result column="MOBILEPHONE" property="mobilephone" jdbcType="VARCHAR" />
		<result column="TELPHONE" property="telphone" jdbcType="VARCHAR" />
		<result column="COMPANY" property="company" jdbcType="VARCHAR" />
		<result column="DUTY" property="duty" jdbcType="VARCHAR" />
		<result column="SEX" property="sex" jdbcType="DECIMAL" />
		<result column="COMPANY_ADDR" property="companyAddr" jdbcType="VARCHAR" />
		<result column="COMPANY_ORG" property="companyOrg" jdbcType="VARCHAR" />
		<result column="REMARK" property="remark" jdbcType="VARCHAR" />
		<result column="TYPE" property="type" jdbcType="DECIMAL" />
		<result column="IS_DEL" property="isDel" jdbcType="DECIMAL" />
		<result column="RES_LAST_CALL_DATE" property="resLastCallDate" jdbcType="TIMESTAMP" />
		<result column="INPUT_DATE" property="inputDate" jdbcType="TIMESTAMP" />
		<result column="INPUT_ACC" property="inputAcc" jdbcType="VARCHAR" />
		<result column="UPDATE_DATE" property="updateDate" jdbcType="TIMESTAMP" />
		<result column="UPDATE_ACC" property="updateAcc" jdbcType="VARCHAR" />
		<result column="IS_MAJOR" property="isMajor" jdbcType="DECIMAL" />
		<result column="RES_GROUP_ID" property="resGroupId" jdbcType="VARCHAR" />
		<result column="OWNER_ACC" property="ownerAcc" jdbcType="VARCHAR" />
		<result column="OWNER_NAME" property="ownerName" jdbcType="VARCHAR" />
		<result column="STATUS" property="status" jdbcType="DECIMAL" />
		<result column="ORG_ID" property="orgId" jdbcType="VARCHAR" />
		<result column="SIGN_DATE" property="signDate" jdbcType="TIMESTAMP" />
		<result column="INPUT_STATUS" property="inputStatus" jdbcType="DECIMAL" />
		<result column="OWNER_START_DATE" property="ownerStartDate" jdbcType="TIMESTAMP" />
		<result column="FILTER_COUNT" property="filterCount" jdbcType="DECIMAL" />
		<result column="FILTER_TYPE" property="filterType" jdbcType="DECIMAL" />
		<result column="OPREATE_TYPE" property="opreateType" jdbcType="DECIMAL" />
		<result column="COORDINATES" property="coordinates" jdbcType="VARCHAR" />
		<result column="FAX" property="fax" jdbcType="VARCHAR" />
		<result column="EMAIL" property="email" jdbcType="VARCHAR" />
		<result column="UNITHOME" property="unithome" jdbcType="VARCHAR" />
		<result column="UNITINTRODUCTION" property="unitintroduction" jdbcType="VARCHAR" />
		<result column="AMOYTOCUSTOMER_DATE" property="amoytocustomerDate" jdbcType="TIMESTAMP" />
		<result column="QQ" property="qq" jdbcType="VARCHAR" />
		<result column="KEYWORD" property="keyWord" jdbcType="VARCHAR" />
		<result column="CONTRACT_NUMBER" property="contractNumber" jdbcType="VARCHAR" />
		<result column="DEFINED1" property="defined1" jdbcType="VARCHAR" />
		<result column="DEFINED2" property="defined2" jdbcType="VARCHAR" />
		<result column="DEFINED3" property="defined3" jdbcType="VARCHAR" />
		<result column="DEFINED4" property="defined4" jdbcType="VARCHAR" />
		<result column="DEFINED5" property="defined5" jdbcType="VARCHAR" />
		<result column="SIGN_ACC" property="signAcc" jdbcType="VARCHAR" />
		<result column="SIGN_NAME" property="signName" jdbcType="VARCHAR" />
		<result column="NEXTFOLLOW_DATE" property="nextFollowDate" jdbcType="TIMESTAMP" />
		<result column="BIRTHDAY" property="birthday" jdbcType="TIMESTAMP" />
		<result column="CALL_DATE_POSTPONED" property="callDatePostponed" jdbcType="TIMESTAMP" />
		<result column="REASON_FOR_CALLDELAY" property="reasonForCalldelay" jdbcType="VARCHAR" />
		<result column="ALTERNATE_PHONE2" property="alternatePhone2" jdbcType="VARCHAR" />
		<result column="RECUCLING_TYPE_DETAILS" property="recuclingTypeDetails" jdbcType="VARCHAR" />
		<result column="AGAINWASH_COUNT" property="againwashCount" jdbcType="DECIMAL" />
		<result column="ACTION_DATE" property="actionDate" jdbcType="TIMESTAMP" />
		<result column="LAST_CUST_FOLLOW_ID" property="lastCustFollowID" jdbcType="VARCHAR" />
		<result column="SERVICE_ACC" jdbcType="VARCHAR" property="serviceAcc" />
		<result column="SERVICE_NAME" jdbcType="VARCHAR" property="serviceName" />
		<result column="SERVICE_LEVEL" jdbcType="VARCHAR" property="serviceLevel" />
		<result column="VISITING_DATE" jdbcType="TIMESTAMP" property="visitingDate" />
		<result column="NEXT_VISITING_DATE" jdbcType="TIMESTAMP" property="nextVisitingDate" />
		<result column="SERVICE_LABEL_CODE" jdbcType="VARCHAR" property="serviceLabelCode" />
		<result column="SERVICE_LABEL_NAME" jdbcType="VARCHAR" property="serviceLabelName" />
		<result column="IS_PRECEDENCE" jdbcType="DECIMAL" property="isPrecedence" />
		<result column="FOR_THE_CUSTOMER_TIME" jdbcType="TIMESTAMP" property="forTheCustomerTime" />
		<result column="LAST_VISIT_ACC" jdbcType="VARCHAR" property="lastVisitAcc" />
		
		<!-- 4.0新增 -->
		<result column="STATE" jdbcType="DECIMAL" property="state"/>
		<result column="PLAN_DATE" jdbcType="TIMESTAMP" property="planDate"/>
		<result column="ADDRESS" jdbcType="VARCHAR" property="address"/>
		<result column="COMPANY_MONEY" jdbcType="VARCHAR" property="companyMoney"/>
		<result column="COMPANY_USER" jdbcType="VARCHAR" property="companyUser"/>
		<result column="COMPANY_TRADE" jdbcType="VARCHAR" property="companyTrade"/>
		<result column="COMPANY_FAX" jdbcType="VARCHAR" property="companyFax"/>
		<result column="LOSING_ID" jdbcType="VARCHAR" property="losingId"/>
		<result column="LOSING_REMARK" jdbcType="VARCHAR" property="losingRemark"/>
		<result column="PROVINCE_ID" jdbcType="DECIMAL" property="provinceId"/>
		<result column="CITY_ID" jdbcType="DECIMAL" property="cityId"/>
		<result column="COUNTY_ID" jdbcType="DECIMAL" property="countyId"/>
		<result column="LAST_LOG_ID" jdbcType="VARCHAR" property="lastLogId"/>
		<result column="IS_concat" jdbcType="DECIMAL" property="isConcat" />
		<result column="SCOPE" jdbcType="VARCHAR" property="scope"/>
		<result column="MAIN_LINKMAN" jdbcType="VARCHAR" property="mainLinkman"/>
		<result column="IMPORT_DEPT_ID" jdbcType="VARCHAR" property="importDeptId"/>
		<result column="DEFINED6" property="defined6" jdbcType="VARCHAR" />
		<result column="DEFINED7" property="defined7" jdbcType="VARCHAR" />
		<result column="DEFINED8" property="defined8" jdbcType="VARCHAR" />
		<result column="DEFINED9" property="defined9" jdbcType="VARCHAR" />
		<result column="DEFINED10" property="defined10" jdbcType="VARCHAR" />	
	    <result column="tao_No" property="taoNo" jdbcType="DECIMAL" />	
	    <result column="LIFE_CODE" jdbcType="VARCHAR" property="lifeCode"/>		
		<result column="last_Option_Id" jdbcType="VARCHAR" property="lastOptionId" />
		<result column="last_Loss_Date" property="lastLossDate" jdbcType="TIMESTAMP" />
	    <result column="last_Cust_Type_Id" jdbcType="VARCHAR" property="lastCustTypeId"/>	
	    <result column="label_Code" jdbcType="VARCHAR" property="labelCode"/>	
	    <result column="label_Name" jdbcType="VARCHAR" property="labelName"/>
		<result column="DEFINED11" property="defined11" jdbcType="VARCHAR" />
		<result column="DEFINED12" property="defined12" jdbcType="VARCHAR" />
		<result column="DEFINED13" property="defined13" jdbcType="VARCHAR" />
		<result column="DEFINED14" property="defined14" jdbcType="VARCHAR" />
		<result column="DEFINED15" property="defined15" jdbcType="VARCHAR" />	
		<result column="DEFINED16" property="defined16" jdbcType="TIMESTAMP" />			
		<result column="DEFINED17" property="defined17" jdbcType="TIMESTAMP" />			
		<result column="DEFINED18" property="defined18" jdbcType="TIMESTAMP" />	 
		<!-- 5.0新增 -->     
		<result column="COMMON_ACC" property="commonAcc" jdbcType="VARCHAR" />
		<!-- 5.1新增 -->
		<result column="OWNER_ACTION_DATE" property="ownerActionDate" jdbcType="TIMESTAMP" />
		<result column="SOURCE" property="source" jdbcType="DECIMAL" />
				     		    	    
	</resultMap>
	
		<resultMap type="com.qftx.tsm.cust.bean.ResCustInfoBean" id="MinResultMap">
		<id column="RES_CUST_ID" property="resCustId" jdbcType="VARCHAR" />
	</resultMap>	
	<resultMap type="com.qftx.tsm.cust.dto.ResCustDto" id="compResMap"
		extends="BaseResultMap">
		<result column="group_name" property="groupName" jdbcType="VARCHAR" />
		<result column="dept_name" property="deptName" jdbcType="VARCHAR" />
		<result column="ownerName" property="ownerName" jdbcType="VARCHAR" />
		<result column="serviceLevelName" property="serviceLevelName"
			jdbcType="VARCHAR" />
		<result column="SALE_PROCESS_ID" property="saleProcessId"
			jdbcType="VARCHAR" />
		<result column="SALE_PROCESS" property="saleProcess" jdbcType="VARCHAR" />
		<result column="LABEL_CODE" property="labelCode" jdbcType="VARCHAR" />
		<result column="LAST_ACTION_DATE" property="lastActionDate"
			jdbcType="TIMESTAMP" />
		<result column="SERVICE_LABEL_CODE" property="serviceLabelCode"
			jdbcType="VARCHAR" />
		<result column="DEFINED1" property="defined1" jdbcType="VARCHAR" />
		<result column="DEFINED2" property="defined2" jdbcType="VARCHAR" />
		<result column="DEFINED3" property="defined3" jdbcType="VARCHAR" />
		<result column="DEFINED4" property="defined4" jdbcType="VARCHAR" />
		<result column="DEFINED5" property="defined5" jdbcType="VARCHAR" />			
		<result column="DEFINED6" property="defined6" jdbcType="VARCHAR" />
		<result column="DEFINED7" property="defined7" jdbcType="VARCHAR" />
		<result column="DEFINED8" property="defined8" jdbcType="VARCHAR" />
		<result column="DEFINED9" property="defined9" jdbcType="VARCHAR" />
		<result column="DEFINED10" property="defined10" jdbcType="VARCHAR" />				
		<result column="DEFINED11" property="defined11" jdbcType="VARCHAR" />
		<result column="DEFINED12" property="defined12" jdbcType="VARCHAR" />
		<result column="DEFINED13" property="defined13" jdbcType="VARCHAR" />
		<result column="DEFINED14" property="defined14" jdbcType="VARCHAR" />
		<result column="DEFINED15" property="defined15" jdbcType="VARCHAR" />			
		<result column="DEFINED16" property="defined16" jdbcType="TIMESTAMP" />			
		<result column="DEFINED17" property="defined17" jdbcType="TIMESTAMP" />			
		<result column="DEFINED18" property="defined18" jdbcType="TIMESTAMP" />
		<!-- 5.0新增 -->     
		<result column="COMMON_ACC" property="commonAcc" jdbcType="VARCHAR" />			
	</resultMap>
	
	<resultMap type="com.qftx.tsm.cust.dto.ResourceCallNumDto" id="resCallNumMap">
	    <id column="ID" property="id" jdbcType="VARCHAR" />
	    <result column="CUST_ID" property="custId" jdbcType="VARCHAR" />
	    <result column="CALL_CONNECT" property="callConnect" jdbcType="DECIMAL" />
	    <result column="CALL_TOTAL" property="callTotal" jdbcType="DECIMAL" />
	    <result column="ORG_ID" property="orgId" jdbcType="VARCHAR" />
	</resultMap>
	
		<!-- 资源客户实体扩展 -->
	<resultMap type="com.qftx.tsm.cust.dto.ResCustDto" id="ResCustResultMap"
		extends="BaseResultMap">
		<result column="GROUP_NAME" property="groupName" jdbcType="VARCHAR" />
		<result column="INPUTERNAME" property="inputerName" jdbcType="VARCHAR" />
		<result column="OWNERNAME" property="ownerName" jdbcType="VARCHAR" />
		<result column="OPTION_NAME" property="optionName" jdbcType="VARCHAR"/>
	</resultMap>
	
	<!-- 获取淘客户缓存值 -->
	<resultMap type="com.qftx.tsm.cust.dto.TaoResDto" id="taoResDtoList">
		<result column="name" property="name" jdbcType="VARCHAR" />
		<result column="MAIN_LINKMAN" property="phone" jdbcType="VARCHAR" />
		<result column="FILTER_type" property="filterType" jdbcType="DECIMAL" />
		<result column="RES_CUST_ID" property="resId" jdbcType="VARCHAR"/>	
		<result column="status" property="status" jdbcType="DECIMAL"/>
		<result column="iscall" property="isCall" jdbcType="DECIMAL"/>
        <result column="phone" property="phone" jdbcType="VARCHAR"/>
        <result column="CALL_DATE_POSTPONED" property="callDatePostponed" jdbcType="VARCHAR"/>
        <result column="reason_for_calldelay" property="reasonForCalldelay" jdbcType="VARCHAR"/>
	</resultMap>
	<!-- 实体表名 -->
	<sql id="table_name">TSM_RES_CUST_INFO</sql>
	
	<!-- 实体条件查询组装 -->
	<sql id="entity_condition_orderby">
		<if test="orgId != null and orgId !=''">
			and ORG_ID = #{orgId,jdbcType=VARCHAR}
		</if>
		<if test="resCustId != null and resCustId!=''">
			and RES_CUST_ID = #{resCustId,jdbcType=VARCHAR}
		</if>
		<if test="name != null and name !=''">
			and NAME like '%'||#{name}||'%'
		</if>
		<if test="mobilephone != null and mobilephone !=''">
			and MOBILEPHONE like '%'||#{mobilephone}||'%'
		</if>
		<if test="telphone != null and telphone !=''">
			and TELPHONE like '%'||#{telphone}||'%'
		</if>
		<if test="company != null and company !=''">
			and COMPANY like '%'||#{company}||'%'
		</if>
		<if test="duty != null and duty !=''">
			and DUTY like '%'||#{duty}||'%'
		</if>
		<if test="sex != null and sex !=''">
			and SEX = #{sex,jdbcType=VARCHAR}
		</if>
		<if test="companyAddr != null and companyAddr !=''">
			and COMPANY_ADDR like '%'||#{companyAddr}||'%'
		</if>
		<if test="companyOrg != null and companyOrg !=''">
			and COMPANY_ORG like '%'||#{companyOrg}||'%'
		</if>
		<if test="remark != null and remark !=''">
			and REMARK like '%'||#{remark}||'%'
		</if>
		<if test="type != null">
			and TYPE = #{type,jdbcType=DECIMAL}
		</if>
		<if test="isDel != null">
			and IS_DEL = #{isDel,jdbcType=DECIMAL}
		</if>
		<if test="resLastCallDate != null">
			and RES_LAST_CALL_DATE =
			#{resLastCallDate,jdbcType=TIMESTAMP}
		</if>
		<if test="inputDate != null">
			and INPUT_DATE = #{resLastCallDate,jdbcType=TIMESTAMP}
		</if>
		<if test="inputAcc != null and inputAcc !=''">
			and INPUT_ACC = #{inputAcc,jdbcType=VARCHAR}
		</if>
		<if test="updateDate != null">
			and UPDATE_DATE = #{updateDate,jdbcType=TIMESTAMP}
		</if>
		<if test="updateAcc != null and updateAcc !=''">
			and UPDATE_ACC = #{updateAcc,jdbcType=VARCHAR}
		</if>
		<if test="isMajor != null">
			and IS_MAJOR = #{isMajor,jdbcType=DECIMAL}
		</if>
		<if test="resGroupId != null and resGroupId !=''">
			and RES_GROUP_ID = #{resGroupId,jdbcType=VARCHAR}
		</if>
		<if test="ownerAcc != null and ownerAcc !=''">
			and OWNER_ACC = #{ownerAcc,jdbcType=VARCHAR}
		</if>		
		<if test="status != null">
			and STATUS = #{status,jdbcType=DECIMAL}
		</if>
		<if test="signDate != null">
			and SIGN_DATE = #{signDate,jdbcType=TIMESTAMP}
		</if>
		<if test="inputStatus != null">
			and INPUT_STATUS = #{inputStatus,jdbcType=DECIMAL}
		</if>
		<if test="ownerStartDate != null">
			and OWNER_START_DATE =
			#{ownerStartDate,jdbcType=TIMESTAMP}
		</if>
		<if test="filterCount != null">
			and FILTER_COUNT = #{filterCount,jdbcType=DECIMAL}
		</if>
		<if test="filterType != null">
			and FILTER_TYPE = #{filterType,jdbcType=DECIMAL}
		</if>
		<if test="opreateType != null">
			and OPREATE_TYPE = #{opreateType,jdbcType=DECIMAL}
		</if>
		<if test="fax != null and fax !=''">
			and FAX = #{fax,jdbcType=VARCHAR}
		</if>
		<if test="email != null and email !=''">
			and EMAIL = #{email,jdbcType=VARCHAR}
		</if>
		<if test="unithome != null and unithome !=''">
			and UNITHOME = #{unithome,jdbcType=VARCHAR}
		</if>
		<if test="unitintroduction != null and unitintroduction !=''">
			and UNITINTRODUCTION =
			#{unitintroduction,jdbcType=VARCHAR}
		</if>
		<if test="amoytocustomerDate != null">
			and AMOYTOCUSTOMER_DATE =
			#{amoytocustomerDate,jdbcType=TIMESTAMP}
		</if>
		<if test="qq != null">
			and QQ = #{qq,jdbcType=VARCHAR}
		</if>
		<if test="keyWord != null">
			and KEYWORD = #{keyWord,jdbcType=VARCHAR}
		</if>
		<if test="contractNumber != null and contractNumber !=''">
			and CONTRACT_NUMBER like '%'||#{contractNumber}||'%'
		</if>
		<if test="defined1 != null">
			and DEFINED1 = #{defined1,jdbcType=VARCHAR}
		</if>
		<if test="defined2 != null">
			and DEFINED2 = #{defined2,jdbcType=VARCHAR}
		</if>
		<if test="defined3 != null">
			and DEFINED3 = #{defined3,jdbcType=VARCHAR}
		</if>
		<if test="defined4 != null">
			and DEFINED4 = #{defined4,jdbcType=VARCHAR}
		</if>
		<if test="defined5 != null">
			and DEFINED5 = #{defined5,jdbcType=VARCHAR}
		</if>
		<if test="defined6 != null">
			and DEFINED6 = #{defined6,jdbcType=VARCHAR}
		</if>
		<if test="defined7 != null">
			and DEFINED7 = #{defined7,jdbcType=VARCHAR}
		</if>
		<if test="defined8 != null">
			and DEFINED8 = #{defined8,jdbcType=VARCHAR}
		</if>
		<if test="defined9 != null">
			and DEFINED9 = #{defined9,jdbcType=VARCHAR}
		</if>
		<if test="defined10 != null">
			and DEFINED10 = #{defined10,jdbcType=VARCHAR}
		</if>
		<if test="defined11 != null">
			and DEFINED11 = #{defined11,jdbcType=VARCHAR}
		</if>
		<if test="defined12 != null">
			and DEFINED12 = #{defined12,jdbcType=VARCHAR}
		</if>
		<if test="defined13 != null">
			and DEFINED13 = #{defined13,jdbcType=VARCHAR}
		</if>
		<if test="defined14 != null">
			and DEFINED14 = #{defined14,jdbcType=VARCHAR}
		</if>
		<if test="defined15 != null">
			and DEFINED15 = #{defined15,jdbcType=VARCHAR}
		</if>				
		<if test="alternatePhone2 != null">
			and ALTERNATE_PHONE2 = #{alternatePhone2,jdbcType=VARCHAR}
		</if>
		<if test="signAcc != null">
			and SIGN_ACC = #{signAcc,jdbcType=VARCHAR}
		</if>
		<if test="signName != null">
			and SIGN_NAME = #{signName,jdbcType=VARCHAR}
		</if>
		<if test="nextFollowDate != null">
			and NEXTFOLLOW_DATE = #{nextFollowDate,jdbcType=TIMESTAMP}
		</if>
		<if test="birthday != null">
			and BIRTHDAY = #{birthday,jdbcType=TIMESTAMP}
		</if>
		<if test="callDatePostponed != null">
			and CALL_DATE_POSTPONED =
			#{callDatePostponed,jdbcType=TIMESTAMP}
		</if>
		<if test="reasonForCalldelay != null">
			and REASON_FOR_CALLDELAY =
			#{reasonForCalldelay,jdbcType=VARCHAR}
		</if>
		<if test="recuclingTypeDetails != null">
			and RECUCLING_TYPE_DETAILS =
			#{recuclingTypeDetails,jdbcType=VARCHAR}
		</if>
		<if test="againwashCount != null">
			and AGAINWASH_COUNT = #{againwashCount,jdbcType=DECIMAL}
		</if>
		<if test="actionDate != null">
			and ACTION_DATE = #{actionDate,jdbcType=TIMESTAMP}
		</if>
		<if test="lastCustFollowID != null">
			and LAST_CUST_FOLLOW_ID =
			#{lastCustFollowID,jdbcType=VARCHAR}
		</if>
		<if test="serviceAcc != null">
			and SERVICE_ACC = #{serviceAcc,jdbcType=VARCHAR}
		</if>
		<if test="serviceName != null">
			and SERVICE_NAME = #{serviceName,jdbcType=VARCHAR}
		</if>
		<if test="serviceLevel != null">
			and SERVICE_LEVEL = #{serviceLevel,jdbcType=VARCHAR}
		</if>
		<if test="serviceName != null">
			and VISITING_DATE = #{visitingDate,jdbcType=TIMESTAMP}
		</if>
		<if test="nextVisitingDate != null">
			and NEXT_VISITING_DATE =
			#{nextVisitingDate,jdbcType=TIMESTAMP}
		</if>
		<if test="serviceLabelCode != null">
			and SERVICE_LABEL_CODE =
			#{serviceLabelCode,jdbcType=VARCHAR}
		</if>
		<if test="serviceLabelName != null">
			and SERVICE_LABEL_NAME =
			#{serviceLabelName,jdbcType=VARCHAR}
		</if>
		<if test="isPrecedence != null">
			and IS_PRECEDENCE =
			#{isPrecedence,jdbcType=DECIMAL}
		</if>
		<if test="forTheCustomerTime != null">
			and FOR_THE_CUSTOMER_TIME =
			#{forTheCustomerTime,jdbcType=TIMESTAMP}
		</if>
		<if test="lastVisitAcc != null">
			and LAST_VISIT_ACC =
			#{lastVisitAcc,jdbcType=VARCHAR}
		</if>	
		<if test="state != null">
			and STATE = #{state,jdbcType=DECIMAL} 
		</if>	
		<if test="planDate != null">
			and PLAN_DATE = #{planDate,jdbcType=TIMESTAMP} 
		</if>
		<if test="address != null">
			and ADDRESS = #{address,jdbcType=VARCHAR} 
		</if>
		<if test="companyMoney != null">
			and COMPANY_MONEY = #{companyMoney,jdbcType=VARCHAR} 
		</if>
		<if test="companyUser != null">
			and COMPANY_USER = #{companyUser,jdbcType=VARCHAR} 
		</if>
		<if test="companyTrade != null">
			and COMPANY_TRADE = #{companyTrade,jdbcType=VARCHAR} 
		</if>
		<if test="companyFax != null">
			and COMPANY_FAX = #{companyFax,jdbcType=VARCHAR} 
		</if>
		<if test="losingId != null">
			and LOSING_ID = #{losingId,jdbcType=VARCHAR} 
		</if>
		<if test="losingRemark != null">
			and LOSING_REMARK = #{losingRemark,jdbcType=VARCHAR} 
		</if>
		<if test="provinceId != null">
			and PROVINCE_ID = #{provinceId,jdbcType=DECIMAL} 
		</if>
		<if test="cityId != null">
			and CITY_ID = #{cityId,jdbcType=DECIMAL} 
		</if>
		<if test="countyId != null">
			and COUNTY_ID = #{countyId,jdbcType=DECIMAL} 
		</if>
		<if test="lastLogId != null">
			and LAST_LOG_ID = #{lastLogId,jdbcType=VARCHAR} 
		</if>
		<if test="isConcat != null">
			and is_Concat = #{isConcat,jdbcType=DECIMAL} 
		</if>
		<if test="scope != null">
			and SCOPE = #{scope,jdbcType=VARCHAR} 
		</if>
		<if test="mainLinkman != null">
			and MAIN_LINKMAN = #{mainLinkman,jdbcType=VARCHAR} 
		</if>	
		<if test="importDeptId != null">
			and IMPORT_DEPT_ID = #{importDeptId,jdbcType=VARCHAR} 
		</if>
		<if test="taoNo != null">
			and tao_No = #{taoNo,jdbcType=DECIMAL} 
		</if>
		<if test="lifeCode != null and lifeCode != ''">
			and LIFE_CODE = #{lifeCode,jdbcType=VARCHAR} 
		</if>
		<if test="lastOptionId != null and lastOptionId != ''">
			and last_Option_Id = #{lastOptionId,jdbcType=VARCHAR} 
		</if>
		<if test="lastLossDate != null ">
			and last_Loss_Date = #{lastLossDate,jdbcType=TIMESTAMP} 
		</if>
		<if test="lastCustTypeId != null">
			and last_Cust_Type_Id = #{lastCustTypeId,jdbcType=VARCHAR} 
		</if>
		<if test="labelCode != null">
			 and label_Code = #{labelCode,jdbcType=VARCHAR} 
		</if>
		<if test="labelName != null">
			 and label_name = #{labelName,jdbcType=VARCHAR} 
		</if>	
		<if test="commonAcc != null and commonAcc !=''">
			and COMMON_ACC = #{commonAcc,jdbcType=VARCHAR}
		</if>	
		<if test="ownerActionDate != null">
			and OWNER_ACTION_DATE =
			#{ownerActionDate,jdbcType=TIMESTAMP}
		</if>
		<if test="source != null">
			and SOURCE = #{source,jdbcType=DECIMAL}
		</if>						
	</sql>
	<!-- 修改实体对应set语句 -->
	<sql id="trents_update_set_sql">
		<trim prefix="set" suffixOverrides=",">
			<if test="name != null">
				NAME = #{name,jdbcType=VARCHAR},
			</if>
			<if test="mobilephone != null">
				MOBILEPHONE = #{mobilephone,jdbcType=VARCHAR},
			</if>
			<if test="telphone != null">
				TELPHONE = #{telphone,jdbcType=VARCHAR},
			</if>
			<if test="company != null">
				COMPANY = #{company,jdbcType=VARCHAR},
			</if>
			<if test="duty != null">
				DUTY = #{duty,jdbcType=VARCHAR},
			</if>
			<if test="sex != null">
				SEX = #{sex,jdbcType=VARCHAR},
			</if>
			<if test="companyAddr != null">
				COMPANY_ADDR = #{companyAddr,jdbcType=VARCHAR},
			</if>
			<if test="companyOrg != null">
				COMPANY_ORG = #{companyOrg,jdbcType=VARCHAR},
			</if>
			<if test="remark != null">
				REMARK = #{remark,jdbcType=VARCHAR},
			</if>
			<if test="type != null">
				TYPE = #{type,jdbcType=DECIMAL},
			</if>
			<if test="isDel != null">
				IS_DEL = #{isDel,jdbcType=DECIMAL},
			</if>
			<if test="resLastCallDate != null">
				RES_LAST_CALL_DATE = #{resLastCallDate,jdbcType=TIMESTAMP},
			</if>
			<if test="inputDate != null">
				INPUT_DATE = #{inputDate,jdbcType=TIMESTAMP},
			</if>
			<if test="inputAcc != null">
				INPUT_ACC = #{inputAcc,jdbcType=VARCHAR},
			</if>
			<if test="updateDate != null">
				UPDATE_DATE = #{updateDate,jdbcType=TIMESTAMP},
			</if>
			<if test="updateAcc != null">
				UPDATE_ACC = #{updateAcc,jdbcType=VARCHAR},
			</if>
			<if test="isMajor != null">
				IS_MAJOR = #{isMajor,jdbcType=DECIMAL},
			</if>
			<if test="resGroupId != null">
				RES_GROUP_ID = #{resGroupId,jdbcType=VARCHAR},
			</if>
			<if test="ownerAcc != null">
				OWNER_ACC = #{ownerAcc,jdbcType=VARCHAR},
			</if>
			<if test="status != null">
				STATUS = #{status,jdbcType=DECIMAL},
			</if>
			<if test="signDate != null">
				SIGN_DATE = #{signDate,jdbcType=TIMESTAMP},
			</if>
			<if test="inputStatus != null">
				INPUT_STATUS = #{inputStatus,jdbcType=DECIMAL},
			</if>
			<if test="status != null and status == 4">
				OWNER_START_DATE = null,
			</if>
			<if test="ownerStartDate != null and status != 4">
				OWNER_START_DATE = #{ownerStartDate,jdbcType=TIMESTAMP},
			</if>
			<if test="filterCount != null">
				FILTER_COUNT = #{filterCount,jdbcType=DECIMAL},
			</if>
			<if test="filterType != null">
				FILTER_TYPE = #{filterType,jdbcType=DECIMAL},
			</if>
			<if test="opreateType != null">
				OPREATE_TYPE = #{opreateType,jdbcType=DECIMAL},
			</if>
			<if test="fax != null">
				FAX = #{fax,jdbcType=VARCHAR},
			</if>
			<if test="email != null">
				EMAIL = #{email,jdbcType=VARCHAR},
			</if>
			<if test="unithome != null">
				UNITHOME = #{unithome,jdbcType=VARCHAR},
			</if>
			<if test="unitintroduction != null">
				UNITINTRODUCTION = #{unitintroduction,jdbcType=VARCHAR},
			</if>
			<if test="amoytocustomerDate != null">
				AMOYTOCUSTOMER_DATE = #{amoytocustomerDate,jdbcType=TIMESTAMP},
			</if>
			<if test="qq != null">
				QQ = #{qq,jdbcType=VARCHAR},
			</if>
			<if test="keyWord != null">
				KEYWORD = #{keyWord,jdbcType=VARCHAR},
			</if>
			<if test="contractNumber != null">
				CONTRACT_NUMBER = #{contractNumber,jdbcType=VARCHAR},
			</if>
			<if test="defined1 != null">
				DEFINED1 = #{defined1,jdbcType=VARCHAR},
			</if>
			<if test="defined2 != null">
				DEFINED2 = #{defined2,jdbcType=VARCHAR},
			</if>
			<if test="defined3 != null">
				DEFINED3 = #{defined3,jdbcType=VARCHAR},
			</if>
			<if test="defined4 != null">
				DEFINED4 = #{defined4,jdbcType=VARCHAR},
			</if>
			<if test="defined5 != null">
				DEFINED5 = #{defined5,jdbcType=VARCHAR},
			</if>
			<if test="defined6 != null">
				DEFINED6 = #{defined6,jdbcType=VARCHAR},
			</if>
			<if test="defined7 != null">
				DEFINED7 = #{defined7,jdbcType=VARCHAR},
			</if>
			<if test="defined8 != null">
				DEFINED8 = #{defined8,jdbcType=VARCHAR},
			</if>
			<if test="defined9 != null">
				DEFINED9 = #{defined9,jdbcType=VARCHAR},
			</if>
			<if test="defined10 != null">
				DEFINED10 = #{defined10,jdbcType=VARCHAR},
			</if>
			<if test="defined11 != null">
				DEFINED11 = #{defined11,jdbcType=VARCHAR},
			</if>
			<if test="defined12 != null">
				DEFINED12 = #{defined12,jdbcType=VARCHAR},
			</if>
			<if test="defined13 != null">
				DEFINED13 = #{defined13,jdbcType=VARCHAR},
			</if>
			<if test="defined14 != null">
				DEFINED14 = #{defined14,jdbcType=VARCHAR},
			</if>
			<if test="defined15 != null">
				DEFINED15 = #{defined15,jdbcType=VARCHAR},
			</if>						
			<if test="alternatePhone2 != null">
				ALTERNATE_PHONE2 = #{alternatePhone2,jdbcType=VARCHAR},
			</if>
			<if test="signAcc != null">
				SIGN_ACC = #{signAcc,jdbcType=VARCHAR},
			</if>
			<if test="ownerAcc != null">
				OWNER_ACC = #{ownerAcc,jdbcType=VARCHAR},
			</if>
			<if test="signName != null">
				SIGN_NAME = #{signName,jdbcType=VARCHAR},
			</if>
			<if test="nextFollowDate != null">
				NEXTFOLLOW_DATE = #{nextFollowDate,jdbcType=TIMESTAMP},
			</if>
			<if test="nextFollowDate == null">
				NEXTFOLLOW_DATE = null,
			</if>
			<if test="lastCustFollowID != null">
				LAST_CUST_FOLLOW_ID = #{lastCustFollowID,jdbcType=VARCHAR},
			</if>
			<if test="serviceAcc != null">
				SERVICE_ACC = #{serviceAcc,jdbcType=VARCHAR},
			</if>
			<if test="serviceName != null">
				SERVICE_NAME = #{serviceName,jdbcType=VARCHAR},
			</if>
			<if test="serviceLevel != null">
				SERVICE_LEVEL = #{serviceLevel,jdbcType=VARCHAR},
			</if>
			<if test="birthday != null">
				BIRTHDAY = #{birthday,jdbcType=TIMESTAMP},
			</if>
			<if test="callDatePostponed != null">
				CALL_DATE_POSTPONED = #{callDatePostponed,jdbcType=TIMESTAMP},
			</if>
			<if test="reasonForCalldelay != null">
				REASON_FOR_CALLDELAY = #{reasonForCalldelay,jdbcType=VARCHAR},
			</if>
			<if test="recuclingTypeDetails != null">
				RECUCLING_TYPE_DETAILS = #{recuclingTypeDetails,jdbcType=VARCHAR},
			</if>
			<if test="againwashCount != null">
				AGAINWASH_COUNT = #{againwashCount,jdbcType=DECIMAL},
			</if>
			<if test="actionDate != null">
				ACTION_DATE = #{actionDate,jdbcType=TIMESTAMP},
			</if>
			<if test="visitingDate != null">
				VISITING_DATE = #{visitingDate,jdbcType=TIMESTAMP},
			</if>
			<if test="nextVisitingDate != null">
				NEXT_VISITING_DATE = #{nextVisitingDate,jdbcType=TIMESTAMP},
			</if>
			<if test="serviceLabelCode != null">
				SERVICE_LABEL_CODE = #{serviceLabelCode,jdbcType=VARCHAR},
			</if>
			<if test="serviceLabelName != null">
				SERVICE_LABEL_NAME = #{serviceLabelName,jdbcType=VARCHAR},
			</if>
			<if test="isPrecedence != null">
				IS_PRECEDENCE = #{isPrecedence,jdbcType=DECIMAL},
			</if>
			<if test="forTheCustomerTime != null">
				FOR_THE_CUSTOMER_TIME = #{forTheCustomerTime,jdbcType=TIMESTAMP},
			</if>
			<if test="lastVisitAcc != null">
				LAST_VISIT_ACC = #{lastVisitAcc,jdbcType=VARCHAR},
			</if>	
			<if test="state != null">
				STATE = #{state,jdbcType=DECIMAL},
			</if>
			<if test="planDate != null">
				PLAN_DATE = #{planDate,jdbcType=TIMESTAMP}, 
			</if>
			<if test="address != null">
				ADDRESS = #{address,jdbcType=VARCHAR}, 
			</if>
			<if test="companyMoney != null">
				COMPANY_MONEY = #{companyMoney,jdbcType=VARCHAR}, 
			</if>
			<if test="companyUser != null">
				COMPANY_USER = #{companyUser,jdbcType=VARCHAR}, 
			</if>
			<if test="companyTrade != null">
				COMPANY_TRADE = #{companyTrade,jdbcType=VARCHAR}, 
			</if>
			<if test="companyFax != null">
				COMPANY_FAX = #{companyFax,jdbcType=VARCHAR}, 
			</if>
			<if test="losingId != null">
				LOSING_ID = #{losingId,jdbcType=VARCHAR}, 
			</if>
			<if test="losingRemark != null">
				LOSING_REMARK = #{losingRemark,jdbcType=VARCHAR}, 
			</if>	
			<if test="provinceId != null">
				PROVINCE_ID = #{provinceId,jdbcType=DECIMAL},
			</if>
			<if test="cityId != null">
				CITY_ID = #{cityId,jdbcType=DECIMAL},
			</if>
			<if test="countyId != null">
				COUNTY_ID = #{countyId,jdbcType=DECIMAL},
			</if>
			<if test="lastLogId != null">
				LAST_LOG_ID = #{lastLogId,jdbcType=VARCHAR}, 
			</if>
			<if test="isConcat != null">
				 IS_CONCAT = #{isConcat,jdbcType=DECIMAL} ,
			</if>
			<if test="scope != null">
				SCOPE = #{scope,jdbcType=VARCHAR},
			</if>
			<if test="mainLinkman != null">
				MAIN_LINKMAN = #{mainLinkman,jdbcType=VARCHAR},
			</if>
			<if test="importDeptId != null">
				 IMPORT_DEPT_ID = #{importDeptId,jdbcType=VARCHAR} ,
			</if>
			<if test="taoNo != null">
				 tao_No = #{taoNo,jdbcType=DECIMAL} ,
			</if>
			<if test="lifeCode != null">
				 LIFE_CODE = #{lifeCode,jdbcType=VARCHAR} ,
			</if>	
			<if test="lastOptionId != null">
				 last_Option_Id = #{lastOptionId,jdbcType=VARCHAR} ,
			</if>
			<if test="lastLossDate != null ">
				 last_Loss_Date = #{lastLossDate,jdbcType=TIMESTAMP} ,
			</if>
			<if test="lastCustTypeId != null">
				 last_Cust_Type_Id = #{lastCustTypeId,jdbcType=VARCHAR} ,
			</if>
			<if test="labelCode != null">
				 label_Code = #{labelCode,jdbcType=VARCHAR} ,
			</if>
			<if test="labelName != null">
				 label_name = #{labelName,jdbcType=VARCHAR} ,
			</if>	
			<if test="ownerActionDate != null ">
				 OWNER_ACTION_DATE = #{ownerActionDate,jdbcType=TIMESTAMP} ,
			</if>	
			<if test="source != null">
				 SOURCE = #{source,jdbcType=DECIMAL} ,
			</if>										
		</trim>
	</sql>
	<!-- 插入实体对应的字段语句 -->
	<sql id="insert_into_field">
		<trim prefix="(" suffix=")" suffixOverrides=",">
			<if test="resCustId != null">
				RES_CUST_ID,
			</if>
			<if test="name != null">
				NAME,
			</if>
			<if test="mobilephone != null">
				MOBILEPHONE,
			</if>
			<if test="telphone != null">
				TELPHONE,
			</if>
			<if test="company != null">
				COMPANY,
			</if>
			<if test="duty != null">
				DUTY,
			</if>
			<if test="sex != null">
				SEX,
			</if>
			<if test="companyAddr != null">
				COMPANY_ADDR,
			</if>
			<if test="companyOrg != null">
				COMPANY_ORG,
			</if>
			<if test="remark != null">
				REMARK,
			</if>
			<if test="type != null">
				TYPE,
			</if>
			<if test="isDel != null">
				IS_DEL,
			</if>
			<if test="resLastCallDate != null">
				RES_LAST_CALL_DATE,
			</if>
			<if test="inputDate != null">
				INPUT_DATE,
			</if>
			<if test="inputAcc != null">
				INPUT_ACC,
			</if>
			<if test="updateDate != null">
				UPDATE_DATE,
			</if>
			<if test="updateAcc != null">
				UPDATE_ACC,
			</if>
			<if test="isMajor != null">
				IS_MAJOR,
			</if>
			<if test="resGroupId != null">
				RES_GROUP_ID,
			</if>
			<if test="ownerAcc != null">
				OWNER_ACC,
			</if>
			<if test="status != null">
				STATUS,
			</if>
			<if test="orgId != null">
				ORG_ID,
			</if>
			<if test="signDate != null">
				SIGN_DATE,
			</if>
			<if test="inputStatus != null">
				INPUT_STATUS,
			</if>
			<if test="ownerStartDate != null">
				OWNER_START_DATE,
			</if>
			<if test="filterCount != null">
				FILTER_COUNT,
			</if>
			<if test="filterType != null">
				FILTER_TYPE,
			</if>
			<if test="opreateType != null">
				OPREATE_TYPE,
			</if>
			<if test="fax != null">
				FAX,
			</if>
			<if test="email != null">
				EMAIL,
			</if>
			<if test="unithome != null">
				UNITHOME,
			</if>
			<if test="unitintroduction != null">
				UNITINTRODUCTION,
			</if>
			<if test="amoytocustomerDate != null">
				AMOYTOCUSTOMER_DATE,
			</if>
			<if test="qq != null">
				QQ,
			</if>
			<if test="keyWord != null">
				KEYWORD,
			</if>
			<if test="contractNumber != null">
				CONTRACT_NUMBER,
			</if>
			<if test="defined1 != null">
				DEFINED1,
			</if>
			<if test="defined2 != null">
				DEFINED2,
			</if>
			<if test="defined3 != null">
				DEFINED3,
			</if>
			<if test="defined4 != null">
				DEFINED4,
			</if>
			<if test="defined5 != null">
				DEFINED5,
			</if>
			<if test="defined6 != null">
				DEFINED6 ,
			</if>
			<if test="defined7 != null">
				DEFINED7 ,
			</if>
			<if test="defined8 != null">
				DEFINED8 ,
			</if>
			<if test="defined9 != null">
				DEFINED9 ,
			</if>
			<if test="defined10 != null">
				DEFINED10 ,
			</if>
			<if test="defined11 != null">
				DEFINED11 ,
			</if>
			<if test="defined12 != null">
				DEFINED12 ,
			</if>
			<if test="defined13 != null">
				DEFINED13 ,
			</if>
			<if test="defined14 != null">
				DEFINED14 ,
			</if>
			<if test="defined15 != null">
				DEFINED15 ,
			</if>						
			<if test="alternatePhone2 != null">
				ALTERNATE_PHONE2,
			</if>
			<if test="signAcc != null">
				SIGN_ACC,
			</if>
			<if test="signName != null">
				SIGN_NAME,
			</if>
			<if test="nextFollowDate != null">
				NEXTFOLLOW_DATE,
			</if>
			<if test="birthday != null">
				BIRTHDAY,
			</if>
			<if test="recuclingTypeDetails != null">
				RECUCLING_TYPE_DETAILS,
			</if>
			<if test="callDatePostponed != null">
				CALL_DATE_POSTPONED,
			</if>
			<if test="reasonForCalldelay != null">
				REASON_FOR_CALLDELAY,
			</if>
			<if test="recuclingTypeDetails != null">
				RECUCLING_TYPE_DETAILS,
			</if>
			<if test="againwashCount != null">
				AGAINWASH_COUNT,
			</if>
			<if test="actionDate != null">
				ACTION_DATE,
			</if>
			<if test="lastCustFollowID != null">
				LAST_CUST_FOLLOW_ID,
			</if>
			<if test="serviceAcc != null">
				SERVICE_ACC,
			</if>
			<if test="serviceName != null">
				SERVICE_NAME,
			</if>
			<if test="serviceLevel != null">
				SERVICE_LEVEL,
			</if>
			<if test="visitingDate != null">
				VISITING_DATE,
			</if>
			<if test="nextVisitingDate != null">
				NEXT_VISITING_DATE,
			</if>
			<if test="serviceLabelCode != null">
				SERVICE_LABEL_CODE,
			</if>
			<if test="serviceLabelName != null">
				SERVICE_LABEL_NAME,
			</if>
			<if test="isPrecedence != null">
				IS_PRECEDENCE,
			</if>
			<if test="forTheCustomerTime != null">
				FOR_THE_CUSTOMER_TIME,
			</if>
			<if test="lastVisitAcc != null">
				LAST_VISIT_ACC,
			</if>
			<if test="state != null">
				STATE,
			</if>
			<if test="planDate != null">
				PLAN_DATE, 
			</if>
			<if test="address != null">
				ADDRESS, 
			</if>
			<if test="companyMoney != null">
				COMPANY_MONEY, 
			</if>
			<if test="companyUser != null">
				COMPANY_USER, 
			</if>
			<if test="companyTrade != null">
				COMPANY_TRADE, 
			</if>
			<if test="companyFax != null">
				COMPANY_FAX, 
			</if>
			<if test="losingId != null">
				LOSING_ID, 
			</if>
			<if test="losingRemark != null">
				LOSING_REMARK, 
			</if>
			<if test="provinceId != null">
				PROVINCE_ID,
			</if>
			<if test="cityId != null">
				CITY_ID,
			</if>
			<if test="countyId != null">
				COUNTY_ID,
			</if>
			<if test="lastLogId != null">
				LAST_LOG_ID,
			</if>
			<if test="isConcat != null">
				 IS_CONCAT ,
			</if>
			<if test="scope != null">
				SCOPE,
			</if>	
			<if test="mainLinkman != null">
				MAIN_LINKMAN,
			</if>
			<if test="importDeptId != null">
				 IMPORT_DEPT_ID,
			</if>
			<if test="taoNo != null">
				 tao_No ,
			</if>
			<if test="lifeCode != null">
				 LIFE_CODE,
			</if>	
			<if test="lastOptionId != null">
				 last_Option_Id,
			</if>
			<if test="lastLossDate != null ">
				 last_Loss_Date,
			</if>
			<if test="lastCustTypeId != null">
				 last_Cust_Type_Id ,
			</if>	
			<if test="labelCode != null">
				 label_Code  ,
			</if>
			<if test="labelName != null">
				 label_name  ,
			</if>
			<if test="ownerActionDate != null">
				 OWNER_ACTION_DATE  ,
			</if>	
			<if test="source != null">
				 SOURCE  ,
			</if>												
		</trim>
		<trim prefix="values (" suffix=")" suffixOverrides=",">
			<if test="resCustId != null">
				#{resCustId,jdbcType=VARCHAR},
			</if>
			<if test="name != null">
				#{name,jdbcType=VARCHAR},
			</if>
			<if test="mobilephone != null">
				#{mobilephone,jdbcType=VARCHAR},
			</if>
			<if test="telphone != null">
				#{telphone,jdbcType=VARCHAR},
			</if>
			<if test="company != null">
				#{company,jdbcType=VARCHAR},
			</if>
			<if test="duty != null">
				#{duty,jdbcType=VARCHAR},
			</if>
			<if test="sex != null">
				#{sex,jdbcType=VARCHAR},
			</if>
			<if test="companyAddr != null">
				#{companyAddr,jdbcType=VARCHAR},
			</if>
			<if test="companyOrg != null">
				#{companyOrg,jdbcType=VARCHAR},
			</if>
			<if test="remark != null">
				#{remark,jdbcType=VARCHAR},
			</if>
			<if test="type != null">
				#{type,jdbcType=DECIMAL},
			</if>
			<if test="isDel != null">
				#{isDel,jdbcType=DECIMAL},
			</if>
			<if test="resLastCallDate != null">
				#{resLastCallDate,jdbcType=TIMESTAMP},
			</if>
			<if test="inputDate != null">
				#{inputDate,jdbcType=TIMESTAMP},
			</if>
			<if test="inputAcc != null">
				#{inputAcc,jdbcType=VARCHAR},
			</if>
			<if test="updateDate != null">
				#{updateDate,jdbcType=TIMESTAMP},
			</if>
			<if test="updateAcc != null">
				#{updateAcc,jdbcType=VARCHAR},
			</if>
			<if test="isMajor != null">
				#{isMajor,jdbcType=DECIMAL},
			</if>
			<if test="resGroupId != null">
				#{resGroupId,jdbcType=VARCHAR},
			</if>
			<if test="ownerAcc != null">
				#{ownerAcc,jdbcType=VARCHAR},
			</if>
			<if test="status != null">
				#{status,jdbcType=DECIMAL},
			</if>
			<if test="orgId != null">
				#{orgId,jdbcType=VARCHAR},
			</if>
			<if test="signDate != null">
				#{signDate,jdbcType=TIMESTAMP},
			</if>
			<if test="inputStatus != null">
				#{inputStatus,jdbcType=DECIMAL},
			</if>
			<if test="ownerStartDate != null">
				#{ownerStartDate,jdbcType=TIMESTAMP},
			</if>
			<if test="filterCount != null">
				#{filterCount,jdbcType=DECIMAL},
			</if>
			<if test="filterType != null">
				#{filterType,jdbcType=DECIMAL},
			</if>
			<if test="opreateType != null">
				#{opreateType,jdbcType=DECIMAL},
			</if>
			<if test="fax != null">
				#{fax,jdbcType=VARCHAR},
			</if>
			<if test="email != null">
				#{email,jdbcType=VARCHAR},
			</if>
			<if test="unithome != null">
				#{unithome,jdbcType=VARCHAR},
			</if>
			<if test="unitintroduction != null">
				#{unitintroduction,jdbcType=VARCHAR},
			</if>
			<if test="amoytocustomerDate != null">
				#{amoytocustomerDate,jdbcType=TIMESTAMP},
			</if>
			<if test="qq != null">
				#{qq,jdbcType=VARCHAR},
			</if>
			<if test="keyWord != null">
				#{keyWord,jdbcType=VARCHAR},
			</if>
			<if test="contractNumber != null">
				#{contractNumber,jdbcType=VARCHAR},
			</if>
			<if test="defined1 != null">
				#{defined1,jdbcType=VARCHAR},
			</if>
			<if test="defined2 != null">
				#{defined2,jdbcType=VARCHAR},
			</if>
			<if test="defined3 != null">
				#{defined3,jdbcType=VARCHAR},
			</if>
			<if test="defined4 != null">
				#{defined4,jdbcType=VARCHAR},
			</if>
			<if test="defined5 != null">
				#{defined5,jdbcType=VARCHAR},
			</if>
			<if test="defined6 != null">
				#{defined6,jdbcType=VARCHAR},
			</if>
			<if test="defined7 != null">
				#{defined7,jdbcType=VARCHAR},
			</if>
			<if test="defined8 != null">
				#{defined8,jdbcType=VARCHAR},
			</if>
			<if test="defined9 != null">
				#{defined9,jdbcType=VARCHAR},
			</if>
			<if test="defined10 != null">
				#{defined10,jdbcType=VARCHAR},
			</if>	
			<if test="defined11 != null">
				#{defined11,jdbcType=VARCHAR},
			</if>
			<if test="defined12 != null">
				#{defined12,jdbcType=VARCHAR},
			</if>
			<if test="defined13 != null">
				#{defined13,jdbcType=VARCHAR},
			</if>
			<if test="defined14 != null">
				#{defined14,jdbcType=VARCHAR},
			</if>
			<if test="defined15 != null">
				#{defined15,jdbcType=VARCHAR},
			</if>					
			<if test="alternatePhone2 != null">
				#{alternatePhone2,jdbcType=VARCHAR},
			</if>
			<if test="signAcc != null">
				#{signAcc,jdbcType=VARCHAR},
			</if>
			<if test="signName != null">
				#{signName,jdbcType=VARCHAR},
			</if>
			<if test="nextFollowDate != null">
				#{nextFollowDate,jdbcType=TIMESTAMP},
			</if>
			<if test="birthday != null">
				#{birthday,jdbcType=TIMESTAMP},
			</if>
			<if test="callDatePostponed != null">
				#{callDatePostponed,jdbcType=TIMESTAMP},
			</if>
			<if test="reasonForCalldelay != null">
				#{reasonForCalldelay,jdbcType=VARCHAR},
			</if>
			<if test="recuclingTypeDetails != null">
				#{recuclingTypeDetails,jdbcType=VARCHAR},
			</if>
			<if test="againwashCount != null">
				#{againwashCount,jdbcType=VARCHAR},
			</if>
			<if test="actionDate != null">
				#{actionDate,jdbcType=TIMESTAMP},
			</if>
			<if test="lastCustFollowID != null">
				#{lastCustFollowID,jdbcType=VARCHAR},
			</if>
			<if test="serviceAcc != null">
				#{serviceAcc,jdbcType=VARCHAR},
			</if>
			<if test="serviceName != null">
				#{serviceName,jdbcType=VARCHAR},
			</if>
			<if test="serviceLevel != null">
				#{serviceLevel,jdbcType=VARCHAR},
			</if>
			<if test="visitingDate != null">
				#{visitingDate,jdbcType=TIMESTAMP},
			</if>
			<if test="nextVisitingDate != null">
				#{nextVisitingDate,jdbcType=TIMESTAMP},
			</if>
			<if test="serviceLabelCode != null">
				#{serviceLabelCode,jdbcType=VARCHAR},
			</if>
			<if test="serviceLabelName != null">
				#{serviceLabelName,jdbcType=VARCHAR},
			</if>
			<if test="isPrecedence != null">
				#{isPrecedence,jdbcType=DECIMAL},
			</if>
			<if test="forTheCustomerTime != null">
				#{forTheCustomerTime,jdbcType=TIMESTAMP},
			</if>
			<if test="lastVisitAcc != null">
				#{lastVisitAcc,jdbcType=VARCHAR},
			</if>	
			<if test="state != null">
				#{state,jdbcType=DECIMAL},
			</if>
			<if test="planDate != null">
				#{planDate,jdbcType=TIMESTAMP}, 
			</if>
			<if test="address != null">
				#{address,jdbcType=VARCHAR}, 
			</if>
			<if test="companyMoney != null">
				#{companyMoney,jdbcType=VARCHAR}, 
			</if>
			<if test="companyUser != null">
				#{companyUser,jdbcType=VARCHAR}, 
			</if>
			<if test="companyTrade != null">
				#{companyTrade,jdbcType=VARCHAR}, 
			</if>
			<if test="companyFax != null">
				#{companyFax,jdbcType=VARCHAR}, 
			</if>
			<if test="losingId != null">
				#{losingId,jdbcType=VARCHAR}, 
			</if>
			<if test="losingRemark != null">
				#{losingRemark,jdbcType=VARCHAR}, 
			</if>
			<if test="provinceId != null">
				#{provinceId,jdbcType=DECIMAL},
			</if>
			<if test="cityId != null">
				#{cityId,jdbcType=DECIMAL},
			</if>
			<if test="countyId != null">
				#{countyId,jdbcType=DECIMAL},
			</if>	
			<if test="lastLogId != null">
				#{lastLogId,jdbcType=VARCHAR},
			</if>
			<if test="isConcat != null">
				  #{isConcat,jdbcType=DECIMAL} ,
			</if>
			<if test="scope != null">
				#{scope,jdbcType=VARCHAR},
			</if>
			<if test="mainLinkman != null">
				#{mainLinkman,jdbcType=VARCHAR},
			</if>
			<if test="importDeptId != null">
				#{importDeptId,jdbcType=VARCHAR} ,
			</if>
			<if test="taoNo != null">
				 #{taoNo,jdbcType=DECIMAL} ,
			</if>
			<if test="lifeCode != null">
				#{lifeCode,jdbcType=VARCHAR},
			</if>	
			<if test="lastOptionId != null">
				#{lastOptionId,jdbcType=VARCHAR},
			</if>
			<if test="lastLossDate != null">
				  #{lastLossDate,jdbcType=TIMESTAMP} ,
			</if>
			<if test="lastCustTypeId != null">
				 #{lastCustTypeId,jdbcType=VARCHAR} ,
			</if>
			<if test="labelCode != null">
				 #{labelCode,jdbcType=VARCHAR} ,
			</if>
			<if test="labelName != null">
				#{labelName,jdbcType=VARCHAR} ,
			</if>
			<if test="ownerActionDate != null">
				 #{ownerActionDate,jdbcType=TIMESTAMP} ,
			</if>	
			<if test="source != null">
				 #{source,jdbcType=DECIMAL} ,
			</if>															
		</trim>
	</sql>
	<!-- 表字段 -->
	<sql id="Base_Column_List">
		RES_CUST_ID,NAME,MOBILEPHONE,TELPHONE,COMPANY,DUTY,SEX,COMPANY_ADDR,COMPANY_ORG,
		REMARK,TYPE,IS_DEL,RES_LAST_CALL_DATE,INPUT_DATE,INPUT_ACC,UPDATE_DATE,UPDATE_ACC,
		IS_MAJOR,RES_GROUP_ID,OWNER_ACC,STATUS,ORG_ID,SIGN_DATE,INPUT_STATUS,OWNER_START_DATE,
		FILTER_COUNT,FILTER_TYPE,OPREATE_TYPE,FAX,EMAIL,UNITHOME,UNITINTRODUCTION,AMOYTOCUSTOMER_DATE,QQ,KEYWORD,CONTRACT_NUMBER,
		DEFINED1,DEFINED2,DEFINED3,DEFINED4,DEFINED5,ALTERNATE_PHONE2,SIGN_ACC,SIGN_NAME,NEXTFOLLOW_DATE,BIRTHDAY,
		CALL_DATE_POSTPONED,
		REASON_FOR_CALLDELAY,RECUCLING_TYPE_DETAILS,AGAINWASH_COUNT,ACTION_DATE,LAST_CUST_FOLLOW_ID,
		SERVICE_ACC, SERVICE_NAME,
		SERVICE_LEVEL,VISITING_DATE,NEXT_VISITING_DATE,SERVICE_LABEL_CODE,SERVICE_LABEL_NAME,
		IS_PRECEDENCE,FOR_THE_CUSTOMER_TIME,LAST_VISIT_ACC,STATE,PLAN_DATE,ADDRESS,COMPANY_MONEY,
		COMPANY_USER,COMPANY_TRADE,COMPANY_FAX,LOSING_ID,LOSING_REMARK,PROVINCE_ID,CITY_ID,COUNTY_ID,LAST_LOG_ID,WANGWANG,SCOPE,MAIN_LINKMAN,
		DEFINED6,DEFINED7,DEFINED8,DEFINED9,DEFINED10,DEFINED11,DEFINED12,DEFINED13,DEFINED14,DEFINED15,DEFINED16,DEFINED17,DEFINED18,TAO_NO,SIGN_BEFORE_STATUS,SIGN_BEFORE_TYPE,IMPORT_DEPT_ID,LIFE_CODE,last_Option_Id ,
		last_Loss_Date,is_Concat,last_Cust_Type_Id,label_Code,label_name,COMMON_ACC,OWNER_ACTION_DATE,SOURCE
	</sql>
	

	<!-- ################################################################################################## 
		#########################基础定义配置 通用脚本（无需修改，单resultType需要替换）############# ################################################################################################## -->

	<!-- 查询所有实体信息，对应接口中的find方法 -->
	<select id="find" resultMap="BaseResultMap">
		select
		<include refid="Base_Column_List" />
		from
		<include refid="table_name" />
	</select>

	<select id="findListPage" resultMap="BaseResultMap">
		select
		<include refid="Base_Column_List" />
		from
		<include refid="table_name" />
		where 1=1
		<include refid="entity_condition_orderby" />
	</select>

	<!-- 根据条件查询所有实体信息，对应接口中的findByCondtion方法 -->
	<select id="findByCondtion" resultMap="BaseResultMap">
		select
		<include refid="Base_Column_List" />
		from
		<include refid="table_name" />
		where 1=1
		<include refid="entity_condition_orderby" />
	</select>
	
	<!-- 根据条件查询所有实体信息，对应接口中的findByCondtion方法 -->
	<select id="getListByGroupIds" resultMap="BaseResultMap">
		select
		<include refid="Base_Column_List" />
		from
		<include refid="table_name" />
		where 1=1
		and org_id = #{orgId}
		<choose>
			<when test="resGroupIds != null and resGroupIds.size() > 0">
				AND res_group_id in 
				<foreach collection="resGroupIds" item="rgid" open="(" separator="," close=")">
	   				#{rgid}
	   			</foreach>
			</when>
			<otherwise>
				AND res_group_id in ('')
			</otherwise>
		</choose>
	</select>

	<!-- 按编号获取实体信息，对应接口中的getByPrimaryKey方法 -->
	<select id="getByPrimaryKey" parameterType="map" resultMap="BaseResultMap">
		select
		<include refid="Base_Column_List" />
		from
		<include refid="table_name" />
		where  org_id=#{orgId} and RES_CUST_ID = #{custId}
	</select>

	<!-- 按编号获取实体信息，对应接口中的getByPrimaryKey方法 -->
	<select id="getResCustByResId" parameterType="map" resultMap="ResCustResultMap">
		select
		<include refid="Base_Column_List" />
		from
		<include refid="table_name" />
		where 
		org_id=#{orgId}
		and RES_CUST_ID = #{resId}
	    and status in (2,3) <!-- 限制taotag 中有id但已经被淘了或分配给其他人了 -->
	    and filter_type  &lt;  2<!-- 限制taotag 中有id但已经被淘了或分配给其他人了 -->
	    and type=1<!-- 限制taotag 中有id但已经被淘了或分配给其他人了 -->
	</select>

	<!-- 按条件查询获取实体信息，对应接口中的getByCondtion方法 -->
	<select id="getByCondtion" resultMap="BaseResultMap">
		select
		<include refid="Base_Column_List" />
		from
		<include refid="table_name" />
		where 1=1
		<include refid="entity_condition_orderby" />
	</select>

	<!-- 添加实体 -->
	<insert id="insert" parameterType="com.qftx.tsm.cust.bean.ResCustInfoBean">
		insert into
		<include refid="table_name" />
		<include refid="insert_into_field" />
	</insert>

	<!-- 修改实体 -->
	<update id="update" parameterType="com.qftx.tsm.cust.bean.ResCustInfoBean">
		update
		<include refid="table_name" />
		<include refid="trents_update_set_sql" />
		where org_id=#{orgId} and  RES_CUST_ID = #{resCustId}
	</update>

	<!-- 动态修改实体 -->
	<update id="updateTrends" parameterType="com.qftx.tsm.cust.bean.ResCustInfoBean">
		update
		<include refid="table_name" />
		<include refid="trents_update_set_sql" />
		where RES_CUST_ID = #{resCustId} and org_id=#{orgId}
	</update>

	<!-- 删除 -->
	<delete id="delete" parameterType="string">
		delete
		<include refid="table_name" />
		where RES_CUST_ID = #{resCustId}
	</delete>

	<!-- 批量删除 -->
	<update id="deleteBatch" parameterType="map">
		update
		<include refid="table_name" />
		set IS_DEL = 1,UPDATE_ACC =#{updateacc},UPDATE_DATE = sysdate
		where
		RES_CUST_ID in
		<foreach collection="ids" item="id" open="(" separator=","
			close=")">
			#{id}
		</foreach>
	</update>

	<!-- 批量删除 -->
	<update id="deleteBatchByOrgId" parameterType="map">
		update
		<include refid="table_name" />
		set IS_DEL = 1,UPDATE_ACC =#{updateacc},UPDATE_DATE = now()
		where
		org_id = #{orgId}
		and RES_CUST_ID in
		<foreach collection="ids" item="id" open="(" separator=","
			close=")">
			#{id}
		</foreach>
	</update>
	<!-- 获取公司待分配资源信息(电话查询) -->
	<select id="findUnAssginResIdsWithPhone" resultType="String"
		parameterType="com.qftx.tsm.cust.dto.ResCustDto"> 
				   select t.RES_CUST_ID
					  FROM
				  (select r.RES_CUST_ID
					  FROM
					    tsm_res_cust_info r 	     
					  WHERE
					   r.org_id =#{orgId,jdbcType=VARCHAR}
					<if test="resIds != null and resIds.size() > 0">
				   		AND r.RES_CUST_ID IN 
				   			<foreach collection="resIds" item="rid" open="(" separator="," close=")">
				   				#{rid}
				   			</foreach>
				   	</if>
					<if test="deptIds!=null">
						AND r.import_dept_id IN 
							<foreach collection="deptIds" item="deptId" open="(" separator=","
								close=")">
								#{deptId}
							</foreach>	
						
					</if>
					<if test="deptIds==null">
						AND r.input_acc =#{inputAcc}
					</if>		
					<if test="startDate!=null and startDate!='' ">
				       <![CDATA[
			            AND r.input_date>=str_to_date(  CONCAT(#{startDate},' 00:00:00'), '%Y-%m-%d %H:%i:%s') 	       				   	       
					   ]]>
					</if>
					<if test="endDate!=null and endDate!=''">
					   <![CDATA[
					     AND r.input_date<=str_to_date(  CONCAT(#{endDate},' 23:59:59'), '%Y-%m-%d %H:%i:%s') 	 
					   ]]>
					</if>
					<choose>
						<when test="resGroupIds != null and resGroupIds.size() > 0">
							AND r.res_group_id in 
							<foreach collection="resGroupIds" item="rgid" open="(" separator="," close=")">
				   				#{rgid}
				   			</foreach>
						</when>
						<when test="resGroupIds == null"></when>
						<otherwise>
							AND r.res_group_id in ('')
						</otherwise>
					</choose>
					<if test=" companyTrade != null and companyTrade != '' ">
						AND r.company_trade = #{companyTrade,jdbcType=VARCHAR}
					</if>
					<if test=" provinceId != null and provinceId != '' ">
						AND r.province_id = #{provinceId,jdbcType=VARCHAR}
					</if>
					<if test=" cityId != null and cityId != '' ">
						AND r.city_id = #{cityId,jdbcType=VARCHAR}
					</if>
					<if test=" countyId != null and countyId != '' ">
						AND r.county_id = #{countyId,jdbcType=VARCHAR}
					</if>
					<if test="defined1 != null and defined1 != ''">
						AND r.defined1 =#{defined1}
					</if>	
					<if test="defined2 != null and defined2 != ''">
						AND r.defined2 =#{defined2}
					</if>	
					<if test="defined3 != null and defined3 != ''">
						AND r.defined3 =#{defined3}
					</if>	
					<if test="defined4 != null and defined4 != ''">
						AND r.defined4 =#{defined4}
					</if>	
					<if test="defined5 != null and defined5 != ''">
						AND r.defined5 =#{defined5}
					</if>	
					<if test="defined6 != null and defined6 != ''">
						AND r.defined6 =#{defined6}
					</if>	
					<if test="defined7 != null and defined7 != ''">
						AND r.defined7 =#{defined7}
					</if>	
					<if test="defined8 != null and defined8 != ''">
						AND r.defined8 =#{defined8}
					</if>	
					<if test="defined9 != null and defined9 != ''">
						AND r.defined9 =#{defined9}
					</if>	
					<if test="defined10 != null and defined10 != ''">
						AND r.defined10 =#{defined10}
					</if>	
					<if test="defined11 != null and defined11 != ''">
						AND r.defined11 =#{defined11}
					</if>	
					<if test="defined12 != null and defined12 != ''">
						AND r.defined12 =#{defined12}
					</if>	
					<if test="defined13 != null and defined13 != ''">
						AND r.defined13 =#{defined13}
					</if>	
					<if test="defined14 != null and defined14 != ''">
						AND r.defined14 =#{defined14}
					</if>	
					<if test="defined15 != null and defined15 != ''">
						AND r.defined15 =#{defined15}
					</if>
					<if test=" startdefined16!= null and startdefined16 !='' ">
						AND r.defined16 >=
						 str_to_date(concat(#{startdefined16,jdbcType=VARCHAR}, '00:00:00'),
			                                       '%Y-%m-%d %H:%i:%s')
					</if>
					<if test=" enddefined16 != null and enddefined16 !='' ">
						AND r.defined16 <![CDATA[ <= ]]>
						str_to_date(concat(#{enddefined16,jdbcType=VARCHAR}, '23:59:59'),
			                                       '%Y-%m-%d %H:%i:%s')
					</if>
					<if test=" startdefined17!= null and startdefined17 !='' ">
						AND r.defined17 >=
						 str_to_date(concat(#{startdefined17,jdbcType=VARCHAR}, '00:00:00'),
			                                       '%Y-%m-%d %H:%i:%s')
					</if>
					<if test=" enddefined17 != null and enddefined17 !='' ">
						AND r.defined17 <![CDATA[ <= ]]>
						str_to_date(concat(#{enddefined17,jdbcType=VARCHAR}, '23:59:59'),
			                                       '%Y-%m-%d %H:%i:%s')
					</if>	
					<if test=" startdefined18!= null and startdefined18 !='' ">
						AND r.defined18 >=
						 str_to_date(concat(#{startdefined18,jdbcType=VARCHAR}, '00:00:00'),
			                                       '%Y-%m-%d %H:%i:%s')
					</if>
					<if test=" enddefined18 != null and enddefined18 !='' ">
						AND r.defined18 <![CDATA[ <= ]]>
						str_to_date(concat(#{enddefined18,jdbcType=VARCHAR}, '23:59:59'),
			                                       '%Y-%m-%d %H:%i:%s')
					</if>	
					 <if test="state == 0 and qKeyWord != null and qKeyWord != '' and queryType == 'phone'">
			       		<choose>
			       			<when test="queryType == 'phone'">
			       			    and r.mobilephone = #{qKeyWord}
			       			</when>	
			       		</choose>
			        </if>
                    <if test="inputStatusList != null and inputStatusList.size() > 0">
                        AND r.INPUT_STATUS IN
                        <foreach collection="inputStatusList" item="inputId" open="(" separator="," close=")">
                            #{inputId}
                        </foreach>
                    </if>
					and r.type = 1
					and r.is_del=0
					and r.status = 1
					<if test="state == 0 and qKeyWord != null and qKeyWord != '' and queryType == 'phone'">
					union
					select r.RES_CUST_ID
					  FROM
					    tsm_res_cust_info r 	     
					  WHERE
					   r.org_id =#{orgId,jdbcType=VARCHAR}
			         <if test="resIds != null and resIds.size() > 0">
				   		AND r.RES_CUST_ID IN 
				   			<foreach collection="resIds" item="rid" open="(" separator="," close=")">
				   				#{rid}
				   			</foreach>
				   	</if>
					<if test="deptIds!=null">
						AND r.import_dept_id IN 
							<foreach collection="deptIds" item="deptId" open="(" separator=","
								close=")">
								#{deptId}
							</foreach>	
						
					</if>
					<if test="deptIds==null">
						AND r.input_acc =#{inputAcc}
					</if>		
					<if test="startDate!=null and startDate!='' ">
				       <![CDATA[
			            AND r.input_date>=str_to_date(  CONCAT(#{startDate},' 00:00:00'), '%Y-%m-%d %H:%i:%s') 	       				   	       
					   ]]>
					</if>
					<if test="endDate!=null and endDate!=''">
					   <![CDATA[
					     AND r.input_date<=str_to_date(  CONCAT(#{endDate},' 23:59:59'), '%Y-%m-%d %H:%i:%s') 	 
					   ]]>
					</if>
					<choose>
						<when test="resGroupIds != null and resGroupIds.size() > 0">
							AND r.res_group_id in 
							<foreach collection="resGroupIds" item="rgid" open="(" separator="," close=")">
				   				#{rgid}
				   			</foreach>
						</when>
						<when test="resGroupIds == null"></when>
						<otherwise>
							AND r.res_group_id in ('')
						</otherwise>
					</choose>
					<if test=" companyTrade != null and companyTrade != '' ">
						AND r.company_trade = #{companyTrade,jdbcType=VARCHAR}
					</if>
					<if test=" provinceId != null and provinceId != '' ">
						AND r.province_id = #{provinceId,jdbcType=VARCHAR}
					</if>
					<if test=" cityId != null and cityId != '' ">
						AND r.city_id = #{cityId,jdbcType=VARCHAR}
					</if>
					<if test=" countyId != null and countyId != '' ">
						AND r.county_id = #{countyId,jdbcType=VARCHAR}
					</if>
					<if test="defined1 != null and defined1 != ''">
						AND r.defined1 =#{defined1}
					</if>	
					<if test="defined2 != null and defined2 != ''">
						AND r.defined2 =#{defined2}
					</if>	
					<if test="defined3 != null and defined3 != ''">
						AND r.defined3 =#{defined3}
					</if>	
					<if test="defined4 != null and defined4 != ''">
						AND r.defined4 =#{defined4}
					</if>	
					<if test="defined5 != null and defined5 != ''">
						AND r.defined5 =#{defined5}
					</if>	
					<if test="defined6 != null and defined6 != ''">
						AND r.defined6 =#{defined6}
					</if>	
					<if test="defined7 != null and defined7 != ''">
						AND r.defined7 =#{defined7}
					</if>	
					<if test="defined8 != null and defined8 != ''">
						AND r.defined8 =#{defined8}
					</if>	
					<if test="defined9 != null and defined9 != ''">
						AND r.defined9 =#{defined9}
					</if>	
					<if test="defined10 != null and defined10 != ''">
						AND r.defined10 =#{defined10}
					</if>	
					<if test="defined11 != null and defined11 != ''">
						AND r.defined11 =#{defined11}
					</if>	
					<if test="defined12 != null and defined12 != ''">
						AND r.defined12 =#{defined12}
					</if>	
					<if test="defined13 != null and defined13 != ''">
						AND r.defined13 =#{defined13}
					</if>	
					<if test="defined14 != null and defined14 != ''">
						AND r.defined14 =#{defined14}
					</if>	
					<if test="defined15 != null and defined15 != ''">
						AND r.defined15 =#{defined15}
					</if>
					<if test=" startdefined16!= null and startdefined16 !='' ">
						AND r.defined16 >=
						 str_to_date(concat(#{startdefined16,jdbcType=VARCHAR}, '00:00:00'),
			                                       '%Y-%m-%d %H:%i:%s')
					</if>
					<if test=" enddefined16 != null and enddefined16 !='' ">
						AND r.defined16 <![CDATA[ <= ]]>
						str_to_date(concat(#{enddefined16,jdbcType=VARCHAR}, '23:59:59'),
			                                       '%Y-%m-%d %H:%i:%s')
					</if>
					<if test=" startdefined17!= null and startdefined17 !='' ">
						AND r.defined17 >=
						 str_to_date(concat(#{startdefined17,jdbcType=VARCHAR}, '00:00:00'),
			                                       '%Y-%m-%d %H:%i:%s')
					</if>
					<if test=" enddefined17 != null and enddefined17 !='' ">
						AND r.defined17 <![CDATA[ <= ]]>
						str_to_date(concat(#{enddefined17,jdbcType=VARCHAR}, '23:59:59'),
			                                       '%Y-%m-%d %H:%i:%s')
					</if>	
					<if test=" startdefined18!= null and startdefined18 !='' ">
						AND r.defined18 >=
						 str_to_date(concat(#{startdefined18,jdbcType=VARCHAR}, '00:00:00'),
			                                       '%Y-%m-%d %H:%i:%s')
					</if>
					<if test=" enddefined18 != null and enddefined18 !='' ">
						AND r.defined18 <![CDATA[ <= ]]>
						str_to_date(concat(#{enddefined18,jdbcType=VARCHAR}, '23:59:59'),
			                                       '%Y-%m-%d %H:%i:%s')
					</if>	
					 <if test="state == 0 and qKeyWord != null and qKeyWord != '' and queryType == 'phone'">
			       		<choose>
			       			<when test="queryType == 'phone'">
			       			    and r.telphone = #{qKeyWord}
			       			</when>	
			       		</choose>
			        </if>
                        <if test="inputStatusList != null and inputStatusList.size() > 0">
                            AND r.INPUT_STATUS IN
                            <foreach collection="inputStatusList" item="inputId" open="(" separator="," close=")">
                                #{inputId}
                            </foreach>
                        </if>
					and r.type = 1
					and r.is_del=0
					and r.status = 1
					</if>)t
				 limit #{page.currentResult,jdbcType=DECIMAL},#{page.showCount,jdbcType=DECIMAL}
	</select>
	<select id="findUnAssginResWithPhonePageList" resultMap="compResMap" parameterType="map"> 
		select r.RES_CUST_ID,r.company,r.NAME,r.MOBILEPHONE,r.TELPHONE,r.INPUT_DATE,r.ORG_ID,r.import_dept_id,r.RES_GROUP_ID,
				   r.main_linkman,
				   r.company_fax,
				   r.company_trade,
				   r.company_money,
				   r.company_user,
				   r.KEYWORD,
				   r.address,
				   r.province_id,
				   r.city_id,
				   r.county_id,
				   r.DEFINED1,
                   r.DEFINED2,
                   r.DEFINED3,
                   r.DEFINED4,
                   r.DEFINED5,
                   r.DEFINED6,
                   r.DEFINED7,
                   r.DEFINED8,
                   r.DEFINED9,
                   r.DEFINED10,
                   r.DEFINED11,
                   r.DEFINED12,
                   r.DEFINED13,
                   r.DEFINED14,
                   r.DEFINED15,
                   r.DEFINED16,
                   r.DEFINED17,
                   r.DEFINED18,
                   r.INPUT_STATUS
                   FROM
					    tsm_res_cust_info r 	     
				   WHERE
				   r.org_id =#{orgId,jdbcType=VARCHAR}
				   <if test="ids!=null">
						AND r.res_cust_id IN 
							<foreach collection="ids" item="id" open="(" separator=","
								close=")">
								#{id}
							</foreach>
					</if>
	</select>
	
	<!-- 获取公司待分配资源信息(电话查询)count -->
	<select id="findUnAssginResWithPhoneCount" resultType="Integer"
		parameterType="com.qftx.tsm.cust.dto.ResCustDto"> 
				 select count(1) from 
				 	(select r.res_cust_id
				 	from
					  tsm_res_cust_info r 	     
					  WHERE
					   r.org_id =#{orgId,jdbcType=VARCHAR}
					<if test="resIds != null and resIds.size() > 0">
				   		AND r.RES_CUST_ID IN 
				   			<foreach collection="resIds" item="rid" open="(" separator="," close=")">
				   				#{rid}
				   			</foreach>
				   	</if>
					<if test="deptIds!=null">
						AND r.import_dept_id IN 
							<foreach collection="deptIds" item="deptId" open="(" separator=","
								close=")">
								#{deptId}
							</foreach>	
					</if>
					<if test="deptIds==null">
						AND r.input_acc =#{inputAcc}
					</if>		
					<if test="startDate!=null and startDate!='' ">
				       <![CDATA[
			            AND r.input_date>=str_to_date(  CONCAT(#{startDate},' 00:00:00'), '%Y-%m-%d %H:%i:%s') 	       				   	       
					   ]]>
					</if>
					<if test="endDate!=null and endDate!=''">
					   <![CDATA[
					     AND r.input_date<=str_to_date(  CONCAT(#{endDate},' 23:59:59'), '%Y-%m-%d %H:%i:%s') 	 
					   ]]>
					</if>
					<choose>
						<when test="resGroupIds != null and resGroupIds.size() > 0">
							AND r.res_group_id in 
							<foreach collection="resGroupIds" item="rgid" open="(" separator="," close=")">
				   				#{rgid}
				   			</foreach>
						</when>
						<when test="resGroupIds == null"></when>
						<otherwise>
							AND r.res_group_id in ('')
						</otherwise>
					</choose>
					<if test=" companyTrade != null and companyTrade != '' ">
						AND r.company_trade = #{companyTrade,jdbcType=VARCHAR}
					</if>
					<if test=" provinceId != null and provinceId != '' ">
						AND r.province_id = #{provinceId,jdbcType=VARCHAR}
					</if>
					<if test=" cityId != null and cityId != '' ">
						AND r.city_id = #{cityId,jdbcType=VARCHAR}
					</if>
					<if test=" countyId != null and countyId != '' ">
						AND r.county_id = #{countyId,jdbcType=VARCHAR}
					</if>
					<if test="defined1 != null and defined1 != ''">
						AND r.defined1 =#{defined1}
					</if>	
					<if test="defined2 != null and defined2 != ''">
						AND r.defined2 =#{defined2}
					</if>	
					<if test="defined3 != null and defined3 != ''">
						AND r.defined3 =#{defined3}
					</if>	
					<if test="defined4 != null and defined4 != ''">
						AND r.defined4 =#{defined4}
					</if>	
					<if test="defined5 != null and defined5 != ''">
						AND r.defined5 =#{defined5}
					</if>	
					<if test="defined6 != null and defined6 != ''">
						AND r.defined6 =#{defined6}
					</if>	
					<if test="defined7 != null and defined7 != ''">
						AND r.defined7 =#{defined7}
					</if>	
					<if test="defined8 != null and defined8 != ''">
						AND r.defined8 =#{defined8}
					</if>	
					<if test="defined9 != null and defined9 != ''">
						AND r.defined9 =#{defined9}
					</if>	
					<if test="defined10 != null and defined10 != ''">
						AND r.defined10 =#{defined10}
					</if>	
					<if test="defined11 != null and defined11 != ''">
						AND r.defined11 =#{defined11}
					</if>	
					<if test="defined12 != null and defined12 != ''">
						AND r.defined12 =#{defined12}
					</if>	
					<if test="defined13 != null and defined13 != ''">
						AND r.defined13 =#{defined13}
					</if>	
					<if test="defined14 != null and defined14 != ''">
						AND r.defined14 =#{defined14}
					</if>	
					<if test="defined15 != null and defined15 != ''">
						AND r.defined15 =#{defined15}
					</if>
					<if test=" startdefined16!= null and startdefined16 !='' ">
						AND r.defined16 >=
						 str_to_date(concat(#{startdefined16,jdbcType=VARCHAR}, '00:00:00'),
			                                       '%Y-%m-%d %H:%i:%s')
					</if>
					<if test=" enddefined16 != null and enddefined16 !='' ">
						AND r.defined16 <![CDATA[ <= ]]>
						str_to_date(concat(#{enddefined16,jdbcType=VARCHAR}, '23:59:59'),
			                                       '%Y-%m-%d %H:%i:%s')
					</if>
					<if test=" startdefined17!= null and startdefined17 !='' ">
						AND r.defined17 >=
						 str_to_date(concat(#{startdefined17,jdbcType=VARCHAR}, '00:00:00'),
			                                       '%Y-%m-%d %H:%i:%s')
					</if>
					<if test=" enddefined17 != null and enddefined17 !='' ">
						AND r.defined17 <![CDATA[ <= ]]>
						str_to_date(concat(#{enddefined17,jdbcType=VARCHAR}, '23:59:59'),
			                                       '%Y-%m-%d %H:%i:%s')
					</if>	
					<if test=" startdefined18!= null and startdefined18 !='' ">
						AND r.defined18 >=
						 str_to_date(concat(#{startdefined18,jdbcType=VARCHAR}, '00:00:00'),
			                                       '%Y-%m-%d %H:%i:%s')
					</if>
					<if test=" enddefined18 != null and enddefined18 !='' ">
						AND r.defined18 <![CDATA[ <= ]]>
						str_to_date(concat(#{enddefined18,jdbcType=VARCHAR}, '23:59:59'),
			                                       '%Y-%m-%d %H:%i:%s')
					</if>
					 <if test="state == 0 and qKeyWord != null and qKeyWord != '' and queryType == 'phone'">
			       		<choose>
			       			<when test="queryType == 'phone'">
			       			    and r.mobilephone = #{qKeyWord}
			       			</when>	
			       		</choose>
			        </if>
                    <if test="inputStatusList != null and inputStatusList.size() > 0">
                        AND r.INPUT_STATUS IN
                        <foreach collection="inputStatusList" item="inputId" open="(" separator="," close=")">
                            #{inputId}
                        </foreach>
                    </if>
					and r.type = 1
					and r.is_del=0
					and r.status = 1
					 <if test="state == 0 and qKeyWord != null and qKeyWord != '' and queryType == 'phone'">
					 union
					 select r.res_cust_id
				 	from
					  tsm_res_cust_info r 	     
					  WHERE
					   r.org_id =#{orgId,jdbcType=VARCHAR}
					<if test="resIds != null and resIds.size() > 0">
				   		AND r.RES_CUST_ID IN 
				   			<foreach collection="resIds" item="rid" open="(" separator="," close=")">
				   				#{rid}
				   			</foreach>
				   	</if>
					<if test="deptIds!=null">
						AND r.import_dept_id IN 
							<foreach collection="deptIds" item="deptId" open="(" separator=","
								close=")">
								#{deptId}
							</foreach>	
						
					</if>
					<if test="deptIds==null">
						AND r.input_acc =#{inputAcc}
					</if>		
					<if test="startDate!=null and startDate!='' ">
				       <![CDATA[
			            AND r.input_date>=str_to_date(  CONCAT(#{startDate},' 00:00:00'), '%Y-%m-%d %H:%i:%s') 	       				   	       
					   ]]>
					</if>
					<if test="endDate!=null and endDate!=''">
					   <![CDATA[
					     AND r.input_date<=str_to_date(  CONCAT(#{endDate},' 23:59:59'), '%Y-%m-%d %H:%i:%s') 	 
					   ]]>
					</if>
					<choose>
						<when test="resGroupIds != null and resGroupIds.size() > 0">
							AND r.res_group_id in 
							<foreach collection="resGroupIds" item="rgid" open="(" separator="," close=")">
				   				#{rgid}
				   			</foreach>
						</when>
						<when test="resGroupIds == null"></when>
						<otherwise>
							AND r.res_group_id in ('')
						</otherwise>
					</choose>
					<if test=" companyTrade != null and companyTrade != '' ">
						AND r.company_trade = #{companyTrade,jdbcType=VARCHAR}
					</if>
					<if test=" provinceId != null and provinceId != '' ">
						AND r.province_id = #{provinceId,jdbcType=VARCHAR}
					</if>
					<if test=" cityId != null and cityId != '' ">
						AND r.city_id = #{cityId,jdbcType=VARCHAR}
					</if>
					<if test=" countyId != null and countyId != '' ">
						AND r.county_id = #{countyId,jdbcType=VARCHAR}
					</if>
					<if test="defined1 != null and defined1 != ''">
						AND r.defined1 =#{defined1}
					</if>	
					<if test="defined2 != null and defined2 != ''">
						AND r.defined2 =#{defined2}
					</if>	
					<if test="defined3 != null and defined3 != ''">
						AND r.defined3 =#{defined3}
					</if>	
					<if test="defined4 != null and defined4 != ''">
						AND r.defined4 =#{defined4}
					</if>	
					<if test="defined5 != null and defined5 != ''">
						AND r.defined5 =#{defined5}
					</if>	
					<if test="defined6 != null and defined6 != ''">
						AND r.defined6 =#{defined6}
					</if>	
					<if test="defined7 != null and defined7 != ''">
						AND r.defined7 =#{defined7}
					</if>	
					<if test="defined8 != null and defined8 != ''">
						AND r.defined8 =#{defined8}
					</if>	
					<if test="defined9 != null and defined9 != ''">
						AND r.defined9 =#{defined9}
					</if>	
					<if test="defined10 != null and defined10 != ''">
						AND r.defined10 =#{defined10}
					</if>	
					<if test="defined11 != null and defined11 != ''">
						AND r.defined11 =#{defined11}
					</if>	
					<if test="defined12 != null and defined12 != ''">
						AND r.defined12 =#{defined12}
					</if>	
					<if test="defined13 != null and defined13 != ''">
						AND r.defined13 =#{defined13}
					</if>	
					<if test="defined14 != null and defined14 != ''">
						AND r.defined14 =#{defined14}
					</if>	
					<if test="defined15 != null and defined15 != ''">
						AND r.defined15 =#{defined15}
					</if>
					<if test=" startdefined16!= null and startdefined16 !='' ">
						AND r.defined16 >=
						 str_to_date(concat(#{startdefined16,jdbcType=VARCHAR}, '00:00:00'),
			                                       '%Y-%m-%d %H:%i:%s')
					</if>
					<if test=" enddefined16 != null and enddefined16 !='' ">
						AND r.defined16 <![CDATA[ <= ]]>
						str_to_date(concat(#{enddefined16,jdbcType=VARCHAR}, '23:59:59'),
			                                       '%Y-%m-%d %H:%i:%s')
					</if>
					<if test=" startdefined17!= null and startdefined17 !='' ">
						AND r.defined17 >=
						 str_to_date(concat(#{startdefined17,jdbcType=VARCHAR}, '00:00:00'),
			                                       '%Y-%m-%d %H:%i:%s')
					</if>
					<if test=" enddefined17 != null and enddefined17 !='' ">
						AND r.defined17 <![CDATA[ <= ]]>
						str_to_date(concat(#{enddefined17,jdbcType=VARCHAR}, '23:59:59'),
			                                       '%Y-%m-%d %H:%i:%s')
					</if>	
					<if test=" startdefined18!= null and startdefined18 !='' ">
						AND r.defined18 >=
						 str_to_date(concat(#{startdefined18,jdbcType=VARCHAR}, '00:00:00'),
			                                       '%Y-%m-%d %H:%i:%s')
					</if>
					<if test=" enddefined18 != null and enddefined18 !='' ">
						AND r.defined18 <![CDATA[ <= ]]>
						str_to_date(concat(#{enddefined18,jdbcType=VARCHAR}, '23:59:59'),
			                                       '%Y-%m-%d %H:%i:%s')
					</if>
					 <if test="state == 0 and qKeyWord != null and qKeyWord != '' and queryType == 'phone'">
			       		<choose>
			       			<when test="queryType == 'phone'">
			       			    and r.telphone = #{qKeyWord}
			       			</when>	
			       		</choose>
			        </if>
                         <if test="inputStatusList != null and inputStatusList.size() > 0">
                             AND r.INPUT_STATUS IN
                             <foreach collection="inputStatusList" item="inputId" open="(" separator="," close=")">
                                 #{inputId}
                             </foreach>
                         </if>
					and r.type = 1
					and r.is_del=0
					and r.status = 1
					 </if>)t
	</select>
	<!-- 获取公司待分配资源信息 -->
	<select id="findUnAssginResIds" resultType="String"
		parameterType="com.qftx.tsm.cust.dto.ResCustDto"> 
				  select r.RES_CUST_ID
					  FROM
					    tsm_res_cust_info r 	     
					  WHERE
					   r.org_id =#{orgId,jdbcType=VARCHAR}
					<if test="resIds != null and resIds.size() > 0">
				   		AND r.RES_CUST_ID IN 
				   			<foreach collection="resIds" item="rid" open="(" separator="," close=")">
				   				#{rid}
				   			</foreach>
				   	</if>  
					<if test="qKeyWord != null and qKeyWord != ''">
			       		<choose>
			       			<when test="queryType == 'name'">
			                    and r.name LIKE CONCAT('%',#{qKeyWord},'%') 
			       			</when>
			       			<when test="queryType == 'company'">
			       			    and r.company LIKE CONCAT('%',#{qKeyWord},'%')
			       			</when>	
			       			<when test="queryType == 'mainLinkman' and (state == null or state == 0)">
			       			    and r.main_linkman LIKE CONCAT('%',#{qKeyWord},'%')
			       			</when>	
                            <otherwise>
                               and ${queryType} LIKE CONCAT('%',#{qKeyWord},'%')
                            </otherwise>			       					       			
			       		</choose>
			        </if>
					<if test="deptIds!=null">
						AND r.import_dept_id IN 
							<foreach collection="deptIds" item="deptId" open="(" separator=","
								close=")">
								#{deptId}
							</foreach>	
						
					</if>
					<if test="deptIds==null">
						AND r.input_acc =#{inputAcc}
					</if>		
					<if test="startDate!=null and startDate!='' ">
				       <![CDATA[
			            AND r.input_date>=str_to_date(  CONCAT(#{startDate},' 00:00:00'), '%Y-%m-%d %H:%i:%s') 	       				   	       
					   ]]>
					</if>
					<if test="endDate!=null and endDate!=''">
					   <![CDATA[
					     AND r.input_date<=str_to_date(  CONCAT(#{endDate},' 23:59:59'), '%Y-%m-%d %H:%i:%s') 	 
					   ]]>
					</if>
					<choose>
						<when test="resGroupIds != null and resGroupIds.size() > 0">
							AND r.res_group_id in 
							<foreach collection="resGroupIds" item="rgid" open="(" separator="," close=")">
				   				#{rgid}
				   			</foreach>
						</when>
						<when test="resGroupIds == null"></when>
						<otherwise>
							AND r.res_group_id in ('')
						</otherwise>
					</choose>
					<if test=" companyTrade != null and companyTrade != '' ">
						AND r.company_trade = #{companyTrade,jdbcType=VARCHAR}
					</if>
					<if test=" provinceId != null and provinceId != '' ">
						AND r.province_id = #{provinceId,jdbcType=VARCHAR}
					</if>
					<if test=" cityId != null and cityId != '' ">
						AND r.city_id = #{cityId,jdbcType=VARCHAR}
					</if>
					<if test=" countyId != null and countyId != '' ">
						AND r.county_id = #{countyId,jdbcType=VARCHAR}
					</if>
					<if test="defined1 != null and defined1 != ''">
						AND r.defined1 =#{defined1}
					</if>	
					<if test="defined2 != null and defined2 != ''">
						AND r.defined2 =#{defined2}
					</if>	
					<if test="defined3 != null and defined3 != ''">
						AND r.defined3 =#{defined3}
					</if>	
					<if test="defined4 != null and defined4 != ''">
						AND r.defined4 =#{defined4}
					</if>	
					<if test="defined5 != null and defined5 != ''">
						AND r.defined5 =#{defined5}
					</if>	
					<if test="defined6 != null and defined6 != ''">
						AND r.defined6 =#{defined6}
					</if>	
					<if test="defined7 != null and defined7 != ''">
						AND r.defined7 =#{defined7}
					</if>	
					<if test="defined8 != null and defined8 != ''">
						AND r.defined8 =#{defined8}
					</if>	
					<if test="defined9 != null and defined9 != ''">
						AND r.defined9 =#{defined9}
					</if>	
					<if test="defined10 != null and defined10 != ''">
						AND r.defined10 =#{defined10}
					</if>	
					<if test="defined11 != null and defined11 != ''">
						AND r.defined11 =#{defined11}
					</if>	
					<if test="defined12 != null and defined12 != ''">
						AND r.defined12 =#{defined12}
					</if>	
					<if test="defined13 != null and defined13 != ''">
						AND r.defined13 =#{defined13}
					</if>	
					<if test="defined14 != null and defined14 != ''">
						AND r.defined14 =#{defined14}
					</if>	
					<if test="defined15 != null and defined15 != ''">
						AND r.defined15 =#{defined15}
					</if>
					<if test=" startdefined16!= null and startdefined16 !='' ">
						AND r.defined16 >=
						 str_to_date(concat(#{startdefined16,jdbcType=VARCHAR}, '00:00:00'),
			                                       '%Y-%m-%d %H:%i:%s')
					</if>
					<if test=" enddefined16 != null and enddefined16 !='' ">
						AND r.defined16 <![CDATA[ <= ]]>
						str_to_date(concat(#{enddefined16,jdbcType=VARCHAR}, '23:59:59'),
			                                       '%Y-%m-%d %H:%i:%s')
					</if>
					<if test=" startdefined17!= null and startdefined17 !='' ">
						AND r.defined17 >=
						 str_to_date(concat(#{startdefined17,jdbcType=VARCHAR}, '00:00:00'),
			                                       '%Y-%m-%d %H:%i:%s')
					</if>
					<if test=" enddefined17 != null and enddefined17 !='' ">
						AND r.defined17 <![CDATA[ <= ]]>
						str_to_date(concat(#{enddefined17,jdbcType=VARCHAR}, '23:59:59'),
			                                       '%Y-%m-%d %H:%i:%s')
					</if>	
					<if test=" startdefined18!= null and startdefined18 !='' ">
						AND r.defined18 >=
						 str_to_date(concat(#{startdefined18,jdbcType=VARCHAR}, '00:00:00'),
			                                       '%Y-%m-%d %H:%i:%s')
					</if>
					<if test=" enddefined18 != null and enddefined18 !='' ">
						AND r.defined18 <![CDATA[ <= ]]>
						str_to_date(concat(#{enddefined18,jdbcType=VARCHAR}, '23:59:59'),
			                                       '%Y-%m-%d %H:%i:%s')
					</if>	
					
					
					<if test="inputStatusList != null and inputStatusList.size() > 0">
						AND r.INPUT_STATUS IN 
						<foreach collection="inputStatusList" item="inputId" open="(" separator="," close=")">
							#{inputId}
						</foreach>
					</if>
					and r.type = 1
					and r.is_del=0
					and r.status = 1
				 order by r.input_Date desc 
				 limit #{page.currentResult,jdbcType=DECIMAL},#{page.showCount,jdbcType=DECIMAL}
	</select>
	<select id="findUnAssginResPageList" resultMap="compResMap" parameterType="map"> 
		select r.RES_CUST_ID,r.company,r.NAME,r.MOBILEPHONE,r.TELPHONE,r.INPUT_DATE,r.ORG_ID,r.import_dept_id,r.RES_GROUP_ID,
				   r.main_linkman,
				   r.company_fax,
				   r.company_trade,
				   r.company_money,
				   r.company_user,
				   r.KEYWORD,
				   r.address,
				   r.province_id,
				   r.city_id,
				   r.county_id,
				   r.DEFINED1,
                   r.DEFINED2,
                   r.DEFINED3,
                   r.DEFINED4,
                   r.DEFINED5,
                   r.DEFINED6,
                   r.DEFINED7,
                   r.DEFINED8,
                   r.DEFINED9,
                   r.DEFINED10,
                   r.DEFINED11,
                   r.DEFINED12,
                   r.DEFINED13,
                   r.DEFINED14,
                   r.DEFINED15,
                   r.DEFINED16,
                   r.DEFINED17,
                   r.DEFINED18,
                   r.INPUT_STATUS
                   FROM
					    tsm_res_cust_info r 	     
				   WHERE
					   r.org_id =#{orgId,jdbcType=VARCHAR}
				   <if test="ids!=null">
						AND r.res_cust_id IN 
							<foreach collection="ids" item="id" open="(" separator=","
								close=")">
								#{id}
							</foreach>	
					</if>
					   
	</select>
	<!-- <select id="findUnAssginResPageList" resultMap="compResMap"
		parameterType="com.qftx.tsm.cust.dto.ResCustDto"> 
				  select r.RES_CUST_ID,r.company,r.NAME,r.MOBILEPHONE,r.TELPHONE,r.INPUT_DATE,r.ORG_ID,r.import_dept_id,r.RES_GROUP_ID,
				   r.main_linkman,
				   r.company_fax,
				   r.company_trade,
				   r.company_money,
				   r.company_user,
				   r.KEYWORD,
				   r.address,
				   r.province_id,
				   r.city_id,
				   r.county_id,
				   r.DEFINED1,
                   r.DEFINED2,
                   r.DEFINED3,
                   r.DEFINED4,
                   r.DEFINED5,
                   r.DEFINED6,
                   r.DEFINED7,
                   r.DEFINED8,
                   r.DEFINED9,
                   r.DEFINED10,
                   r.DEFINED11,
                   r.DEFINED12,
                   r.DEFINED13,
                   r.DEFINED14,
                   r.DEFINED15,
                   r.DEFINED16,
                   r.DEFINED17,
                   r.DEFINED18
					  FROM
					    tsm_res_cust_info r 	     
					  WHERE
					   r.org_id =#{orgId,jdbcType=VARCHAR}
					<if test="qKeyWord != null and qKeyWord != ''">
			       		<choose>
			       			<when test="queryType == 'name'">
			                    and r.name LIKE CONCAT('%',#{qKeyWord},'%') 
			       			</when>
			       			<when test="queryType == 'mainLinkman'">
			       			    and r.main_linkman LIKE CONCAT('%',#{qKeyWord},'%')
			       			</when>
			       			<when test="queryType == 'company'">
			       			    and r.company LIKE CONCAT('%',#{qKeyWord},'%')
			       			</when>	
                            <otherwise>
                               and ${queryType} LIKE CONCAT('%',#{qKeyWord},'%')
                            </otherwise>			       					       			
			       		</choose>
			        </if>
					<if test="deptIds!=null">
						AND r.import_dept_id IN 
							<foreach collection="deptIds" item="deptId" open="(" separator=","
								close=")">
								#{deptId}
							</foreach>	
						
					</if>
					<if test="deptIds==null">
						AND r.input_acc =#{inputAcc}
					</if>		
					<if test="startDate!=null and startDate!='' ">
				       <![CDATA[
			            AND r.input_date>=str_to_date(  CONCAT(#{startDate},' 00:00:00'), '%Y-%m-%d %H:%i:%s') 	       				   	       
					   ]]>
					</if>
					<if test="endDate!=null and endDate!=''">
					   <![CDATA[
					     AND r.input_date<=str_to_date(  CONCAT(#{endDate},' 23:59:59'), '%Y-%m-%d %H:%i:%s') 	 
					   ]]>
					</if>
					<if test="resGroupId!=null and resGroupId!=''">
					   <![CDATA[
					   AND r.res_group_id = #{resGroupId}
					   ]]>
					</if>
					<if test=" startdefined16!= null and startdefined16 !='' ">
						AND r.defined16 >=
						 str_to_date(concat(#{startdefined16,jdbcType=VARCHAR}, '00:00:00'),
			                                       '%Y-%m-%d %H:%i:%s')
					</if>
					<if test=" enddefined16 != null and enddefined16 !='' ">
						AND r.defined16 <![CDATA[ <= ]]>
						str_to_date(concat(#{enddefined16,jdbcType=VARCHAR}, '23:59:59'),
			                                       '%Y-%m-%d %H:%i:%s')
					</if>
					<if test=" startdefined17!= null and startdefined17 !='' ">
						AND r.defined17 >=
						 str_to_date(concat(#{startdefined17,jdbcType=VARCHAR}, '00:00:00'),
			                                       '%Y-%m-%d %H:%i:%s')
					</if>
					<if test=" enddefined17 != null and enddefined17 !='' ">
						AND r.defined17 <![CDATA[ <= ]]>
						str_to_date(concat(#{enddefined17,jdbcType=VARCHAR}, '23:59:59'),
			                                       '%Y-%m-%d %H:%i:%s')
					</if>	
					<if test=" startdefined18!= null and startdefined18 !='' ">
						AND r.defined18 >=
						 str_to_date(concat(#{startdefined18,jdbcType=VARCHAR}, '00:00:00'),
			                                       '%Y-%m-%d %H:%i:%s')
					</if>
					<if test=" enddefined18 != null and enddefined18 !='' ">
						AND r.defined18 <![CDATA[ <= ]]>
						str_to_date(concat(#{enddefined18,jdbcType=VARCHAR}, '23:59:59'),
			                                       '%Y-%m-%d %H:%i:%s')
					</if>	
					and r.type = 1
					and r.is_del=0
					and r.status = 1
				 order by r.input_Date desc
				 limit #{page.currentResult,jdbcType=DECIMAL},#{page.showCount,jdbcType=DECIMAL}
	</select> -->
	<!-- 获取公司待分配资源信息count -->
	<select id="findUnAssginResCount" resultType="Integer"
		parameterType="com.qftx.tsm.cust.dto.ResCustDto">
				  select count(1)
					  FROM
					    tsm_res_cust_info r 	     
					  WHERE
					   r.org_id =#{orgId,jdbcType=VARCHAR}
					<if test="resIds != null and resIds.size() > 0">
				   		AND r.RES_CUST_ID IN 
				   			<foreach collection="resIds" item="rid" open="(" separator="," close=")">
				   				#{rid}
				   			</foreach>
				   	</if>   
					<if test="qKeyWord != null and qKeyWord != ''">
			       		<choose>
			       			<when test="queryType == 'name'">
			                    and r.name LIKE CONCAT('%',#{qKeyWord},'%') 
			       			</when>
			       			<when test="queryType == 'company'">
			       			    and r.company LIKE CONCAT('%',#{qKeyWord},'%')
			       			</when>	
			       			<when test="queryType == 'mainLinkman' and (state == null or state == 0)">
			       			    and r.main_linkman LIKE CONCAT('%',#{qKeyWord},'%')
			       			</when>	
                            <otherwise>
                               and ${queryType} LIKE CONCAT('%',#{qKeyWord},'%')
                            </otherwise>			       					       			
			       		</choose>
			        </if>
					<if test="deptIds!=null">
						AND r.import_dept_id IN 
							<foreach collection="deptIds" item="deptId" open="(" separator=","
								close=")">
								#{deptId}
							</foreach>	
						
					</if>
					<if test="deptIds==null">
						AND r.input_acc =#{inputAcc}
					</if>		
					<if test="startDate!=null and startDate!='' ">
				       <![CDATA[
			            AND r.input_date>=str_to_date(  CONCAT(#{startDate},' 00:00:00'), '%Y-%m-%d %H:%i:%s') 	       				   	       
					   ]]>
					</if>
					<if test="endDate!=null and endDate!=''">
					   <![CDATA[
					     AND r.input_date<=str_to_date(  CONCAT(#{endDate},' 23:59:59'), '%Y-%m-%d %H:%i:%s') 	 
					   ]]>
					</if>
					<choose>
						<when test="resGroupIds != null and resGroupIds.size() > 0">
							AND r.res_group_id in 
							<foreach collection="resGroupIds" item="rgid" open="(" separator="," close=")">
				   				#{rgid}
				   			</foreach>
						</when>
						<when test="resGroupIds == null"></when>
						<otherwise>
							AND r.res_group_id in ('')
						</otherwise>
					</choose>
					<if test=" companyTrade != null and companyTrade != '' ">
						AND r.company_trade = #{companyTrade,jdbcType=VARCHAR}
					</if>
					<if test=" provinceId != null and provinceId != '' ">
						AND r.province_id = #{provinceId,jdbcType=VARCHAR}
					</if>
					<if test=" cityId != null and cityId != '' ">
						AND r.city_id = #{cityId,jdbcType=VARCHAR}
					</if>
					<if test=" countyId != null and countyId != '' ">
						AND r.county_id = #{countyId,jdbcType=VARCHAR}
					</if>
					<if test="defined1 != null and defined1 != ''">
						AND r.defined1 =#{defined1}
					</if>	
					<if test="defined2 != null and defined2 != ''">
						AND r.defined2 =#{defined2}
					</if>	
					<if test="defined3 != null and defined3 != ''">
						AND r.defined3 =#{defined3}
					</if>	
					<if test="defined4 != null and defined4 != ''">
						AND r.defined4 =#{defined4}
					</if>	
					<if test="defined5 != null and defined5 != ''">
						AND r.defined5 =#{defined5}
					</if>	
					<if test="defined6 != null and defined6 != ''">
						AND r.defined6 =#{defined6}
					</if>	
					<if test="defined7 != null and defined7 != ''">
						AND r.defined7 =#{defined7}
					</if>	
					<if test="defined8 != null and defined8 != ''">
						AND r.defined8 =#{defined8}
					</if>	
					<if test="defined9 != null and defined9 != ''">
						AND r.defined9 =#{defined9}
					</if>	
					<if test="defined10 != null and defined10 != ''">
						AND r.defined10 =#{defined10}
					</if>	
					<if test="defined11 != null and defined11 != ''">
						AND r.defined11 =#{defined11}
					</if>	
					<if test="defined12 != null and defined12 != ''">
						AND r.defined12 =#{defined12}
					</if>	
					<if test="defined13 != null and defined13 != ''">
						AND r.defined13 =#{defined13}
					</if>	
					<if test="defined14 != null and defined14 != ''">
						AND r.defined14 =#{defined14}
					</if>	
					<if test="defined15 != null and defined15 != ''">
						AND r.defined15 =#{defined15}
					</if>
					<if test=" startdefined16!= null and startdefined16 !='' ">
						AND r.defined16 >=
						 str_to_date(concat(#{startdefined16,jdbcType=VARCHAR}, '00:00:00'),
			                                       '%Y-%m-%d %H:%i:%s')
					</if>
					<if test=" enddefined16 != null and enddefined16 !='' ">
						AND r.defined16 <![CDATA[ <= ]]>
						str_to_date(concat(#{enddefined16,jdbcType=VARCHAR}, '23:59:59'),
			                                       '%Y-%m-%d %H:%i:%s')
					</if>
					<if test=" startdefined17!= null and startdefined17 !='' ">
						AND r.defined17 >=
						 str_to_date(concat(#{startdefined17,jdbcType=VARCHAR}, '00:00:00'),
			                                       '%Y-%m-%d %H:%i:%s')
					</if>
					<if test=" enddefined17 != null and enddefined17 !='' ">
						AND r.defined17 <![CDATA[ <= ]]>
						str_to_date(concat(#{enddefined17,jdbcType=VARCHAR}, '23:59:59'),
			                                       '%Y-%m-%d %H:%i:%s')
					</if>	
					<if test=" startdefined18!= null and startdefined18 !='' ">
						AND r.defined18 >=
						 str_to_date(concat(#{startdefined18,jdbcType=VARCHAR}, '00:00:00'),
			                                       '%Y-%m-%d %H:%i:%s')
					</if>
					<if test=" enddefined18 != null and enddefined18 !='' ">
						AND r.defined18 <![CDATA[ <= ]]>
						str_to_date(concat(#{enddefined18,jdbcType=VARCHAR}, '23:59:59'),
			                                       '%Y-%m-%d %H:%i:%s')
					</if>
					<if test="inputStatusList != null and inputStatusList.size() > 0">
						AND r.INPUT_STATUS IN
						<foreach collection="inputStatusList" item="inputStatus" open="(" separator="," close=")">
							#{inputStatus}
						</foreach>
					</if>
					and r.type = 1
					and r.is_del=0
					and r.status = 1
	</select>
	
		<!-- 资源转入到资源组下 -->
	<update id="updateBatchResToGroup" parameterType="map">
		update
		<include refid="table_name" />
		set UPDATE_ACC =#{account},UPDATE_DATE =
		now(),RES_GROUP_ID=#{groupId}
		where
		 org_id=#{orgId}
		 and RES_CUST_ID in
		<foreach collection="ids" item="id" open="(" separator=","
			close=")">
			#{id}
		</foreach>
	</update>
	
		<!-- 批量伪删除实体 -->
	<update id="removeComResBatch" parameterType="map">
		update
		<include refid="table_name" />
		set IS_DEL = 1,UPDATE_ACC =#{updateacc},UPDATE_DATE = now()
		where
		org_id=#{orgId} and 
		RES_CUST_ID in
		<foreach collection="ids" item="id" open="(" separator=","
			close=")">
			#{id}
		</foreach>
	</update>

	<!-- 获取销售经理下所拥有的资源数量 -->
	<select id="findresourceNum" parameterType="map" resultType="int">
		select IFNULL(count(1),0)
		  from tsm_res_cust_info t
		 where 
		   t.org_id=#{orgId}
		   and t.owner_acc = #{ownerAcc}
		   and t.status = 2
		   and t.is_del = 0
		   and t.type = 1
	</select>
	
	<!-- 根据id查询资源 -->
	<select id="findResList" parameterType="list" resultMap="BaseResultMap">
		select <include refid="Base_Column_List" /> from 
		<include refid="table_name" />
		where
		org_id=#{orgId}
		and RES_CUST_ID in
		<foreach collection="list" item="id" open="(" separator=","
			close=")">
			#{id}
		</foreach>
	</select>	

    <select id="findResByIdsListPage" parameterType="com.qftx.tsm.cust.dto.ResCustInfoDto" resultMap="BaseResultMap">
		select RES_CUST_ID from 
		<include refid="table_name" />
		where
		org_id=#{orgId}
		and RES_CUST_ID in
		<foreach collection="ids" item="id" open="(" separator=","
			close=")">
			#{id}
		</foreach>    
		order by  RES_CUST_ID  desc       
    </select>
	<!-- 按条件查询待分配资源id -->
	<select id="findClearResIds" resultType="list"
		parameterType="com.qftx.tsm.cust.dto.ResCustDto">
		select RES_CUST_ID from tsm_res_cust_info r 
		 where  r.org_id = #{orgId,jdbcType=VARCHAR}
		<if test="deptIds!=null">
			AND r.import_dept_id IN 
				<foreach collection="deptIds" item="deptId" open="(" separator=","
					close=")">
					#{deptId}
				</foreach>	
			
		</if>
		<if test="deptIds==null">
			AND r.INPUT_ACC =#{inputAcc}
		</if>		
		<if test="startDate!=null and startDate!='' ">
	       <![CDATA[
	        AND r.input_date>=str_to_date(  CONCAT(#{startDate},' 00:00:00'), '%Y-%m-%d %H:%i:%s') 	       	
		   ]]>
		</if>
		<if test="endDate!=null and endDate!=''">
		   <![CDATA[
		   AND r.input_date<=str_to_date(  CONCAT(#{endDate},' 23:59:59'), '%Y-%m-%d %H:%i:%s') 	 
		   ]]>
		</if>
	       <if test="qKeyWord != null and qKeyWord != ''">
	       		AND (r.NAME LIKE CONCAT('%',#{qKeyWord,jdbcType=VARCHAR},'%') 
	       			OR r.TELPHONE LIKE CONCAT('%',#{qKeyWord,jdbcType=VARCHAR},'%') 
	       			OR r.MOBILEPHONE LIKE CONCAT('%',#{qKeyWord,jdbcType=VARCHAR},'%')) 
	       </if>		
		<if test="resGroupId!=null and resGroupId!=''">
		   <![CDATA[
		   AND r.RES_GROUP_ID = #{resGroupId}
		   ]]>
		</if>
		and r.type = 1
		and r.is_del=0
		and r.status = 1
	</select>
	
	
	<!-- 全部待分配资源 -->
	<select id="findUnAssginResIdsListPage" resultMap="MinResultMap"
		parameterType="com.qftx.tsm.cust.dto.ResCustDto">
		 select t.RES_CUST_ID FROM
		(select RES_CUST_ID from tsm_res_cust_info r 
		 where  r.org_id = #{orgId,jdbcType=VARCHAR}
		 <if test="resIds != null and resIds.size() > 0">
	   		AND r.RES_CUST_ID IN 
	   			<foreach collection="resIds" item="rid" open="(" separator="," close=")">
	   				#{rid}
	   			</foreach>
	   	</if>
		<if test="deptIds!=null">
			AND r.import_dept_id IN 
				<foreach collection="deptIds" item="deptId" open="(" separator=","
					close=")">
					#{deptId}
				</foreach>	
			
		</if>
		<if test="deptIds==null">
			AND r.INPUT_ACC =#{inputAcc}
		</if>		
		<if test="startDate!=null and startDate!='' ">
	       <![CDATA[
            AND str_to_date(date_format(r.input_date,'%Y-%m-%d'),'%Y-%m-%d')>=str_to_date(#{startDate}, '%Y-%m-%d') 	       				   	       
		   ]]>
		</if>
		<if test="endDate!=null and endDate!=''">
		   <![CDATA[
           AND str_to_date(date_format(r.input_date,'%Y-%m-%d'),'%Y-%m-%d')<=str_to_date(#{endDate}, '%Y-%m-%d') 	       				   
		   ]]>
		</if>
		<choose>
			<when test="resGroupIds != null and resGroupIds.size() > 0">
				AND r.res_group_id in 
				<foreach collection="resGroupIds" item="rgid" open="(" separator="," close=")">
	   				#{rgid}
	   			</foreach>
			</when>
			<when test="resGroupIds == null"></when>
			<otherwise>
				AND r.res_group_id in ('')
			</otherwise>
		</choose>
		<if test="defined1 != null and defined1 != ''">
			AND r.defined1 =#{defined1}
		</if>	
		<if test="defined2 != null and defined2 != ''">
			AND r.defined2 =#{defined2}
		</if>	
		<if test="defined3 != null and defined3 != ''">
			AND r.defined3 =#{defined3}
		</if>	
		<if test="defined4 != null and defined4 != ''">
			AND r.defined4 =#{defined4}
		</if>	
		<if test="defined5 != null and defined5 != ''">
			AND r.defined5 =#{defined5}
		</if>	
		<if test="defined6 != null and defined6 != ''">
			AND r.defined6 =#{defined6}
		</if>	
		<if test="defined7 != null and defined7 != ''">
			AND r.defined7 =#{defined7}
		</if>	
		<if test="defined8 != null and defined8 != ''">
			AND r.defined8 =#{defined8}
		</if>	
		<if test="defined9 != null and defined9 != ''">
			AND r.defined9 =#{defined9}
		</if>	
		<if test="defined10 != null and defined10 != ''">
			AND r.defined10 =#{defined10}
		</if>	
		<if test="defined11 != null and defined11 != ''">
			AND r.defined11 =#{defined11}
		</if>	
		<if test="defined12 != null and defined12 != ''">
			AND r.defined12 =#{defined12}
		</if>	
		<if test="defined13 != null and defined13 != ''">
			AND r.defined13 =#{defined13}
		</if>	
		<if test="defined14 != null and defined14 != ''">
			AND r.defined14 =#{defined14}
		</if>	
		<if test="defined15 != null and defined15 != ''">
			AND r.defined15 =#{defined15}
		</if>
		<if test=" startdefined16!= null and startdefined16 !='' ">
			AND r.defined16 >=
			 str_to_date(concat(#{startdefined16,jdbcType=VARCHAR}, '00:00:00'),
                                       '%Y-%m-%d %H:%i:%s')
		</if>
		<if test=" enddefined16 != null and enddefined16 !='' ">
			AND r.defined16 <![CDATA[ <= ]]>
			str_to_date(concat(#{enddefined16,jdbcType=VARCHAR}, '23:59:59'),
                                       '%Y-%m-%d %H:%i:%s')
		</if>
		<if test=" startdefined17!= null and startdefined17 !='' ">
			AND r.defined17 >=
			 str_to_date(concat(#{startdefined17,jdbcType=VARCHAR}, '00:00:00'),
                                       '%Y-%m-%d %H:%i:%s')
		</if>
		<if test=" enddefined17 != null and enddefined17 !='' ">
			AND r.defined17 <![CDATA[ <= ]]>
			str_to_date(concat(#{enddefined17,jdbcType=VARCHAR}, '23:59:59'),
                                       '%Y-%m-%d %H:%i:%s')
		</if>	
		<if test=" startdefined18!= null and startdefined18 !='' ">
			AND r.defined18 >=
			 str_to_date(concat(#{startdefined18,jdbcType=VARCHAR}, '00:00:00'),
                                       '%Y-%m-%d %H:%i:%s')
		</if>
		<if test=" enddefined18 != null and enddefined18 !='' ">
			AND r.defined18 <![CDATA[ <= ]]>
			str_to_date(concat(#{enddefined18,jdbcType=VARCHAR}, '23:59:59'),
                                       '%Y-%m-%d %H:%i:%s')
		</if>	
		<if test="qKeyWord != null and qKeyWord != ''">
       		<choose>
       			<when test="queryType == 'phone' and (state == null or state == 0)">
       			    and r.mobilephone = #{qKeyWord}
       			</when>	
       			<when test="queryType == 'name'">
                    and r.name LIKE CONCAT('%',#{qKeyWord},'%') 
       			</when>
       			<when test="queryType == 'company'">
       			    and r.company LIKE CONCAT('%',#{qKeyWord},'%')
       			</when>	
       			<when test="queryType == 'mainLinkman' and (state == null or state == 0)">
       			    and r.main_linkman LIKE CONCAT('%',#{qKeyWord},'%')
       			</when>	
                <otherwise>
                   and ${queryType} LIKE CONCAT('%',#{qKeyWord},'%')
                </otherwise>
       		</choose>
        </if>
        <if test="inputStatusList != null and inputStatusList.size() > 0">
            AND r.INPUT_STATUS IN
            <foreach collection="inputStatusList" item="inputId" open="(" separator="," close=")">
                #{inputId}
            </foreach>
        </if>
		and r.type = 1
		and r.is_del=0
		and r.status = 1
		<if test="state == 0 and qKeyWord != null and qKeyWord != '' and queryType == 'phone'">
			union
			select RES_CUST_ID from tsm_res_cust_info r 
		 where  r.org_id = #{orgId,jdbcType=VARCHAR}
		 <if test="resIds != null and resIds.size() > 0">
	   		AND r.RES_CUST_ID IN 
	   			<foreach collection="resIds" item="rid" open="(" separator="," close=")">
	   				#{rid}
	   			</foreach>
	   	</if>
		<if test="deptIds!=null">
			AND r.import_dept_id IN 
				<foreach collection="deptIds" item="deptId" open="(" separator=","
					close=")">
					#{deptId}
				</foreach>	
			
		</if>
		<if test="deptIds==null">
			AND r.INPUT_ACC =#{inputAcc}
		</if>		
		<if test="startDate!=null and startDate!='' ">
	       <![CDATA[
            AND str_to_date(date_format(r.input_date,'%Y-%m-%d'),'%Y-%m-%d')>=str_to_date(#{startDate}, '%Y-%m-%d') 	       				   	       
		   ]]>
		</if>
		<if test="endDate!=null and endDate!=''">
		   <![CDATA[
           AND str_to_date(date_format(r.input_date,'%Y-%m-%d'),'%Y-%m-%d')<=str_to_date(#{endDate}, '%Y-%m-%d') 	       				   
		   ]]>
		</if>
		<choose>
			<when test="resGroupIds != null and resGroupIds.size() > 0">
				AND r.res_group_id in 
				<foreach collection="resGroupIds" item="rgid" open="(" separator="," close=")">
	   				#{rgid}
	   			</foreach>
			</when>
			<when test="resGroupIds == null"></when>
			<otherwise>
				AND r.res_group_id in ('')
			</otherwise>
		</choose>
		<if test="defined1 != null and defined1 != ''">
			AND r.defined1 =#{defined1}
		</if>	
		<if test="defined2 != null and defined2 != ''">
			AND r.defined2 =#{defined2}
		</if>	
		<if test="defined3 != null and defined3 != ''">
			AND r.defined3 =#{defined3}
		</if>	
		<if test="defined4 != null and defined4 != ''">
			AND r.defined4 =#{defined4}
		</if>	
		<if test="defined5 != null and defined5 != ''">
			AND r.defined5 =#{defined5}
		</if>	
		<if test="defined6 != null and defined6 != ''">
			AND r.defined6 =#{defined6}
		</if>	
		<if test="defined7 != null and defined7 != ''">
			AND r.defined7 =#{defined7}
		</if>	
		<if test="defined8 != null and defined8 != ''">
			AND r.defined8 =#{defined8}
		</if>	
		<if test="defined9 != null and defined9 != ''">
			AND r.defined9 =#{defined9}
		</if>	
		<if test="defined10 != null and defined10 != ''">
			AND r.defined10 =#{defined10}
		</if>	
		<if test="defined11 != null and defined11 != ''">
			AND r.defined11 =#{defined11}
		</if>	
		<if test="defined12 != null and defined12 != ''">
			AND r.defined12 =#{defined12}
		</if>	
		<if test="defined13 != null and defined13 != ''">
			AND r.defined13 =#{defined13}
		</if>	
		<if test="defined14 != null and defined14 != ''">
			AND r.defined14 =#{defined14}
		</if>	
		<if test="defined15 != null and defined15 != ''">
			AND r.defined15 =#{defined15}
		</if>
		<if test=" startdefined16!= null and startdefined16 !='' ">
			AND r.defined16 >=
			 str_to_date(concat(#{startdefined16,jdbcType=VARCHAR}, '00:00:00'),
                                       '%Y-%m-%d %H:%i:%s')
		</if>
		<if test=" enddefined16 != null and enddefined16 !='' ">
			AND r.defined16 <![CDATA[ <= ]]>
			str_to_date(concat(#{enddefined16,jdbcType=VARCHAR}, '23:59:59'),
                                       '%Y-%m-%d %H:%i:%s')
		</if>
		<if test=" startdefined17!= null and startdefined17 !='' ">
			AND r.defined17 >=
			 str_to_date(concat(#{startdefined17,jdbcType=VARCHAR}, '00:00:00'),
                                       '%Y-%m-%d %H:%i:%s')
		</if>
		<if test=" enddefined17 != null and enddefined17 !='' ">
			AND r.defined17 <![CDATA[ <= ]]>
			str_to_date(concat(#{enddefined17,jdbcType=VARCHAR}, '23:59:59'),
                                       '%Y-%m-%d %H:%i:%s')
		</if>	
		<if test=" startdefined18!= null and startdefined18 !='' ">
			AND r.defined18 >=
			 str_to_date(concat(#{startdefined18,jdbcType=VARCHAR}, '00:00:00'),
                                       '%Y-%m-%d %H:%i:%s')
		</if>
		<if test=" enddefined18 != null and enddefined18 !='' ">
			AND r.defined18 <![CDATA[ <= ]]>
			str_to_date(concat(#{enddefined18,jdbcType=VARCHAR}, '23:59:59'),
                                       '%Y-%m-%d %H:%i:%s')
		</if>	
		<if test="qKeyWord != null and qKeyWord != ''">
       		<choose>
       			<when test="queryType == 'phone' and state == 0">
       			    and r.telphone = #{qKeyWord}
       			</when>	
       		</choose>
        </if>	
		and r.type = 1
		and r.is_del=0
		and r.status = 1
		</if>)t
		order by t.res_cust_id
	</select>	
	<!-- 获取公司已经分配资源信息(联系电话) -->
	<select id="findAssginResIdsWithPhone" resultType="String" parameterType="com.qftx.tsm.cust.dto.ResCustDto">
		select
			t.RES_CUST_ID
			from
		(select
			 r.RES_CUST_ID
			from tsm_res_cust_info r
			where
			r.org_id =#{orgId,jdbcType=VARCHAR}
			<if test="resIds != null and resIds.size() > 0">
		   		AND r.RES_CUST_ID IN 
		   			<foreach collection="resIds" item="rid" open="(" separator="," close=")">
		   				#{rid}
		   			</foreach>
		   	</if>
			<if test="deptIds!=null">
				AND r.import_dept_id IN
					<foreach collection="deptIds" item="deptId" open="(" separator=","
						close=")">
						#{deptId}
					</foreach>	
			</if>
			<if test="deptIds==null">
				AND r.input_acc =#{inputAcc}
			</if>	
			<if test="ownerAccs!=null">
				AND r.owner_acc IN 
				<foreach collection="ownerAccs" item="shareAcc" open="(" separator=","
					close=")">
					#{shareAcc}
				</foreach>
					
			</if>
		    <if test="ownerAcc != null and ownerAcc != ''">
			    AND r.owner_acc = #{ownerAcc,jdbcType=VARCHAR} 
		    </if>			
			<if test="startDate!=null and startDate!='' ">
		       <![CDATA[
		        AND r.owner_start_date>=str_to_date(  CONCAT(#{startDate},' 00:00:00'), '%Y-%m-%d %H:%i:%s') 	       	
			   ]]>
			</if>
			<if test="endDate!=null and endDate!=''">
			   <![CDATA[
			   AND r.owner_start_date<=str_to_date(  CONCAT(#{endDate},' 23:59:59'), '%Y-%m-%d %H:%i:%s') 	 
			   ]]>
			</if>
			<choose>
				<when test="resGroupIds != null and resGroupIds.size() > 0">
					AND r.res_group_id in 
					<foreach collection="resGroupIds" item="rgid" open="(" separator="," close=")">
		   				#{rgid}
		   			</foreach>
				</when>
				<when test="resGroupIds == null"></when>
				<otherwise>
					AND r.res_group_id in ('')
				</otherwise>
			</choose>
			<if test=" companyTrade != null and companyTrade != '' ">
				AND r.company_trade = #{companyTrade,jdbcType=VARCHAR}
			</if>
			<if test=" provinceId != null and provinceId != '' ">
				AND r.province_id = #{provinceId,jdbcType=VARCHAR}
			</if>
			<if test=" cityId != null and cityId != '' ">
				AND r.city_id = #{cityId,jdbcType=VARCHAR}
			</if>
			<if test=" countyId != null and countyId != '' ">
				AND r.county_id = #{countyId,jdbcType=VARCHAR}
			</if>
			and r.is_del=0
			<if test="qStatus==2"> 
				AND   r.type =1
			</if>
			<if test="qStatus==3">
				AND ifNull(r.is_concat,0)=0  and  r.type =1
			</if>
			<if test="qStatus==4">
			    AND r.is_concat=1  and  r.type =1
			</if>
			<if test="defined1 != null and defined1 != ''">
				AND r.defined1 =#{defined1}
			</if>	
			<if test="defined2 != null and defined2 != ''">
				AND r.defined2 =#{defined2}
			</if>	
			<if test="defined3 != null and defined3 != ''">
				AND r.defined3 =#{defined3}
			</if>	
			<if test="defined4 != null and defined4 != ''">
				AND r.defined4 =#{defined4}
			</if>	
			<if test="defined5 != null and defined5 != ''">
				AND r.defined5 =#{defined5}
			</if>	
			<if test="defined6 != null and defined6 != ''">
				AND r.defined6 =#{defined6}
			</if>	
			<if test="defined7 != null and defined7 != ''">
				AND r.defined7 =#{defined7}
			</if>	
			<if test="defined8 != null and defined8 != ''">
				AND r.defined8 =#{defined8}
			</if>	
			<if test="defined9 != null and defined9 != ''">
				AND r.defined9 =#{defined9}
			</if>	
			<if test="defined10 != null and defined10 != ''">
				AND r.defined10 =#{defined10}
			</if>	
			<if test="defined11 != null and defined11 != ''">
				AND r.defined11 =#{defined11}
			</if>	
			<if test="defined12 != null and defined12 != ''">
				AND r.defined12 =#{defined12}
			</if>	
			<if test="defined13 != null and defined13 != ''">
				AND r.defined13 =#{defined13}
			</if>	
			<if test="defined14 != null and defined14 != ''">
				AND r.defined14 =#{defined14}
			</if>	
			<if test="defined15 != null and defined15 != ''">
				AND r.defined15 =#{defined15}
			</if>	
			<if test=" startdefined16!= null and startdefined16 !='' ">
				AND r.defined16 >=
				 str_to_date(concat(#{startdefined16,jdbcType=VARCHAR}, '00:00:00'),
	                                       '%Y-%m-%d %H:%i:%s')
			</if>
			<if test=" enddefined16 != null and enddefined16 !='' ">
				AND r.defined16 <![CDATA[ <= ]]>
				str_to_date(concat(#{enddefined16,jdbcType=VARCHAR}, '23:59:59'),
	                                       '%Y-%m-%d %H:%i:%s')
			</if>
			<if test=" startdefined17!= null and startdefined17 !='' ">
				AND r.defined17 >=
				 str_to_date(concat(#{startdefined17,jdbcType=VARCHAR}, '00:00:00'),
	                                       '%Y-%m-%d %H:%i:%s')
			</if>
			<if test=" enddefined17 != null and enddefined17 !='' ">
				AND r.defined17 <![CDATA[ <= ]]>
				str_to_date(concat(#{enddefined17,jdbcType=VARCHAR}, '23:59:59'),
	                                       '%Y-%m-%d %H:%i:%s')
			</if>	
			<if test=" startdefined18!= null and startdefined18 !='' ">
				AND r.defined18 >=
				 str_to_date(concat(#{startdefined18,jdbcType=VARCHAR}, '00:00:00'),
	                                       '%Y-%m-%d %H:%i:%s')
			</if>
			<if test=" enddefined18 != null and enddefined18 !='' ">
				AND r.defined18 <![CDATA[ <= ]]>
				str_to_date(concat(#{enddefined18,jdbcType=VARCHAR}, '23:59:59'),
	                                       '%Y-%m-%d %H:%i:%s')
			</if>
			 <if test="state == 0 and qKeyWord != null and qKeyWord != '' and queryType == 'phone'">
	       		<choose>
	       			<when test="queryType == 'phone'">
	       			    and r.mobilephone = #{qKeyWord}
	       			</when>	
	       		</choose>
	        </if>			
			and r.status in( 2,3)
			and r.type = 1
			 <if test="state == 0 and qKeyWord != null and qKeyWord != '' and queryType == 'phone'">
			 union
			 select
			 r.RES_CUST_ID
			from tsm_res_cust_info r
			where
			r.org_id =#{orgId,jdbcType=VARCHAR}
			<if test="resIds != null and resIds.size() > 0">
		   		AND r.RES_CUST_ID IN 
		   			<foreach collection="resIds" item="rid" open="(" separator="," close=")">
		   				#{rid}
		   			</foreach>
		   	</if>
			<if test="deptIds!=null">
				AND r.import_dept_id IN
					<foreach collection="deptIds" item="deptId" open="(" separator=","
						close=")">
						#{deptId}
					</foreach>	
			</if>
			<if test="deptIds==null">
				AND r.input_acc =#{inputAcc}
			</if>	
			<if test="ownerAccs!=null">
				AND r.owner_acc IN 
				<foreach collection="ownerAccs" item="shareAcc" open="(" separator=","
					close=")">
					#{shareAcc}
				</foreach>
					
			</if>
		    <if test="ownerAcc != null and ownerAcc != ''">
			    AND r.owner_acc = #{ownerAcc,jdbcType=VARCHAR} 
		    </if>			
			<if test="startDate!=null and startDate!='' ">
		       <![CDATA[
		        AND r.owner_start_date>=str_to_date(  CONCAT(#{startDate},' 00:00:00'), '%Y-%m-%d %H:%i:%s') 	       	
			   ]]>
			</if>
			<if test="endDate!=null and endDate!=''">
			   <![CDATA[
			   AND r.owner_start_date<=str_to_date(  CONCAT(#{endDate},' 23:59:59'), '%Y-%m-%d %H:%i:%s') 	 
			   ]]>
			</if>
			<choose>
				<when test="resGroupIds != null and resGroupIds.size() > 0">
					AND r.res_group_id in 
					<foreach collection="resGroupIds" item="rgid" open="(" separator="," close=")">
		   				#{rgid}
		   			</foreach>
				</when>
				<when test="resGroupIds == null"></when>
				<otherwise>
					AND r.res_group_id in ('')
				</otherwise>
			</choose>
			<if test=" companyTrade != null and companyTrade != '' ">
				AND r.company_trade = #{companyTrade,jdbcType=VARCHAR}
			</if>
			<if test=" provinceId != null and provinceId != '' ">
				AND r.province_id = #{provinceId,jdbcType=VARCHAR}
			</if>
			<if test=" cityId != null and cityId != '' ">
				AND r.city_id = #{cityId,jdbcType=VARCHAR}
			</if>
			<if test=" countyId != null and countyId != '' ">
				AND r.county_id = #{countyId,jdbcType=VARCHAR}
			</if>
			and r.is_del=0
			<if test="qStatus==2"> 
				AND   r.type =1
			</if>
			<if test="qStatus==3">
				AND ifNull(r.is_concat,0)=0  and  r.type =1
			</if>
			<if test="qStatus==4">
			    AND r.is_concat=1  and  r.type =1
			</if>
			<if test="defined1 != null and defined1 != ''">
				AND r.defined1 =#{defined1}
			</if>	
			<if test="defined2 != null and defined2 != ''">
				AND r.defined2 =#{defined2}
			</if>	
			<if test="defined3 != null and defined3 != ''">
				AND r.defined3 =#{defined3}
			</if>	
			<if test="defined4 != null and defined4 != ''">
				AND r.defined4 =#{defined4}
			</if>	
			<if test="defined5 != null and defined5 != ''">
				AND r.defined5 =#{defined5}
			</if>	
			<if test="defined6 != null and defined6 != ''">
				AND r.defined6 =#{defined6}
			</if>	
			<if test="defined7 != null and defined7 != ''">
				AND r.defined7 =#{defined7}
			</if>	
			<if test="defined8 != null and defined8 != ''">
				AND r.defined8 =#{defined8}
			</if>	
			<if test="defined9 != null and defined9 != ''">
				AND r.defined9 =#{defined9}
			</if>	
			<if test="defined10 != null and defined10 != ''">
				AND r.defined10 =#{defined10}
			</if>	
			<if test="defined11 != null and defined11 != ''">
				AND r.defined11 =#{defined11}
			</if>	
			<if test="defined12 != null and defined12 != ''">
				AND r.defined12 =#{defined12}
			</if>	
			<if test="defined13 != null and defined13 != ''">
				AND r.defined13 =#{defined13}
			</if>	
			<if test="defined14 != null and defined14 != ''">
				AND r.defined14 =#{defined14}
			</if>	
			<if test="defined15 != null and defined15 != ''">
				AND r.defined15 =#{defined15}
			</if>	
			<if test=" startdefined16!= null and startdefined16 !='' ">
				AND r.defined16 >=
				 str_to_date(concat(#{startdefined16,jdbcType=VARCHAR}, '00:00:00'),
	                                       '%Y-%m-%d %H:%i:%s')
			</if>
			<if test=" enddefined16 != null and enddefined16 !='' ">
				AND r.defined16 <![CDATA[ <= ]]>
				str_to_date(concat(#{enddefined16,jdbcType=VARCHAR}, '23:59:59'),
	                                       '%Y-%m-%d %H:%i:%s')
			</if>
			<if test=" startdefined17!= null and startdefined17 !='' ">
				AND r.defined17 >=
				 str_to_date(concat(#{startdefined17,jdbcType=VARCHAR}, '00:00:00'),
	                                       '%Y-%m-%d %H:%i:%s')
			</if>
			<if test=" enddefined17 != null and enddefined17 !='' ">
				AND r.defined17 <![CDATA[ <= ]]>
				str_to_date(concat(#{enddefined17,jdbcType=VARCHAR}, '23:59:59'),
	                                       '%Y-%m-%d %H:%i:%s')
			</if>	
			<if test=" startdefined18!= null and startdefined18 !='' ">
				AND r.defined18 >=
				 str_to_date(concat(#{startdefined18,jdbcType=VARCHAR}, '00:00:00'),
	                                       '%Y-%m-%d %H:%i:%s')
			</if>
			<if test=" enddefined18 != null and enddefined18 !='' ">
				AND r.defined18 <![CDATA[ <= ]]>
				str_to_date(concat(#{enddefined18,jdbcType=VARCHAR}, '23:59:59'),
	                                       '%Y-%m-%d %H:%i:%s')
			</if>
			 <if test="state == 0 and qKeyWord != null and qKeyWord != '' and queryType == 'phone'">
	       		<choose>
	       			<when test="queryType == 'phone'">
	       			    and r.telphone = #{qKeyWord}
	       			</when>	
	       		</choose>
	        </if>			
			and r.status in( 2,3)
			and r.type = 1
			 </if>)t
			limit #{page.currentResult,jdbcType=DECIMAL},#{page.showCount,jdbcType=DECIMAL} 
	</select>
	<select id="findAssginResWithPhonePageList" resultMap="compResMap" parameterType="map">
		select
			 r.RES_CUST_ID,r.NAME,r.company,r.MOBILEPHONE,r.TELPHONE,r.OWNER_START_DATE,r.INPUT_ACC,r.INPUT_DATE,
			 r.RES_GROUP_ID,r.OWNER_ACC,r.STATUS,r.type,
			 r.ORG_ID,r.import_dept_id,r.is_concat,
			 r.main_linkman,
			 r.company_fax,
		     r.company_trade,
		     r.company_money,
		     r.company_user,
		     r.KEYWORD,
		     r.address,
     	     r.province_id,
		     r.city_id,
		     r.county_id,
		     r.DEFINED1,
			 r.DEFINED2,
			 r.DEFINED3,
			 r.DEFINED4,
			 r.DEFINED5,
			 r.DEFINED6,
			 r.DEFINED7,
			 r.DEFINED8,
			 r.DEFINED9,
			 r.DEFINED10,
			 r.DEFINED11,
			 r.DEFINED12,
			 r.DEFINED13,
			 r.DEFINED14,
			 r.DEFINED15,
			 r.DEFINED16,
			 r.DEFINED17,
			 r.DEFINED18
			from tsm_res_cust_info r
			where
			r.org_id =#{orgId,jdbcType=VARCHAR}
			 <if test="ids!=null">
				AND r.res_cust_id IN 
					<foreach collection="ids" item="id" open="(" separator=","
						close=")">
						#{id}
					</foreach>	
			</if>
	</select>
	<!-- <select id="findAssginResWithPhonePageList" resultMap="compResMap" parameterType="com.qftx.tsm.cust.dto.ResCustDto">
		select * from (
		select
			 r.RES_CUST_ID,r.NAME,r.company,r.MOBILEPHONE,r.TELPHONE,r.OWNER_START_DATE,r.INPUT_ACC,r.INPUT_DATE,
			 r.RES_GROUP_ID,r.OWNER_ACC,r.STATUS,r.type,
			 r.ORG_ID,r.import_dept_id,r.is_concat,
			 r.main_linkman,
			 r.company_fax,
		     r.company_trade,
		     r.company_money,
		     r.company_user,
		     r.KEYWORD,
		     r.address,
     	     r.province_id,
		     r.city_id,
		     r.county_id,
		     r.DEFINED1,
			 r.DEFINED2,
			 r.DEFINED3,
			 r.DEFINED4,
			 r.DEFINED5,
			 r.DEFINED6,
			 r.DEFINED7,
			 r.DEFINED8,
			 r.DEFINED9,
			 r.DEFINED10,
			 r.DEFINED11,
			 r.DEFINED12,
			 r.DEFINED13,
			 r.DEFINED14,
			 r.DEFINED15,
			 r.DEFINED16,
			 r.DEFINED17,
			 r.DEFINED18
			from tsm_res_cust_info r
			where
			r.org_id =#{orgId,jdbcType=VARCHAR}
			<if test="qKeyWord != null and qKeyWord != ''">
	       		<choose>
	       			<when test="queryType == 'phone'">
	       				AND r.mobilephone = #{qKeyWord} 						       									
	       			</when>
	       		</choose>
	        </if>
			<if test="deptIds!=null">
				AND r.import_dept_id IN
					<foreach collection="deptIds" item="deptId" open="(" separator=","
						close=")">
						#{deptId}
					</foreach>	
			</if>
			<if test="deptIds==null">
				AND r.input_acc =#{inputAcc}
			</if>	
			<if test="ownerAccs!=null">
				AND r.owner_acc IN 
				<foreach collection="ownerAccs" item="shareAcc" open="(" separator=","
					close=")">
					#{shareAcc}
				</foreach>
					
			</if>
		    <if test="ownerAcc != null and ownerAcc != ''">
			    AND r.owner_acc = #{ownerAcc,jdbcType=VARCHAR} 
		    </if>			
			<if test="startDate!=null and startDate!='' ">
		       <![CDATA[
		        AND r.owner_start_date>=str_to_date(  CONCAT(#{startDate},' 00:00:00'), '%Y-%m-%d %H:%i:%s') 	       	
			   ]]>
			</if>
			<if test="endDate!=null and endDate!=''">
			   <![CDATA[
			   AND r.owner_start_date<=str_to_date(  CONCAT(#{endDate},' 23:59:59'), '%Y-%m-%d %H:%i:%s') 	 
			   ]]>
			</if>
			<if test="resGroupId!=null and resGroupId!=''">
			   <![CDATA[
			   AND r.res_group_id = #{resGroupId}
			   ]]>
			</if>
			and r.is_del=0
			<if test="qStatus==2"> 
				AND   r.type =1
			</if>
			<if test="qStatus==3">
				AND ifNull(r.is_concat,0)=0  and  r.type =1
			</if>
			<if test="qStatus==4">
			    AND r.is_concat=1  and  r.type =1
			</if>
			<if test=" startdefined16!= null and startdefined16 !='' ">
				AND r.defined16 >=
				 str_to_date(concat(#{startdefined16,jdbcType=VARCHAR}, '00:00:00'),
	                                       '%Y-%m-%d %H:%i:%s')
			</if>
			<if test=" enddefined16 != null and enddefined16 !='' ">
				AND r.defined16 <![CDATA[ <= ]]>
				str_to_date(concat(#{enddefined16,jdbcType=VARCHAR}, '23:59:59'),
	                                       '%Y-%m-%d %H:%i:%s')
			</if>
			<if test=" startdefined17!= null and startdefined17 !='' ">
				AND r.defined17 >=
				 str_to_date(concat(#{startdefined17,jdbcType=VARCHAR}, '00:00:00'),
	                                       '%Y-%m-%d %H:%i:%s')
			</if>
			<if test=" enddefined17 != null and enddefined17 !='' ">
				AND r.defined17 <![CDATA[ <= ]]>
				str_to_date(concat(#{enddefined17,jdbcType=VARCHAR}, '23:59:59'),
	                                       '%Y-%m-%d %H:%i:%s')
			</if>	
			<if test=" startdefined18!= null and startdefined18 !='' ">
				AND r.defined18 >=
				 str_to_date(concat(#{startdefined18,jdbcType=VARCHAR}, '00:00:00'),
	                                       '%Y-%m-%d %H:%i:%s')
			</if>
			<if test=" enddefined18 != null and enddefined18 !='' ">
				AND r.defined18 <![CDATA[ <= ]]>
				str_to_date(concat(#{enddefined18,jdbcType=VARCHAR}, '23:59:59'),
	                                       '%Y-%m-%d %H:%i:%s')
			</if>			
			and r.status in( 2,3)
			and r.type = 1
			<if test="qKeyWord != null and qKeyWord != '' and queryType == 'phone'">
			union
			select
			 r1.RES_CUST_ID,r1.NAME,r1.company,r1.MOBILEPHONE,r1.TELPHONE,r1.OWNER_START_DATE,r1.INPUT_ACC,r1.INPUT_DATE,
			 r1.RES_GROUP_ID,r1.OWNER_ACC,r1.STATUS,r1.type,
			 r1.ORG_ID,r1.import_dept_id,r1.is_concat,
			 r1.main_linkman,
			 r1.company_fax,
		     r1.company_trade,
		     r1.company_money,
		     r1.company_user,
		     r1.KEYWORD,
		     r1.address,
     	     r1.province_id,
		     r1.city_id,
		     r1.county_id,
		     r1.DEFINED1,
			 r1.DEFINED2,
			 r1.DEFINED3,
			 r1.DEFINED4,
			 r1.DEFINED5,
			 r1.DEFINED6,
			 r1.DEFINED7,
			 r1.DEFINED8,
			 r1.DEFINED9,
			 r1.DEFINED10,
			 r1.DEFINED11,
			 r1.DEFINED12,
			 r1.DEFINED13,
			 r1.DEFINED14,
			 r1.DEFINED15,
			 r1.DEFINED16,
			 r1.DEFINED17,
			 r1.DEFINED18
			from tsm_res_cust_info r1
			where
			r1.org_id =#{orgId,jdbcType=VARCHAR}
			<if test="qKeyWord != null and qKeyWord != ''">
	       		<choose>
		       		<when test="queryType == 'phone'">
	       				AND r1.telphone = #{qKeyWord}
	       			</when>	       		       			
	       		</choose>
	        </if>
			<if test="deptIds!=null">
				AND r1.import_dept_id IN
					<foreach collection="deptIds" item="deptId" open="(" separator=","
						close=")">
						#{deptId}
					</foreach>	
			</if>
			<if test="deptIds==null">
				AND r1.input_acc =#{inputAcc}
			</if>	
			<if test="ownerAccs!=null">
				AND r1.owner_acc IN 
						<foreach collection="ownerAccs" item="shareAcc" open="(" separator=","
							close=")">
							#{shareAcc}
						</foreach>
					
			</if>
		    <if test="ownerAcc != null and ownerAcc != ''">
			    AND r1.owner_acc = #{ownerAcc,jdbcType=VARCHAR} 
		    </if>			
			<if test="startDate!=null and startDate!='' ">
		       <![CDATA[
		        AND r1.owner_start_date>=str_to_date(  CONCAT(#{startDate},' 00:00:00'), '%Y-%m-%d %H:%i:%s') 	       	
			   ]]>
			</if>
			<if test="endDate!=null and endDate!=''">
			   <![CDATA[
			   AND r1.owner_start_date<=str_to_date(  CONCAT(#{endDate},' 23:59:59'), '%Y-%m-%d %H:%i:%s') 	 
			   ]]>
			</if>
			<if test="resGroupId!=null and resGroupId!=''">
			   <![CDATA[
			   AND r1.res_group_id = #{resGroupId}
			   ]]>
			</if>
			and r1.is_del=0
			<if test="qStatus==2"> 
				AND   r1.type =1
			</if>
			<if test="qStatus==3">
				AND ifNull(r1.is_concat,0)=0  and  r1.type =1
			</if>
			<if test="qStatus==4">
			    AND r1.is_concat=1  and  r1.type =1
			</if>
			<if test=" startdefined16!= null and startdefined16 !='' ">
				AND r1.defined16 >=
				 str_to_date(concat(#{startdefined16,jdbcType=VARCHAR}, '00:00:00'),
	                                       '%Y-%m-%d %H:%i:%s')
			</if>
			<if test=" enddefined16 != null and enddefined16 !='' ">
				AND r1.defined16 <![CDATA[ <= ]]>
				str_to_date(concat(#{enddefined16,jdbcType=VARCHAR}, '23:59:59'),
	                                       '%Y-%m-%d %H:%i:%s')
			</if>
			<if test=" startdefined17!= null and startdefined17 !='' ">
				AND r1.defined17 >=
				 str_to_date(concat(#{startdefined17,jdbcType=VARCHAR}, '00:00:00'),
	                                       '%Y-%m-%d %H:%i:%s')
			</if>
			<if test=" enddefined17 != null and enddefined17 !='' ">
				AND r1.defined17 <![CDATA[ <= ]]>
				str_to_date(concat(#{enddefined17,jdbcType=VARCHAR}, '23:59:59'),
	                                       '%Y-%m-%d %H:%i:%s')
			</if>	
			<if test=" startdefined18!= null and startdefined18 !='' ">
				AND r1.defined18 >=
				 str_to_date(concat(#{startdefined18,jdbcType=VARCHAR}, '00:00:00'),
	                                       '%Y-%m-%d %H:%i:%s')
			</if>
			<if test=" enddefined18 != null and enddefined18 !='' ">
				AND r1.defined18 <![CDATA[ <= ]]>
				str_to_date(concat(#{enddefined18,jdbcType=VARCHAR}, '23:59:59'),
	                                       '%Y-%m-%d %H:%i:%s')
			</if>			
			and r1.status in( 2,3)
			and r1.type = 1 
			</if>
			) trci
			limit #{page.currentResult,jdbcType=DECIMAL},#{page.showCount,jdbcType=DECIMAL} 
	</select> -->
	<!-- 获取公司已经分配资源信息 (联系电话)count-->
	<select id="findAssginResWithPhoneCount" resultType="Integer" parameterType="com.qftx.tsm.cust.dto.ResCustDto">
		select count(1)
			from( 
			select r.res_cust_id from
			tsm_res_cust_info r
			where
			r.org_id =#{orgId,jdbcType=VARCHAR}
			<if test="resIds != null and resIds.size() > 0">
		   		AND r.RES_CUST_ID IN 
		   			<foreach collection="resIds" item="rid" open="(" separator="," close=")">
		   				#{rid}
		   			</foreach>
		   	</if>
			<if test="deptIds!=null">
				AND r.import_dept_id IN
					<foreach collection="deptIds" item="deptId" open="(" separator=","
						close=")">
						#{deptId}
					</foreach>	
			</if>
			<if test="deptIds==null">
				AND r.input_acc =#{inputAcc}
			</if>	
			<if test="ownerAccs!=null">
				AND r.owner_acc IN 
						<foreach collection="ownerAccs" item="shareAcc" open="(" separator=","
							close=")">
							#{shareAcc}
						</foreach>
					
			</if>
		    <if test="ownerAcc != null and ownerAcc != ''">
			    AND r.owner_acc = #{ownerAcc,jdbcType=VARCHAR} 
		    </if>			
			<if test="startDate!=null and startDate!='' ">
		       <![CDATA[
		        AND r.owner_start_date>=str_to_date(  CONCAT(#{startDate},' 00:00:00'), '%Y-%m-%d %H:%i:%s') 	       	
			   ]]>
			</if>
			<if test="endDate!=null and endDate!=''">
			   <![CDATA[
			   AND r.owner_start_date<=str_to_date(  CONCAT(#{endDate},' 23:59:59'), '%Y-%m-%d %H:%i:%s') 	 
			   ]]>
			</if>
			<choose>
				<when test="resGroupIds != null and resGroupIds.size() > 0">
					AND r.res_group_id in 
					<foreach collection="resGroupIds" item="rgid" open="(" separator="," close=")">
		   				#{rgid}
		   			</foreach>
				</when>
				<when test="resGroupIds == null"></when>
				<otherwise>
					AND r.res_group_id in ('')
				</otherwise>
			</choose>
			<if test=" companyTrade != null and companyTrade != '' ">
				AND r.company_trade = #{companyTrade,jdbcType=VARCHAR}
			</if>
			<if test=" provinceId != null and provinceId != '' ">
				AND r.province_id = #{provinceId,jdbcType=VARCHAR}
			</if>
			<if test=" cityId != null and cityId != '' ">
				AND r.city_id = #{cityId,jdbcType=VARCHAR}
			</if>
			<if test=" countyId != null and countyId != '' ">
				AND r.county_id = #{countyId,jdbcType=VARCHAR}
			</if>
			and r.is_del=0
			<if test="qStatus==2"> 
				AND   r.type =1
			</if>
			<if test="qStatus==3">
				AND ifNull(r.is_concat,0)=0  and  r.type =1
			</if>
			<if test="qStatus==4">
			    AND r.is_concat=1  and  r.type =1
			</if>
			<if test="defined1 != null and defined1 != ''">
				AND r.defined1 =#{defined1}
			</if>	
			<if test="defined2 != null and defined2 != ''">
				AND r.defined2 =#{defined2}
			</if>	
			<if test="defined3 != null and defined3 != ''">
				AND r.defined3 =#{defined3}
			</if>	
			<if test="defined4 != null and defined4 != ''">
				AND r.defined4 =#{defined4}
			</if>	
			<if test="defined5 != null and defined5 != ''">
				AND r.defined5 =#{defined5}
			</if>	
			<if test="defined6 != null and defined6 != ''">
				AND r.defined6 =#{defined6}
			</if>	
			<if test="defined7 != null and defined7 != ''">
				AND r.defined7 =#{defined7}
			</if>	
			<if test="defined8 != null and defined8 != ''">
				AND r.defined8 =#{defined8}
			</if>	
			<if test="defined9 != null and defined9 != ''">
				AND r.defined9 =#{defined9}
			</if>	
			<if test="defined10 != null and defined10 != ''">
				AND r.defined10 =#{defined10}
			</if>	
			<if test="defined11 != null and defined11 != ''">
				AND r.defined11 =#{defined11}
			</if>	
			<if test="defined12 != null and defined12 != ''">
				AND r.defined12 =#{defined12}
			</if>	
			<if test="defined13 != null and defined13 != ''">
				AND r.defined13 =#{defined13}
			</if>	
			<if test="defined14 != null and defined14 != ''">
				AND r.defined14 =#{defined14}
			</if>	
			<if test="defined15 != null and defined15 != ''">
				AND r.defined15 =#{defined15}
			</if>	
			<if test=" startdefined16!= null and startdefined16 !='' ">
				AND r.defined16 >=
				 str_to_date(concat(#{startdefined16,jdbcType=VARCHAR}, '00:00:00'),
	                                       '%Y-%m-%d %H:%i:%s')
			</if>
			<if test=" enddefined16 != null and enddefined16 !='' ">
				AND r.defined16 <![CDATA[ <= ]]>
				str_to_date(concat(#{enddefined16,jdbcType=VARCHAR}, '23:59:59'),
	                                       '%Y-%m-%d %H:%i:%s')
			</if>
			<if test=" startdefined17!= null and startdefined17 !='' ">
				AND r.defined17 >=
				 str_to_date(concat(#{startdefined17,jdbcType=VARCHAR}, '00:00:00'),
	                                       '%Y-%m-%d %H:%i:%s')
			</if>
			<if test=" enddefined17 != null and enddefined17 !='' ">
				AND r.defined17 <![CDATA[ <= ]]>
				str_to_date(concat(#{enddefined17,jdbcType=VARCHAR}, '23:59:59'),
	                                       '%Y-%m-%d %H:%i:%s')
			</if>	
			<if test=" startdefined18!= null and startdefined18 !='' ">
				AND r.defined18 >=
				 str_to_date(concat(#{startdefined18,jdbcType=VARCHAR}, '00:00:00'),
	                                       '%Y-%m-%d %H:%i:%s')
			</if>
			<if test=" enddefined18 != null and enddefined18 !='' ">
				AND r.defined18 <![CDATA[ <= ]]>
				str_to_date(concat(#{enddefined18,jdbcType=VARCHAR}, '23:59:59'),
	                                       '%Y-%m-%d %H:%i:%s')
			</if>	
			 <if test="state == 0 and qKeyWord != null and qKeyWord != '' and queryType == 'phone'">
	       		<choose>
	       			<when test="queryType == 'phone'">
	       			    and r.mobilephone = #{qKeyWord}
	       			</when>	
	       		</choose>
	        </if>		
			and r.status in( 2,3)
			and r.type = 1
			<if test="state == 0 and qKeyWord != null and qKeyWord != '' and queryType == 'phone'">
			union
			select r.res_cust_id from
			tsm_res_cust_info r
			where
			r.org_id =#{orgId,jdbcType=VARCHAR}
			<if test="resIds != null and resIds.size() > 0">
		   		AND r.RES_CUST_ID IN 
		   			<foreach collection="resIds" item="rid" open="(" separator="," close=")">
		   				#{rid}
		   			</foreach>
		   	</if>
			<if test="deptIds!=null">
				AND r.import_dept_id IN
					<foreach collection="deptIds" item="deptId" open="(" separator=","
						close=")">
						#{deptId}
					</foreach>	
			</if>
			<if test="deptIds==null">
				AND r.input_acc =#{inputAcc}
			</if>	
			<if test="ownerAccs!=null">
				AND r.owner_acc IN 
						<foreach collection="ownerAccs" item="shareAcc" open="(" separator=","
							close=")">
							#{shareAcc}
						</foreach>
					
			</if>
		    <if test="ownerAcc != null and ownerAcc != ''">
			    AND r.owner_acc = #{ownerAcc,jdbcType=VARCHAR} 
		    </if>			
			<if test="startDate!=null and startDate!='' ">
		       <![CDATA[
		        AND r.owner_start_date>=str_to_date(  CONCAT(#{startDate},' 00:00:00'), '%Y-%m-%d %H:%i:%s') 	       	
			   ]]>
			</if>
			<if test="endDate!=null and endDate!=''">
			   <![CDATA[
			   AND r.owner_start_date<=str_to_date(  CONCAT(#{endDate},' 23:59:59'), '%Y-%m-%d %H:%i:%s') 	 
			   ]]>
			</if>
			<choose>
				<when test="resGroupIds != null and resGroupIds.size() > 0">
					AND r.res_group_id in 
					<foreach collection="resGroupIds" item="rgid" open="(" separator="," close=")">
		   				#{rgid}
		   			</foreach>
				</when>
				<when test="resGroupIds == null"></when>
				<otherwise>
					AND r.res_group_id in ('')
				</otherwise>
			</choose>
			<if test=" companyTrade != null and companyTrade != '' ">
				AND r.company_trade = #{companyTrade,jdbcType=VARCHAR}
			</if>
			<if test=" provinceId != null and provinceId != '' ">
				AND r.province_id = #{provinceId,jdbcType=VARCHAR}
			</if>
			<if test=" cityId != null and cityId != '' ">
				AND r.city_id = #{cityId,jdbcType=VARCHAR}
			</if>
			<if test=" countyId != null and countyId != '' ">
				AND r.county_id = #{countyId,jdbcType=VARCHAR}
			</if>
			and r.is_del=0
			<if test="qStatus==2"> 
				AND   r.type =1
			</if>
			<if test="qStatus==3">
				AND ifNull(r.is_concat,0)=0  and  r.type =1
			</if>
			<if test="qStatus==4">
			    AND r.is_concat=1  and  r.type =1
			</if>
			<if test="defined1 != null and defined1 != ''">
				AND r.defined1 =#{defined1}
			</if>	
			<if test="defined2 != null and defined2 != ''">
				AND r.defined2 =#{defined2}
			</if>	
			<if test="defined3 != null and defined3 != ''">
				AND r.defined3 =#{defined3}
			</if>	
			<if test="defined4 != null and defined4 != ''">
				AND r.defined4 =#{defined4}
			</if>	
			<if test="defined5 != null and defined5 != ''">
				AND r.defined5 =#{defined5}
			</if>	
			<if test="defined6 != null and defined6 != ''">
				AND r.defined6 =#{defined6}
			</if>	
			<if test="defined7 != null and defined7 != ''">
				AND r.defined7 =#{defined7}
			</if>	
			<if test="defined8 != null and defined8 != ''">
				AND r.defined8 =#{defined8}
			</if>	
			<if test="defined9 != null and defined9 != ''">
				AND r.defined9 =#{defined9}
			</if>	
			<if test="defined10 != null and defined10 != ''">
				AND r.defined10 =#{defined10}
			</if>	
			<if test="defined11 != null and defined11 != ''">
				AND r.defined11 =#{defined11}
			</if>	
			<if test="defined12 != null and defined12 != ''">
				AND r.defined12 =#{defined12}
			</if>	
			<if test="defined13 != null and defined13 != ''">
				AND r.defined13 =#{defined13}
			</if>	
			<if test="defined14 != null and defined14 != ''">
				AND r.defined14 =#{defined14}
			</if>	
			<if test="defined15 != null and defined15 != ''">
				AND r.defined15 =#{defined15}
			</if>	
			<if test=" startdefined16!= null and startdefined16 !='' ">
				AND r.defined16 >=
				 str_to_date(concat(#{startdefined16,jdbcType=VARCHAR}, '00:00:00'),
	                                       '%Y-%m-%d %H:%i:%s')
			</if>
			<if test=" enddefined16 != null and enddefined16 !='' ">
				AND r.defined16 <![CDATA[ <= ]]>
				str_to_date(concat(#{enddefined16,jdbcType=VARCHAR}, '23:59:59'),
	                                       '%Y-%m-%d %H:%i:%s')
			</if>
			<if test=" startdefined17!= null and startdefined17 !='' ">
				AND r.defined17 >=
				 str_to_date(concat(#{startdefined17,jdbcType=VARCHAR}, '00:00:00'),
	                                       '%Y-%m-%d %H:%i:%s')
			</if>
			<if test=" enddefined17 != null and enddefined17 !='' ">
				AND r.defined17 <![CDATA[ <= ]]>
				str_to_date(concat(#{enddefined17,jdbcType=VARCHAR}, '23:59:59'),
	                                       '%Y-%m-%d %H:%i:%s')
			</if>	
			<if test=" startdefined18!= null and startdefined18 !='' ">
				AND r.defined18 >=
				 str_to_date(concat(#{startdefined18,jdbcType=VARCHAR}, '00:00:00'),
	                                       '%Y-%m-%d %H:%i:%s')
			</if>
			<if test=" enddefined18 != null and enddefined18 !='' ">
				AND r.defined18 <![CDATA[ <= ]]>
				str_to_date(concat(#{enddefined18,jdbcType=VARCHAR}, '23:59:59'),
	                                       '%Y-%m-%d %H:%i:%s')
			</if>	
			 <if test="state == 0 and qKeyWord != null and qKeyWord != '' and queryType == 'phone'">
	       		<choose>
	       			<when test="queryType == 'phone'">
	       			    and r.telphone = #{qKeyWord}
	       			</when>	
	       		</choose>
	        </if>		
			and r.status in( 2,3)
			and r.type = 1
			</if>)t
			
	</select>
	
	<!-- 获取公司已经分配资源信息 -->
	<select id="findAssginResIds" resultType="String" parameterType="com.qftx.tsm.cust.dto.ResCustDto">
		select
			 r.RES_CUST_ID
			from tsm_res_cust_info r
			where
			r.org_id =#{orgId,jdbcType=VARCHAR}
			 <if test="resIds != null and resIds.size() > 0">
		   		AND r.RES_CUST_ID IN 
		   			<foreach collection="resIds" item="rid" open="(" separator="," close=")">
		   				#{rid}
		   			</foreach>
		   	</if>
			 <if test="qKeyWord != null and qKeyWord != ''">
	       		<choose>
		       		<when test="queryType == 'name'">
	                    and r.name LIKE CONCAT('%',#{qKeyWord},'%') 
	       			</when>
	       			<when test="queryType == 'company'">
	       			    and r.company LIKE CONCAT('%',#{qKeyWord},'%')
	       			</when>	
	       			<when test="queryType == 'mainLinkman' and (state == null or state == 0)">
	       			    and r.main_linkman LIKE CONCAT('%',#{qKeyWord},'%')
	       			</when>	
                    <otherwise>
                       and ${queryType} LIKE CONCAT('%',#{qKeyWord},'%')
                    </otherwise>			       		       			
	       		</choose>
	        </if>
			<if test="deptIds!=null">
				AND r.import_dept_id IN
					<foreach collection="deptIds" item="deptId" open="(" separator=","
						close=")">
						#{deptId}
					</foreach>	
			</if>
			<if test="deptIds==null">
				AND r.input_acc =#{inputAcc}
			</if>	
			<if test="ownerAccs!=null">
				AND r.owner_acc IN 
						<foreach collection="ownerAccs" item="shareAcc" open="(" separator=","
							close=")">
							#{shareAcc}
						</foreach>
					
			</if>
		    <if test="ownerAcc != null and ownerAcc != ''">
			    AND r.owner_acc = #{ownerAcc,jdbcType=VARCHAR} 
		    </if>			
			<if test="startDate!=null and startDate!='' ">
		       <![CDATA[
		        AND r.owner_start_date>=str_to_date(  CONCAT(#{startDate},' 00:00:00'), '%Y-%m-%d %H:%i:%s') 	       	
			   ]]>
			</if>
			<if test="endDate!=null and endDate!=''">
			   <![CDATA[
			   AND r.owner_start_date<=str_to_date(  CONCAT(#{endDate},' 23:59:59'), '%Y-%m-%d %H:%i:%s') 	 
			   ]]>
			</if>
			<choose>
				<when test="resGroupIds != null and resGroupIds.size() > 0">
					AND r.res_group_id in 
					<foreach collection="resGroupIds" item="rgid" open="(" separator="," close=")">
		   				#{rgid}
		   			</foreach>
				</when>
				<when test="resGroupIds == null"></when>
				<otherwise>
					AND r.res_group_id in ('')
				</otherwise>
			</choose>
			<if test=" companyTrade != null and companyTrade != '' ">
				AND r.company_trade = #{companyTrade,jdbcType=VARCHAR}
			</if>
			<if test=" provinceId != null and provinceId != '' ">
				AND r.province_id = #{provinceId,jdbcType=VARCHAR}
			</if>
			<if test=" cityId != null and cityId != '' ">
				AND r.city_id = #{cityId,jdbcType=VARCHAR}
			</if>
			<if test=" countyId != null and countyId != '' ">
				AND r.county_id = #{countyId,jdbcType=VARCHAR}
			</if>
			and r.is_del=0
			<if test="qStatus==2"> 
				AND   r.type =1
			</if>
			<if test="qStatus==3">
				AND ifNull(r.is_concat,0)=0  and  r.type =1
			</if>
			<if test="qStatus==4">
			    AND r.is_concat=1  and  r.type =1
			</if>
			<if test="defined1 != null and defined1 != ''">
				AND r.defined1 =#{defined1}
			</if>	
			<if test="defined2 != null and defined2 != ''">
				AND r.defined2 =#{defined2}
			</if>	
			<if test="defined3 != null and defined3 != ''">
				AND r.defined3 =#{defined3}
			</if>	
			<if test="defined4 != null and defined4 != ''">
				AND r.defined4 =#{defined4}
			</if>	
			<if test="defined5 != null and defined5 != ''">
				AND r.defined5 =#{defined5}
			</if>	
			<if test="defined6 != null and defined6 != ''">
				AND r.defined6 =#{defined6}
			</if>	
			<if test="defined7 != null and defined7 != ''">
				AND r.defined7 =#{defined7}
			</if>	
			<if test="defined8 != null and defined8 != ''">
				AND r.defined8 =#{defined8}
			</if>	
			<if test="defined9 != null and defined9 != ''">
				AND r.defined9 =#{defined9}
			</if>	
			<if test="defined10 != null and defined10 != ''">
				AND r.defined10 =#{defined10}
			</if>	
			<if test="defined11 != null and defined11 != ''">
				AND r.defined11 =#{defined11}
			</if>	
			<if test="defined12 != null and defined12 != ''">
				AND r.defined12 =#{defined12}
			</if>	
			<if test="defined13 != null and defined13 != ''">
				AND r.defined13 =#{defined13}
			</if>	
			<if test="defined14 != null and defined14 != ''">
				AND r.defined14 =#{defined14}
			</if>	
			<if test="defined15 != null and defined15 != ''">
				AND r.defined15 =#{defined15}
			</if>
			<if test=" startdefined16!= null and startdefined16 !='' ">
				AND r.defined16 >=
				 str_to_date(concat(#{startdefined16,jdbcType=VARCHAR}, '00:00:00'),
	                                       '%Y-%m-%d %H:%i:%s')
			</if>
			<if test=" enddefined16 != null and enddefined16 !='' ">
				AND r.defined16 <![CDATA[ <= ]]>
				str_to_date(concat(#{enddefined16,jdbcType=VARCHAR}, '23:59:59'),
	                                       '%Y-%m-%d %H:%i:%s')
			</if>
			<if test=" startdefined17!= null and startdefined17 !='' ">
				AND r.defined17 >=
				 str_to_date(concat(#{startdefined17,jdbcType=VARCHAR}, '00:00:00'),
	                                       '%Y-%m-%d %H:%i:%s')
			</if>
			<if test=" enddefined17 != null and enddefined17 !='' ">
				AND r.defined17 <![CDATA[ <= ]]>
				str_to_date(concat(#{enddefined17,jdbcType=VARCHAR}, '23:59:59'),
	                                       '%Y-%m-%d %H:%i:%s')
			</if>	
			<if test=" startdefined18!= null and startdefined18 !='' ">
				AND r.defined18 >=
				 str_to_date(concat(#{startdefined18,jdbcType=VARCHAR}, '00:00:00'),
	                                       '%Y-%m-%d %H:%i:%s')
			</if>
			<if test=" enddefined18 != null and enddefined18 !='' ">
				AND r.defined18 <![CDATA[ <= ]]>
				str_to_date(concat(#{enddefined18,jdbcType=VARCHAR}, '23:59:59'),
	                                       '%Y-%m-%d %H:%i:%s')
			</if>			
			and r.status in( 2,3)
			and r.type = 1
			order by r.OWNER_START_DATE
			limit #{page.currentResult,jdbcType=DECIMAL},#{page.showCount,jdbcType=DECIMAL} 
	</select>
	
	<select id="findAssginResPageList" resultMap="compResMap" parameterType="map">
		select
		 	r.RES_CUST_ID,r.NAME,r.company,r.MOBILEPHONE,r.TELPHONE,r.OWNER_START_DATE,r.INPUT_ACC,r.INPUT_DATE,
			 r.RES_GROUP_ID,r.OWNER_ACC,r.STATUS,r.type,
			 r.ORG_ID,r.import_dept_id,r.is_concat,
			 r.main_linkman,
			 r.company_fax,
		     r.company_trade,
		     r.company_money,
		     r.company_user,
		     r.KEYWORD,
		     r.address,
     	     r.province_id,
		     r.city_id,
		     r.county_id,
		     r.DEFINED1,
			 r.DEFINED2,
			 r.DEFINED3,
			 r.DEFINED4,
			 r.DEFINED5,
			 r.DEFINED6,
			 r.DEFINED7,
			 r.DEFINED8,
			 r.DEFINED9,
			 r.DEFINED10,
			 r.DEFINED11,
			 r.DEFINED12,
			 r.DEFINED13,
			 r.DEFINED14,
			 r.DEFINED15,
			 r.DEFINED16,
			 r.DEFINED17,
			 r.DEFINED18
			from tsm_res_cust_info r
			where
			r.org_id =#{orgId,jdbcType=VARCHAR}
			 <if test="ids!=null">
				AND r.res_cust_id IN 
					<foreach collection="ids" item="id" open="(" separator=","
						close=")">
						#{id}
					</foreach>	
			</if>
	</select>
	
	<!-- 获取公司已经分配资源信息count -->
	<select id="findAssginResCount" resultType="Integer" parameterType="com.qftx.tsm.cust.dto.ResCustDto">
		select
			count(1)
			from tsm_res_cust_info r
			where
			r.org_id =#{orgId,jdbcType=VARCHAR}
			<if test="resIds != null and resIds.size() > 0">
		   		AND r.RES_CUST_ID IN 
		   			<foreach collection="resIds" item="rid" open="(" separator="," close=")">
		   				#{rid}
		   			</foreach>
		   	</if>
			<if test="qKeyWord != null and qKeyWord != ''">
	       		<choose>
		       		<when test="queryType == 'name'">
	                    and r.name LIKE CONCAT('%',#{qKeyWord},'%') 
	       			</when>
	       			<when test="queryType == 'company'">
	       			    and r.company LIKE CONCAT('%',#{qKeyWord},'%')
	       			</when>	
	       			<when test="queryType == 'mainLinkman' and (state == null or state == 0)">
	       			    and r.main_linkman LIKE CONCAT('%',#{qKeyWord},'%')
	       			</when>	
                    <otherwise>
                       and ${queryType} LIKE CONCAT('%',#{qKeyWord},'%')
                    </otherwise>			       		       			
	       		</choose>
	        </if>
			<if test="deptIds!=null">
				AND r.import_dept_id IN
					<foreach collection="deptIds" item="deptId" open="(" separator=","
						close=")">
						#{deptId}
					</foreach>	
			</if>
			<if test="deptIds==null">
				AND r.input_acc =#{inputAcc}
			</if>	
			<if test="ownerAccs!=null">
				AND r.owner_acc IN 
						<foreach collection="ownerAccs" item="shareAcc" open="(" separator=","
							close=")">
							#{shareAcc}
						</foreach>
					
			</if>
		    <if test="ownerAcc != null and ownerAcc != ''">
			    AND r.owner_acc = #{ownerAcc,jdbcType=VARCHAR} 
		    </if>			
			<if test="startDate!=null and startDate!='' ">
		       <![CDATA[
		        AND r.owner_start_date>=str_to_date(  CONCAT(#{startDate},' 00:00:00'), '%Y-%m-%d %H:%i:%s') 	       	
			   ]]>
			</if>
			<if test="endDate!=null and endDate!=''">
			   <![CDATA[
			   AND r.owner_start_date<=str_to_date(  CONCAT(#{endDate},' 23:59:59'), '%Y-%m-%d %H:%i:%s') 	 
			   ]]>
			</if>
			<choose>
				<when test="resGroupIds != null and resGroupIds.size() > 0">
					AND r.res_group_id in 
					<foreach collection="resGroupIds" item="rgid" open="(" separator="," close=")">
		   				#{rgid}
		   			</foreach>
				</when>
				<when test="resGroupIds == null"></when>
				<otherwise>
					AND r.res_group_id in ('')
				</otherwise>
			</choose>
			<if test=" companyTrade != null and companyTrade != '' ">
				AND r.company_trade = #{companyTrade,jdbcType=VARCHAR}
			</if>
			<if test=" provinceId != null and provinceId != '' ">
				AND r.province_id = #{provinceId,jdbcType=VARCHAR}
			</if>
			<if test=" cityId != null and cityId != '' ">
				AND r.city_id = #{cityId,jdbcType=VARCHAR}
			</if>
			<if test=" countyId != null and countyId != '' ">
				AND r.county_id = #{countyId,jdbcType=VARCHAR}
			</if>
			and r.is_del=0
			<if test="qStatus==2"> 
				AND   r.type =1
			</if>
			<if test="qStatus==3">
				AND ifNull(r.is_concat,0)=0  and  r.type =1
			</if>
			<if test="qStatus==4">
			    AND r.is_concat=1  and  r.type =1
			</if>
			<if test="defined1 != null and defined1 != ''">
				AND r.defined1 =#{defined1}
			</if>	
			<if test="defined2 != null and defined2 != ''">
				AND r.defined2 =#{defined2}
			</if>	
			<if test="defined3 != null and defined3 != ''">
				AND r.defined3 =#{defined3}
			</if>	
			<if test="defined4 != null and defined4 != ''">
				AND r.defined4 =#{defined4}
			</if>	
			<if test="defined5 != null and defined5 != ''">
				AND r.defined5 =#{defined5}
			</if>	
			<if test="defined6 != null and defined6 != ''">
				AND r.defined6 =#{defined6}
			</if>	
			<if test="defined7 != null and defined7 != ''">
				AND r.defined7 =#{defined7}
			</if>	
			<if test="defined8 != null and defined8 != ''">
				AND r.defined8 =#{defined8}
			</if>	
			<if test="defined9 != null and defined9 != ''">
				AND r.defined9 =#{defined9}
			</if>	
			<if test="defined10 != null and defined10 != ''">
				AND r.defined10 =#{defined10}
			</if>	
			<if test="defined11 != null and defined11 != ''">
				AND r.defined11 =#{defined11}
			</if>	
			<if test="defined12 != null and defined12 != ''">
				AND r.defined12 =#{defined12}
			</if>	
			<if test="defined13 != null and defined13 != ''">
				AND r.defined13 =#{defined13}
			</if>	
			<if test="defined14 != null and defined14 != ''">
				AND r.defined14 =#{defined14}
			</if>	
			<if test="defined15 != null and defined15 != ''">
				AND r.defined15 =#{defined15}
			</if>	
			<if test=" startdefined16!= null and startdefined16 !='' ">
				AND r.defined16 >=
				 str_to_date(concat(#{startdefined16,jdbcType=VARCHAR}, '00:00:00'),
	                                       '%Y-%m-%d %H:%i:%s')
			</if>
			<if test=" enddefined16 != null and enddefined16 !='' ">
				AND r.defined16 <![CDATA[ <= ]]>
				str_to_date(concat(#{enddefined16,jdbcType=VARCHAR}, '23:59:59'),
	                                       '%Y-%m-%d %H:%i:%s')
			</if>
			<if test=" startdefined17!= null and startdefined17 !='' ">
				AND r.defined17 >=
				 str_to_date(concat(#{startdefined17,jdbcType=VARCHAR}, '00:00:00'),
	                                       '%Y-%m-%d %H:%i:%s')
			</if>
			<if test=" enddefined17 != null and enddefined17 !='' ">
				AND r.defined17 <![CDATA[ <= ]]>
				str_to_date(concat(#{enddefined17,jdbcType=VARCHAR}, '23:59:59'),
	                                       '%Y-%m-%d %H:%i:%s')
			</if>	
			<if test=" startdefined18!= null and startdefined18 !='' ">
				AND r.defined18 >=
				 str_to_date(concat(#{startdefined18,jdbcType=VARCHAR}, '00:00:00'),
	                                       '%Y-%m-%d %H:%i:%s')
			</if>
			<if test=" enddefined18 != null and enddefined18 !='' ">
				AND r.defined18 <![CDATA[ <= ]]>
				str_to_date(concat(#{enddefined18,jdbcType=VARCHAR}, '23:59:59'),
	                                       '%Y-%m-%d %H:%i:%s')
			</if>			
			and r.status in( 2,3)
			and r.type = 1
	</select>
	
	
	<!-- 获取未分组下已经分配资源信息-->
	<select id="findAssginUnGroupResAll" resultType="String" parameterType="com.qftx.tsm.cust.dto.ResCustDto">
		select RES_CUST_ID
		from tsm_res_cust_info r
		where r.org_id = #{orgId,jdbcType=VARCHAR}
		and r.RES_GROUP_ID is null
		and r.is_del=0
		and r.status = 2
		and r.type = 1
	</select>	
	<!-- 获取某分组下已经分配资源信息 -->
	<select id="findAssginGroupedResAll" resultType="String" parameterType="com.qftx.tsm.cust.dto.ResCustDto">
		select RES_CUST_ID from
	    tsm_res_cust_info r
		where r.org_id = #{orgId,jdbcType=VARCHAR}
		<if test="resGroupId!=null and resGroupId!=''">
		   <![CDATA[
		   AND r.RES_GROUP_ID = #{resGroupId}
		   ]]>
		</if>
		and r.is_del=0
		and r.status = 2
		and r.type = 1
		</select>
		
	<!-- 资源合并 -->
	<update id="megResToGroup" parameterType="map">
		update
		<include refid="table_name" />
		set UPDATE_ACC =#{account},UPDATE_DATE =
		now(),RES_GROUP_ID=#{groupId}
		where org_id=#{orgId} and  RES_CUST_ID in (${ids})
	</update>

	<!-- 获取公司所有资源信息(联系电话查询) -->
	<select id="findResIdsWithPhone" resultType="String" parameterType="com.qftx.tsm.cust.dto.ResCustDto">
			select t.RES_CUST_ID
			FROM
			(SELECT
				r.RES_CUST_ID
			FROM tsm_res_cust_info r
			WHERE r.org_id=#{orgId,jdbcType=VARCHAR}
			<if test="resIds != null and resIds.size() > 0">
		   		AND r.RES_CUST_ID IN 
		   			<foreach collection="resIds" item="rid" open="(" separator="," close=")">
		   				#{rid}
		   			</foreach>
		   	</if>
			<if test="deptIds!=null">
				AND r.import_dept_id IN 
					<foreach collection="deptIds" item="deptId" open="(" separator=","
						close=")">
						#{deptId}
					</foreach>	
			</if>
			<if test="deptIds==null">
				AND r.input_acc =#{inputAcc}
			</if>
			<if test="ownerAccs!=null">
				AND r.owner_acc IN 
				<foreach collection="ownerAccs" item="shareAcc" open="(" separator=","
					close=")">
					#{shareAcc}
				</foreach>				
			</if>			
			<if test="startDate!=null and startDate!='' ">
		       <![CDATA[
		        AND r.input_date>=str_to_date(  CONCAT(#{startDate},' 00:00:00'), '%Y-%m-%d %H:%i:%s') 	       	
			   ]]>
			</if>
			<if test="endDate!=null and endDate!=''">
			   <![CDATA[
			   AND r.input_date<=str_to_date(  CONCAT(#{endDate},' 23:59:59'), '%Y-%m-%d %H:%i:%s') 	 
			   ]]>
			</if>
			<choose>
				<when test="resGroupIds != null and resGroupIds.size() > 0">
					AND r.res_group_id in 
					<foreach collection="resGroupIds" item="rgid" open="(" separator="," close=")">
		   				#{rgid}
		   			</foreach>
				</when>
				<when test="resGroupIds == null"></when>
				<otherwise>
					AND r.res_group_id in ('')
				</otherwise>
			</choose>
			<if test=" companyTrade != null and companyTrade != '' ">
				AND r.company_trade = #{companyTrade,jdbcType=VARCHAR}
			</if>
			<if test=" provinceId != null and provinceId != '' ">
				AND r.province_id = #{provinceId,jdbcType=VARCHAR}
			</if>
			<if test=" cityId != null and cityId != '' ">
				AND r.city_id = #{cityId,jdbcType=VARCHAR}
			</if>
			<if test=" countyId != null and countyId != '' ">
				AND r.county_id = #{countyId,jdbcType=VARCHAR}
			</if>
			and r.is_del=0
			<if test="qStatus==1">
				AND r.status=1 and  r.type =1
			</if>
			<if test="qStatus==2"> 
				AND r.status in( 2,3)  and  r.type =1
			</if>
			<if test="qStatus==3">
				AND r.status in( 2,3) and  ifNull(r.is_concat,0)=0  and  r.type =1
			</if>
			<if test="qStatus==4">
			    AND r.status in( 2,3) and r.is_concat=1  and  r.type =1
			</if>
			<if test="qStatus==5">
				AND ( r.status=3 || r.status=2 ) and r.type =2
			</if>
			<if test="qStatus==6">
				AND  r.status=6  and  r.type =2
			</if>
			<if test="qStatus==7">
				and r.status=7   and  r.type =2
			</if>
			<if test="qStatus==8">
				and r.status=8   and  r.type =2
			</if>
			<if test="qStatus==9">
				and  ( r.status=4   or r.status = 5)
			</if>
			<if test="defined1 != null and defined1 != ''">
				AND r.defined1 =#{defined1}
			</if>	
			<if test="defined2 != null and defined2 != ''">
				AND r.defined2 =#{defined2}
			</if>	
			<if test="defined3 != null and defined3 != ''">
				AND r.defined3 =#{defined3}
			</if>	
			<if test="defined4 != null and defined4 != ''">
				AND r.defined4 =#{defined4}
			</if>	
			<if test="defined5 != null and defined5 != ''">
				AND r.defined5 =#{defined5}
			</if>	
			<if test="defined6 != null and defined6 != ''">
				AND r.defined6 =#{defined6}
			</if>	
			<if test="defined7 != null and defined7 != ''">
				AND r.defined7 =#{defined7}
			</if>	
			<if test="defined8 != null and defined8 != ''">
				AND r.defined8 =#{defined8}
			</if>	
			<if test="defined9 != null and defined9 != ''">
				AND r.defined9 =#{defined9}
			</if>	
			<if test="defined10 != null and defined10 != ''">
				AND r.defined10 =#{defined10}
			</if>	
			<if test="defined11 != null and defined11 != ''">
				AND r.defined11 =#{defined11}
			</if>	
			<if test="defined12 != null and defined12 != ''">
				AND r.defined12 =#{defined12}
			</if>	
			<if test="defined13 != null and defined13 != ''">
				AND r.defined13 =#{defined13}
			</if>	
			<if test="defined14 != null and defined14 != ''">
				AND r.defined14 =#{defined14}
			</if>	
			<if test="defined15 != null and defined15 != ''">
				AND r.defined15 =#{defined15}
			</if>
			<if test=" startdefined16!= null and startdefined16 !='' ">
				AND r.defined16 >=
				 str_to_date(concat(#{startdefined16,jdbcType=VARCHAR}, '00:00:00'),
	                                       '%Y-%m-%d %H:%i:%s')
			</if>
			<if test=" enddefined16 != null and enddefined16 !='' ">
				AND r.defined16 <![CDATA[ <= ]]>
				str_to_date(concat(#{enddefined16,jdbcType=VARCHAR}, '23:59:59'),
	                                       '%Y-%m-%d %H:%i:%s')
			</if>
			<if test=" startdefined17!= null and startdefined17 !='' ">
				AND r.defined17 >=
				 str_to_date(concat(#{startdefined17,jdbcType=VARCHAR}, '00:00:00'),
	                                       '%Y-%m-%d %H:%i:%s')
			</if>
			<if test=" enddefined17 != null and enddefined17 !='' ">
				AND r.defined17 <![CDATA[ <= ]]>
				str_to_date(concat(#{enddefined17,jdbcType=VARCHAR}, '23:59:59'),
	                                       '%Y-%m-%d %H:%i:%s')
			</if>	
			<if test=" startdefined18!= null and startdefined18 !='' ">
				AND r.defined18 >=
				 str_to_date(concat(#{startdefined18,jdbcType=VARCHAR}, '00:00:00'),
	                                       '%Y-%m-%d %H:%i:%s')
			</if>
			<if test=" enddefined18 != null and enddefined18 !='' ">
				AND r.defined18 <![CDATA[ <= ]]>
				str_to_date(concat(#{enddefined18,jdbcType=VARCHAR}, '23:59:59'),
	                                       '%Y-%m-%d %H:%i:%s')
			</if>
			<if test="qKeyWord != null and qKeyWord != '' and state == 0 and queryType == 'phone'">
	       		<choose>
	       			<when test="queryType == 'phone'">
	                    and r.mobilephone = #{qKeyWord} 
	       			</when>
	       		</choose>
	        </if>
	        <if test="state == 0 and qKeyWord != null and qKeyWord != '' and queryType == 'phone'">
	        	union
	        	SELECT
				r.RES_CUST_ID
			FROM tsm_res_cust_info r
			WHERE r.org_id=#{orgId,jdbcType=VARCHAR}
			<if test="resIds != null and resIds.size() > 0">
		   		AND r.RES_CUST_ID IN 
		   			<foreach collection="resIds" item="rid" open="(" separator="," close=")">
		   				#{rid}
		   			</foreach>
		   	</if>
			<if test="deptIds!=null">
				AND r.import_dept_id IN 
					<foreach collection="deptIds" item="deptId" open="(" separator=","
						close=")">
						#{deptId}
					</foreach>	
			</if>
			<if test="deptIds==null">
				AND r.input_acc =#{inputAcc}
			</if>
			<if test="ownerAccs!=null">
				AND r.owner_acc IN 
				<foreach collection="ownerAccs" item="shareAcc" open="(" separator=","
					close=")">
					#{shareAcc}
				</foreach>				
			</if>			
			<if test="startDate!=null and startDate!='' ">
		       <![CDATA[
		        AND r.input_date>=str_to_date(  CONCAT(#{startDate},' 00:00:00'), '%Y-%m-%d %H:%i:%s') 	       	
			   ]]>
			</if>
			<if test="endDate!=null and endDate!=''">
			   <![CDATA[
			   AND r.input_date<=str_to_date(  CONCAT(#{endDate},' 23:59:59'), '%Y-%m-%d %H:%i:%s') 	 
			   ]]>
			</if>
			<choose>
				<when test="resGroupIds != null and resGroupIds.size() > 0">
					AND r.res_group_id in 
					<foreach collection="resGroupIds" item="rgid" open="(" separator="," close=")">
		   				#{rgid}
		   			</foreach>
				</when>
				<when test="resGroupIds == null"></when>
				<otherwise>
					AND r.res_group_id in ('')
				</otherwise>
			</choose>
			<if test=" companyTrade != null and companyTrade != '' ">
				AND r.company_trade = #{companyTrade,jdbcType=VARCHAR}
			</if>
			<if test=" provinceId != null and provinceId != '' ">
				AND r.province_id = #{provinceId,jdbcType=VARCHAR}
			</if>
			<if test=" cityId != null and cityId != '' ">
				AND r.city_id = #{cityId,jdbcType=VARCHAR}
			</if>
			<if test=" countyId != null and countyId != '' ">
				AND r.county_id = #{countyId,jdbcType=VARCHAR}
			</if>
			and r.is_del=0
			<if test="qStatus==1">
				AND r.status=1 and  r.type =1
			</if>
			<if test="qStatus==2"> 
				AND r.status in( 2,3)  and  r.type =1
			</if>
			<if test="qStatus==3">
				AND r.status in( 2,3) and  ifNull(r.is_concat,0)=0  and  r.type =1
			</if>
			<if test="qStatus==4">
			    AND r.status in( 2,3) and r.is_concat=1  and  r.type =1
			</if>
			<if test="qStatus==5">
				AND ( r.status=3 || r.status=2 ) and r.type =2
			</if>
			<if test="qStatus==6">
				AND  r.status=6  and  r.type =2
			</if>
			<if test="qStatus==7">
				and r.status=7   and  r.type =2
			</if>
			<if test="qStatus==8">
				and r.status=8   and  r.type =2
			</if>
			<if test="qStatus==9">
				and  ( r.status=4   or r.status = 5)
			</if>
			<if test="defined1 != null and defined1 != ''">
				AND r.defined1 =#{defined1}
			</if>	
			<if test="defined2 != null and defined2 != ''">
				AND r.defined2 =#{defined2}
			</if>	
			<if test="defined3 != null and defined3 != ''">
				AND r.defined3 =#{defined3}
			</if>	
			<if test="defined4 != null and defined4 != ''">
				AND r.defined4 =#{defined4}
			</if>	
			<if test="defined5 != null and defined5 != ''">
				AND r.defined5 =#{defined5}
			</if>	
			<if test="defined6 != null and defined6 != ''">
				AND r.defined6 =#{defined6}
			</if>	
			<if test="defined7 != null and defined7 != ''">
				AND r.defined7 =#{defined7}
			</if>	
			<if test="defined8 != null and defined8 != ''">
				AND r.defined8 =#{defined8}
			</if>	
			<if test="defined9 != null and defined9 != ''">
				AND r.defined9 =#{defined9}
			</if>	
			<if test="defined10 != null and defined10 != ''">
				AND r.defined10 =#{defined10}
			</if>	
			<if test="defined11 != null and defined11 != ''">
				AND r.defined11 =#{defined11}
			</if>	
			<if test="defined12 != null and defined12 != ''">
				AND r.defined12 =#{defined12}
			</if>	
			<if test="defined13 != null and defined13 != ''">
				AND r.defined13 =#{defined13}
			</if>	
			<if test="defined14 != null and defined14 != ''">
				AND r.defined14 =#{defined14}
			</if>	
			<if test="defined15 != null and defined15 != ''">
				AND r.defined15 =#{defined15}
			</if>
			<if test=" startdefined16!= null and startdefined16 !='' ">
				AND r.defined16 >=
				 str_to_date(concat(#{startdefined16,jdbcType=VARCHAR}, '00:00:00'),
	                                       '%Y-%m-%d %H:%i:%s')
			</if>
			<if test=" enddefined16 != null and enddefined16 !='' ">
				AND r.defined16 <![CDATA[ <= ]]>
				str_to_date(concat(#{enddefined16,jdbcType=VARCHAR}, '23:59:59'),
	                                       '%Y-%m-%d %H:%i:%s')
			</if>
			<if test=" startdefined17!= null and startdefined17 !='' ">
				AND r.defined17 >=
				 str_to_date(concat(#{startdefined17,jdbcType=VARCHAR}, '00:00:00'),
	                                       '%Y-%m-%d %H:%i:%s')
			</if>
			<if test=" enddefined17 != null and enddefined17 !='' ">
				AND r.defined17 <![CDATA[ <= ]]>
				str_to_date(concat(#{enddefined17,jdbcType=VARCHAR}, '23:59:59'),
	                                       '%Y-%m-%d %H:%i:%s')
			</if>	
			<if test=" startdefined18!= null and startdefined18 !='' ">
				AND r.defined18 >=
				 str_to_date(concat(#{startdefined18,jdbcType=VARCHAR}, '00:00:00'),
	                                       '%Y-%m-%d %H:%i:%s')
			</if>
			<if test=" enddefined18 != null and enddefined18 !='' ">
				AND r.defined18 <![CDATA[ <= ]]>
				str_to_date(concat(#{enddefined18,jdbcType=VARCHAR}, '23:59:59'),
	                                       '%Y-%m-%d %H:%i:%s')
			</if>
			<if test="qKeyWord != null and qKeyWord != '' and state == 0 and queryType == 'phone'">
	       		<choose>
	       			<when test="queryType == 'phone'">
	                    and r.telphone = #{qKeyWord} 
	       			</when>
	       		</choose>
	        </if>
	        </if>)t
			limit #{page.currentResult,jdbcType=DECIMAL},#{page.showCount,jdbcType=DECIMAL}
	</select>
	
	<select id="findResWithPhonePageList" resultMap="compResMap" parameterType="map">
		SELECT
				r.RES_CUST_ID,r.NAME,r.company,r.MOBILEPHONE,r.TELPHONE,r.OWNER_START_DATE,r.INPUT_ACC,r.INPUT_DATE,
			 r.RES_GROUP_ID,r.OWNER_ACC,r.STATUS,r.type,
			 r.ORG_ID,r.import_dept_id,r.is_concat,
			 r.main_linkman,
			 r.company_fax,
		     r.company_trade,
		     r.company_money,
		     r.company_user,
		     r.KEYWORD,
		     r.address,
     	     r.province_id,
		     r.city_id,
		     r.county_id,
		     r.DEFINED1,
			 r.DEFINED2,
			 r.DEFINED3,
			 r.DEFINED4,
			 r.DEFINED5,
			 r.DEFINED6,
			 r.DEFINED7,
			 r.DEFINED8,
			 r.DEFINED9,
			 r.DEFINED10,
			 r.DEFINED11,
			 r.DEFINED12,
			 r.DEFINED13,
			 r.DEFINED14,
			 r.DEFINED15,
			 r.DEFINED16,
			 r.DEFINED17,
			 r.DEFINED18
			 FROM tsm_res_cust_info r
			WHERE r.org_id=#{orgId,jdbcType=VARCHAR}
			<if test="ids!=null">
				AND r.res_cust_id IN 
					<foreach collection="ids" item="id" open="(" separator=","
						close=")">
						#{id}
					</foreach>	
			</if>
	</select>
	
	
	<!-- 获取公司所有资源信息(联系电话查询) count-->
	<select id="findResWithPhoneCount" resultType="Integer" parameterType="com.qftx.tsm.cust.dto.ResCustDto">
			select count(1) from 
			(select r.res_cust_id
			FROM tsm_res_cust_info r
			WHERE r.org_id=#{orgId,jdbcType=VARCHAR}
			<if test="resIds != null and resIds.size() > 0">
		   		AND r.RES_CUST_ID IN 
		   			<foreach collection="resIds" item="rid" open="(" separator="," close=")">
		   				#{rid}
		   			</foreach>
		   	</if>
			<if test="deptIds!=null">
				AND r.import_dept_id IN 
					<foreach collection="deptIds" item="deptId" open="(" separator=","
						close=")">
						#{deptId}
					</foreach>	
			</if>
			<if test="deptIds==null">
				AND r.input_acc =#{inputAcc}
			</if>
			<if test="ownerAccs!=null">
				AND r.owner_acc IN 
				<foreach collection="ownerAccs" item="shareAcc" open="(" separator=","
					close=")">
					#{shareAcc}
				</foreach>				
			</if>			
			<if test="startDate!=null and startDate!='' ">
		       <![CDATA[
		        AND r.input_date>=str_to_date(  CONCAT(#{startDate},' 00:00:00'), '%Y-%m-%d %H:%i:%s') 	       	
			   ]]>
			</if>
			<if test="endDate!=null and endDate!=''">
			   <![CDATA[
			   AND r.input_date<=str_to_date(  CONCAT(#{endDate},' 23:59:59'), '%Y-%m-%d %H:%i:%s') 	 
			   ]]>
			</if>
			<choose>
				<when test="resGroupIds != null and resGroupIds.size() > 0">
					AND r.res_group_id in 
					<foreach collection="resGroupIds" item="rgid" open="(" separator="," close=")">
		   				#{rgid}
		   			</foreach>
				</when>
				<when test="resGroupIds == null"></when>
				<otherwise>
					AND r.res_group_id in ('')
				</otherwise>
			</choose>
			<if test=" companyTrade != null and companyTrade != '' ">
				AND r.company_trade = #{companyTrade,jdbcType=VARCHAR}
			</if>
			<if test=" provinceId != null and provinceId != '' ">
				AND r.province_id = #{provinceId,jdbcType=VARCHAR}
			</if>
			<if test=" cityId != null and cityId != '' ">
				AND r.city_id = #{cityId,jdbcType=VARCHAR}
			</if>
			<if test=" countyId != null and countyId != '' ">
				AND r.county_id = #{countyId,jdbcType=VARCHAR}
			</if>
			and r.is_del=0
			<if test="qStatus==1">
				AND r.status=1 and  r.type =1
			</if>
			<if test="qStatus==2"> 
				AND r.status in( 2,3)  and  r.type =1
			</if>
			<if test="qStatus==3">
				AND r.status in( 2,3) and  ifNull(r.is_concat,0)=0  and  r.type =1
			</if>
			<if test="qStatus==4">
			    AND r.status in( 2,3) and r.is_concat=1  and  r.type =1
			</if>
			<if test="qStatus==5">
				AND ( r.status=3 || r.status=2 ) and r.type =2
			</if>
			<if test="qStatus==6">
				AND  r.status=6  and  r.type =2
			</if>
			<if test="qStatus==7">
				and r.status=7   and  r.type =2
			</if>
			<if test="qStatus==8">
				and r.status=8   and  r.type =2
			</if>
			<if test="qStatus==9">
				and  ( r.status=4   or r.status = 5)
			</if>
			<if test="defined1 != null and defined1 != ''">
				AND r.defined1 =#{defined1}
			</if>	
			<if test="defined2 != null and defined2 != ''">
				AND r.defined2 =#{defined2}
			</if>	
			<if test="defined3 != null and defined3 != ''">
				AND r.defined3 =#{defined3}
			</if>	
			<if test="defined4 != null and defined4 != ''">
				AND r.defined4 =#{defined4}
			</if>	
			<if test="defined5 != null and defined5 != ''">
				AND r.defined5 =#{defined5}
			</if>	
			<if test="defined6 != null and defined6 != ''">
				AND r.defined6 =#{defined6}
			</if>	
			<if test="defined7 != null and defined7 != ''">
				AND r.defined7 =#{defined7}
			</if>	
			<if test="defined8 != null and defined8 != ''">
				AND r.defined8 =#{defined8}
			</if>	
			<if test="defined9 != null and defined9 != ''">
				AND r.defined9 =#{defined9}
			</if>	
			<if test="defined10 != null and defined10 != ''">
				AND r.defined10 =#{defined10}
			</if>	
			<if test="defined11 != null and defined11 != ''">
				AND r.defined11 =#{defined11}
			</if>	
			<if test="defined12 != null and defined12 != ''">
				AND r.defined12 =#{defined12}
			</if>	
			<if test="defined13 != null and defined13 != ''">
				AND r.defined13 =#{defined13}
			</if>	
			<if test="defined14 != null and defined14 != ''">
				AND r.defined14 =#{defined14}
			</if>	
			<if test="defined15 != null and defined15 != ''">
				AND r.defined15 =#{defined15}
			</if>
			<if test=" startdefined16!= null and startdefined16 !='' ">
				AND r.defined16 >=
				 str_to_date(concat(#{startdefined16,jdbcType=VARCHAR}, '00:00:00'),
	                                       '%Y-%m-%d %H:%i:%s')
			</if>
			<if test=" enddefined16 != null and enddefined16 !='' ">
				AND r.defined16 <![CDATA[ <= ]]>
				str_to_date(concat(#{enddefined16,jdbcType=VARCHAR}, '23:59:59'),
	                                       '%Y-%m-%d %H:%i:%s')
			</if>
			<if test=" startdefined17!= null and startdefined17 !='' ">
				AND r.defined17 >=
				 str_to_date(concat(#{startdefined17,jdbcType=VARCHAR}, '00:00:00'),
	                                       '%Y-%m-%d %H:%i:%s')
			</if>
			<if test=" enddefined17 != null and enddefined17 !='' ">
				AND r.defined17 <![CDATA[ <= ]]>
				str_to_date(concat(#{enddefined17,jdbcType=VARCHAR}, '23:59:59'),
	                                       '%Y-%m-%d %H:%i:%s')
			</if>	
			<if test=" startdefined18!= null and startdefined18 !='' ">
				AND r.defined18 >=
				 str_to_date(concat(#{startdefined18,jdbcType=VARCHAR}, '00:00:00'),
	                                       '%Y-%m-%d %H:%i:%s')
			</if>
			<if test=" enddefined18 != null and enddefined18 !='' ">
				AND r.defined18 <![CDATA[ <= ]]>
				str_to_date(concat(#{enddefined18,jdbcType=VARCHAR}, '23:59:59'),
	                                       '%Y-%m-%d %H:%i:%s')
			</if>
			<if test="qKeyWord != null and qKeyWord != '' and state == 0 and queryType == 'phone'">
	       		<choose>
	       			<when test="queryType == 'phone'">
	                    and r.mobilephone = #{qKeyWord} 
	       			</when>
	       		</choose>
	        </if>
	        <if test="state == 0 and qKeyWord != null and qKeyWord != '' and queryType == 'phone'">
	        union
	        select r.res_cust_id
			FROM tsm_res_cust_info r
			WHERE r.org_id=#{orgId,jdbcType=VARCHAR}
			<if test="resIds != null and resIds.size() > 0">
		   		AND r.RES_CUST_ID IN 
		   			<foreach collection="resIds" item="rid" open="(" separator="," close=")">
		   				#{rid}
		   			</foreach>
		   	</if>
			<if test="deptIds!=null">
				AND r.import_dept_id IN 
					<foreach collection="deptIds" item="deptId" open="(" separator=","
						close=")">
						#{deptId}
					</foreach>	
			</if>
			<if test="deptIds==null">
				AND r.input_acc =#{inputAcc}
			</if>
			<if test="ownerAccs!=null">
				AND r.owner_acc IN 
				<foreach collection="ownerAccs" item="shareAcc" open="(" separator=","
					close=")">
					#{shareAcc}
				</foreach>				
			</if>			
			<if test="startDate!=null and startDate!='' ">
		       <![CDATA[
		        AND r.input_date>=str_to_date(  CONCAT(#{startDate},' 00:00:00'), '%Y-%m-%d %H:%i:%s') 	       	
			   ]]>
			</if>
			<if test="endDate!=null and endDate!=''">
			   <![CDATA[
			   AND r.input_date<=str_to_date(  CONCAT(#{endDate},' 23:59:59'), '%Y-%m-%d %H:%i:%s') 	 
			   ]]>
			</if>
			<choose>
				<when test="resGroupIds != null and resGroupIds.size() > 0">
					AND r.res_group_id in 
					<foreach collection="resGroupIds" item="rgid" open="(" separator="," close=")">
		   				#{rgid}
		   			</foreach>
				</when>
				<when test="resGroupIds == null"></when>
				<otherwise>
					AND r.res_group_id in ('')
				</otherwise>
			</choose>
			<if test=" companyTrade != null and companyTrade != '' ">
				AND r.company_trade = #{companyTrade,jdbcType=VARCHAR}
			</if>
			<if test=" provinceId != null and provinceId != '' ">
				AND r.province_id = #{provinceId,jdbcType=VARCHAR}
			</if>
			<if test=" cityId != null and cityId != '' ">
				AND r.city_id = #{cityId,jdbcType=VARCHAR}
			</if>
			<if test=" countyId != null and countyId != '' ">
				AND r.county_id = #{countyId,jdbcType=VARCHAR}
			</if>
			and r.is_del=0
			<if test="qStatus==1">
				AND r.status=1 and  r.type =1
			</if>
			<if test="qStatus==2"> 
				AND r.status in( 2,3)  and  r.type =1
			</if>
			<if test="qStatus==3">
				AND r.status in( 2,3) and  ifNull(r.is_concat,0)=0  and  r.type =1
			</if>
			<if test="qStatus==4">
			    AND r.status in( 2,3) and r.is_concat=1  and  r.type =1
			</if>
			<if test="qStatus==5">
				AND ( r.status=3 || r.status=2 ) and r.type =2
			</if>
			<if test="qStatus==6">
				AND  r.status=6  and  r.type =2
			</if>
			<if test="qStatus==7">
				and r.status=7   and  r.type =2
			</if>
			<if test="qStatus==8">
				and r.status=8   and  r.type =2
			</if>
			<if test="qStatus==9">
				and  ( r.status=4   or r.status = 5)
			</if>
			<if test="defined1 != null and defined1 != ''">
				AND r.defined1 =#{defined1}
			</if>	
			<if test="defined2 != null and defined2 != ''">
				AND r.defined2 =#{defined2}
			</if>	
			<if test="defined3 != null and defined3 != ''">
				AND r.defined3 =#{defined3}
			</if>	
			<if test="defined4 != null and defined4 != ''">
				AND r.defined4 =#{defined4}
			</if>	
			<if test="defined5 != null and defined5 != ''">
				AND r.defined5 =#{defined5}
			</if>	
			<if test="defined6 != null and defined6 != ''">
				AND r.defined6 =#{defined6}
			</if>	
			<if test="defined7 != null and defined7 != ''">
				AND r.defined7 =#{defined7}
			</if>	
			<if test="defined8 != null and defined8 != ''">
				AND r.defined8 =#{defined8}
			</if>	
			<if test="defined9 != null and defined9 != ''">
				AND r.defined9 =#{defined9}
			</if>	
			<if test="defined10 != null and defined10 != ''">
				AND r.defined10 =#{defined10}
			</if>	
			<if test="defined11 != null and defined11 != ''">
				AND r.defined11 =#{defined11}
			</if>	
			<if test="defined12 != null and defined12 != ''">
				AND r.defined12 =#{defined12}
			</if>	
			<if test="defined13 != null and defined13 != ''">
				AND r.defined13 =#{defined13}
			</if>	
			<if test="defined14 != null and defined14 != ''">
				AND r.defined14 =#{defined14}
			</if>	
			<if test="defined15 != null and defined15 != ''">
				AND r.defined15 =#{defined15}
			</if>
			<if test=" startdefined16!= null and startdefined16 !='' ">
				AND r.defined16 >=
				 str_to_date(concat(#{startdefined16,jdbcType=VARCHAR}, '00:00:00'),
	                                       '%Y-%m-%d %H:%i:%s')
			</if>
			<if test=" enddefined16 != null and enddefined16 !='' ">
				AND r.defined16 <![CDATA[ <= ]]>
				str_to_date(concat(#{enddefined16,jdbcType=VARCHAR}, '23:59:59'),
	                                       '%Y-%m-%d %H:%i:%s')
			</if>
			<if test=" startdefined17!= null and startdefined17 !='' ">
				AND r.defined17 >=
				 str_to_date(concat(#{startdefined17,jdbcType=VARCHAR}, '00:00:00'),
	                                       '%Y-%m-%d %H:%i:%s')
			</if>
			<if test=" enddefined17 != null and enddefined17 !='' ">
				AND r.defined17 <![CDATA[ <= ]]>
				str_to_date(concat(#{enddefined17,jdbcType=VARCHAR}, '23:59:59'),
	                                       '%Y-%m-%d %H:%i:%s')
			</if>	
			<if test=" startdefined18!= null and startdefined18 !='' ">
				AND r.defined18 >=
				 str_to_date(concat(#{startdefined18,jdbcType=VARCHAR}, '00:00:00'),
	                                       '%Y-%m-%d %H:%i:%s')
			</if>
			<if test=" enddefined18 != null and enddefined18 !='' ">
				AND r.defined18 <![CDATA[ <= ]]>
				str_to_date(concat(#{enddefined18,jdbcType=VARCHAR}, '23:59:59'),
	                                       '%Y-%m-%d %H:%i:%s')
			</if>
			<if test="qKeyWord != null and qKeyWord != '' and state == 0 and queryType == 'phone'">
	       		<choose>
	       			<when test="queryType == 'phone'">
	                    and r.telphone = #{qKeyWord}
	       			</when>
	       		</choose>
	        </if>
	        </if>
	        )t
	        
			
	</select>
		
	<!-- 获取公司所有资源信息 -->
	<select id="findResIds" resultType="String" parameterType="com.qftx.tsm.cust.dto.ResCustDto">
			SELECT
			 r.RES_CUST_ID
			FROM tsm_res_cust_info r
			WHERE r.org_id=#{orgId,jdbcType=VARCHAR}
			<if test="resIds != null and resIds.size() > 0">
		   		AND r.RES_CUST_ID IN 
		   			<foreach collection="resIds" item="rid" open="(" separator="," close=")">
		   				#{rid}
		   			</foreach>
		   	</if>
			<if test="qKeyWord != null and qKeyWord != ''">
	       		<choose>
	       			<when test="queryType == 'name'">
	                    and r.name LIKE CONCAT('%',#{qKeyWord},'%') 
	       			</when>
	       			<when test="queryType == 'company'">
	       			    and r.company LIKE CONCAT('%',#{qKeyWord},'%')
	       			</when>	
	       			<when test="queryType == 'mainLinkman' and (state == null or state == 0)">
	       			    and r.main_linkman LIKE CONCAT('%',#{qKeyWord},'%')
	       			</when>	
                    <otherwise>
                       and ${queryType} LIKE CONCAT('%',#{qKeyWord},'%')
                    </otherwise>			       		     	       				       			
	       		</choose>
	        </if>
			<if test="deptIds!=null">
				AND r.import_dept_id IN 
					<foreach collection="deptIds" item="deptId" open="(" separator=","
						close=")">
						#{deptId}
					</foreach>	
			</if>
			<if test="deptIds==null">
				AND r.input_acc =#{inputAcc}
			</if>
			<if test="ownerAccs!=null">
				AND r.owner_acc IN 
				<foreach collection="ownerAccs" item="shareAcc" open="(" separator=","
					close=")">
					#{shareAcc}
				</foreach>				
			</if>			
			<if test="startDate!=null and startDate!='' ">
		       <![CDATA[
		        AND r.input_date>=str_to_date(  CONCAT(#{startDate},' 00:00:00'), '%Y-%m-%d %H:%i:%s') 	       	
			   ]]>
			</if>
			<if test="endDate!=null and endDate!=''">
			   <![CDATA[
			   AND r.input_date<=str_to_date(  CONCAT(#{endDate},' 23:59:59'), '%Y-%m-%d %H:%i:%s') 	 
			   ]]>
			</if>
			<choose>
				<when test="resGroupIds != null and resGroupIds.size() > 0">
					AND r.res_group_id in 
					<foreach collection="resGroupIds" item="rgid" open="(" separator="," close=")">
		   				#{rgid}
		   			</foreach>
				</when>
				<when test="resGroupIds == null"></when>
				<otherwise>
					AND r.res_group_id in ('')
				</otherwise>
			</choose>
			<if test=" companyTrade != null and companyTrade != '' ">
				AND r.company_trade = #{companyTrade,jdbcType=VARCHAR}
			</if>
			<if test=" provinceId != null and provinceId != '' ">
				AND r.province_id = #{provinceId,jdbcType=VARCHAR}
			</if>
			<if test=" cityId != null and cityId != '' ">
				AND r.city_id = #{cityId,jdbcType=VARCHAR}
			</if>
			<if test=" countyId != null and countyId != '' ">
				AND r.county_id = #{countyId,jdbcType=VARCHAR}
			</if>
			and r.is_del=0
			<if test="qStatus==1">
				AND r.status=1 and  r.type =1
			</if>
			<if test="qStatus==2"> 
				AND r.status in( 2,3)  and  r.type =1
			</if>
			<if test="qStatus==3">
				AND r.status in( 2,3) and  ifNull(r.is_concat,0)=0  and  r.type =1
			</if>
			<if test="qStatus==4">
			    AND r.status in( 2,3) and r.is_concat=1  and  r.type =1
			</if>
			<if test="qStatus==5">
				AND ( r.status=3 || r.status=2 ) and r.type =2
			</if>
			<if test="qStatus==6">
				AND  r.status=6  and  r.type =2
			</if>
			<if test="qStatus==7">
				and r.status=7   and  r.type =2
			</if>
			<if test="qStatus==8">
				and r.status=8   and  r.type =2
			</if>
			<if test="qStatus==9">
				and  ( r.status=4   or r.status = 5)
			</if>
			<if test="defined1 != null and defined1 != ''">
				AND r.defined1 =#{defined1}
			</if>	
			<if test="defined2 != null and defined2 != ''">
				AND r.defined2 =#{defined2}
			</if>	
			<if test="defined3 != null and defined3 != ''">
				AND r.defined3 =#{defined3}
			</if>	
			<if test="defined4 != null and defined4 != ''">
				AND r.defined4 =#{defined4}
			</if>	
			<if test="defined5 != null and defined5 != ''">
				AND r.defined5 =#{defined5}
			</if>	
			<if test="defined6 != null and defined6 != ''">
				AND r.defined6 =#{defined6}
			</if>	
			<if test="defined7 != null and defined7 != ''">
				AND r.defined7 =#{defined7}
			</if>	
			<if test="defined8 != null and defined8 != ''">
				AND r.defined8 =#{defined8}
			</if>	
			<if test="defined9 != null and defined9 != ''">
				AND r.defined9 =#{defined9}
			</if>	
			<if test="defined10 != null and defined10 != ''">
				AND r.defined10 =#{defined10}
			</if>	
			<if test="defined11 != null and defined11 != ''">
				AND r.defined11 =#{defined11}
			</if>	
			<if test="defined12 != null and defined12 != ''">
				AND r.defined12 =#{defined12}
			</if>	
			<if test="defined13 != null and defined13 != ''">
				AND r.defined13 =#{defined13}
			</if>	
			<if test="defined14 != null and defined14 != ''">
				AND r.defined14 =#{defined14}
			</if>	
			<if test="defined15 != null and defined15 != ''">
				AND r.defined15 =#{defined15}
			</if>
			<if test=" startdefined16!= null and startdefined16 !='' ">
				AND r.defined16 >=
				 str_to_date(concat(#{startdefined16,jdbcType=VARCHAR}, '00:00:00'),
	                                       '%Y-%m-%d %H:%i:%s')
			</if>
			<if test=" enddefined16 != null and enddefined16 !='' ">
				AND r.defined16 <![CDATA[ <= ]]>
				str_to_date(concat(#{enddefined16,jdbcType=VARCHAR}, '23:59:59'),
	                                       '%Y-%m-%d %H:%i:%s')
			</if>
			<if test=" startdefined17!= null and startdefined17 !='' ">
				AND r.defined17 >=
				 str_to_date(concat(#{startdefined17,jdbcType=VARCHAR}, '00:00:00'),
	                                       '%Y-%m-%d %H:%i:%s')
			</if>
			<if test=" enddefined17 != null and enddefined17 !='' ">
				AND r.defined17 <![CDATA[ <= ]]>
				str_to_date(concat(#{enddefined17,jdbcType=VARCHAR}, '23:59:59'),
	                                       '%Y-%m-%d %H:%i:%s')
			</if>	
			<if test=" startdefined18!= null and startdefined18 !='' ">
				AND r.defined18 >=
				 str_to_date(concat(#{startdefined18,jdbcType=VARCHAR}, '00:00:00'),
	                                       '%Y-%m-%d %H:%i:%s')
			</if>
			<if test=" enddefined18 != null and enddefined18 !='' ">
				AND r.defined18 <![CDATA[ <= ]]>
				str_to_date(concat(#{enddefined18,jdbcType=VARCHAR}, '23:59:59'),
	                                       '%Y-%m-%d %H:%i:%s')
			</if>
			order by r.input_date desc,r.res_cust_id
			limit #{page.currentResult,jdbcType=DECIMAL},#{page.showCount,jdbcType=DECIMAL}
			
	</select>
	
	<select id="findResPageList" resultMap="compResMap" parameterType="map">
		SELECT
			 r.RES_CUST_ID,r.NAME,r.company,r.MOBILEPHONE,r.TELPHONE,r.OWNER_START_DATE,r.INPUT_ACC,r.INPUT_DATE,
			 r.RES_GROUP_ID,r.OWNER_ACC,r.STATUS,r.type,
			 r.org_id,r.import_dept_id,r.is_concat,
			 r.main_linkman,
			 r.company_fax,
		     r.company_trade,
		     r.company_money,
		     r.company_user,
		     r.KEYWORD,
		     r.address,
     	     r.province_id,
		     r.city_id,
		     r.county_id,
		     r.DEFINED1,
			 r.DEFINED2,
			 r.DEFINED3,
			 r.DEFINED4,
			 r.DEFINED5,
			 r.DEFINED6,
			 r.DEFINED7,
			 r.DEFINED8,
			 r.DEFINED9,
			 r.DEFINED10,
			 r.DEFINED11,
			 r.DEFINED12,
			 r.DEFINED13,
			 r.DEFINED14,
			 r.DEFINED15,
			 r.DEFINED16,
			 r.DEFINED17,
			 r.DEFINED18
			FROM tsm_res_cust_info r
			WHERE r.org_id=#{orgId,jdbcType=VARCHAR}
			<if test="ids!=null">
				AND r.res_cust_id IN 
					<foreach collection="ids" item="id" open="(" separator=","
						close=")">
						#{id}
					</foreach>	
			</if>
	</select>
	<!-- <select id="findResPageList" resultMap="compResMap"
		parameterType="com.qftx.tsm.cust.dto.ResCustDto">
			SELECT
			 r.RES_CUST_ID,r.NAME,r.company,r.MOBILEPHONE,r.TELPHONE,r.OWNER_START_DATE,r.INPUT_ACC,r.INPUT_DATE,
			 r.RES_GROUP_ID,r.OWNER_ACC,r.STATUS,r.type,
			 r.org_id,r.import_dept_id,r.is_concat,
			 r.main_linkman,
			 r.company_fax,
		     r.company_trade,
		     r.company_money,
		     r.company_user,
		     r.KEYWORD,
		     r.address,
     	     r.province_id,
		     r.city_id,
		     r.county_id,
		     r.DEFINED1,
			 r.DEFINED2,
			 r.DEFINED3,
			 r.DEFINED4,
			 r.DEFINED5,
			 r.DEFINED6,
			 r.DEFINED7,
			 r.DEFINED8,
			 r.DEFINED9,
			 r.DEFINED10,
			 r.DEFINED11,
			 r.DEFINED12,
			 r.DEFINED13,
			 r.DEFINED14,
			 r.DEFINED15,
			 r.DEFINED16,
			 r.DEFINED17,
			 r.DEFINED18
			FROM tsm_res_cust_info r
			WHERE r.org_id=#{orgId,jdbcType=VARCHAR}
			<if test="qKeyWord != null and qKeyWord != ''">
	       		<choose>
	       			<when test="queryType == 'name'">
	                    and r.name LIKE CONCAT('%',#{qKeyWord},'%') 
	       			</when>
	       			<when test="queryType == 'mainLinkman'">
	       			    and r.main_linkman LIKE CONCAT('%',#{qKeyWord},'%')
	       			</when>
	       			<when test="queryType == 'company'">
	       			    and r.company LIKE CONCAT('%',#{qKeyWord},'%')
	       			</when>	
                    <otherwise>
                       and ${queryType} LIKE CONCAT('%',#{qKeyWord},'%')
                    </otherwise>			       		     	       				       			
	       		</choose>
	        </if>
			<if test="deptIds!=null">
				AND r.import_dept_id IN 
					<foreach collection="deptIds" item="deptId" open="(" separator=","
						close=")">
						#{deptId}
					</foreach>	
			</if>
			<if test="deptIds==null">
				AND r.input_acc =#{inputAcc}
			</if>
			<if test="ownerAccs!=null">
				AND r.owner_acc IN 
				<foreach collection="ownerAccs" item="shareAcc" open="(" separator=","
					close=")">
					#{shareAcc}
				</foreach>				
			</if>			
			<if test="startDate!=null and startDate!='' ">
		       <![CDATA[
		        AND r.input_date>=str_to_date(  CONCAT(#{startDate},' 00:00:00'), '%Y-%m-%d %H:%i:%s') 	       	
			   ]]>
			</if>
			<if test="endDate!=null and endDate!=''">
			   <![CDATA[
			   AND r.input_date<=str_to_date(  CONCAT(#{endDate},' 23:59:59'), '%Y-%m-%d %H:%i:%s') 	 
			   ]]>
			</if>
			<if test="resGroupId!=null and resGroupId!=''">
			   <![CDATA[
			   AND r.res_group_id = #{resGroupId}
			   ]]>
			</if>
			and r.is_del=0
			<if test="qStatus==1">
				AND r.status=1 and  r.type =1
			</if>
			<if test="qStatus==2"> 
				AND r.status in( 2,3)  and  r.type =1
			</if>
			<if test="qStatus==3">
				AND r.status in( 2,3) and  ifNull(r.is_concat,0)=0  and  r.type =1
			</if>
			<if test="qStatus==4">
			    AND r.status in( 2,3) and r.is_concat=1  and  r.type =1
			</if>
			<if test="qStatus==5">
				AND ( r.status=3 || r.status=2 ) and r.type =2
			</if>
			<if test="qStatus==6">
				AND  r.status=6  and  r.type =2
			</if>
			<if test="qStatus==7">
				and r.status=7   and  r.type =2
			</if>
			<if test="qStatus==8">
				and r.status=8   and  r.type =2
			</if>
			<if test="qStatus==9">
				and  ( r.status=4   or r.status = 5)
			</if>
			<if test=" startdefined16!= null and startdefined16 !='' ">
				AND r.defined16 >=
				 str_to_date(concat(#{startdefined16,jdbcType=VARCHAR}, '00:00:00'),
	                                       '%Y-%m-%d %H:%i:%s')
			</if>
			<if test=" enddefined16 != null and enddefined16 !='' ">
				AND r.defined16 <![CDATA[ <= ]]>
				str_to_date(concat(#{enddefined16,jdbcType=VARCHAR}, '23:59:59'),
	                                       '%Y-%m-%d %H:%i:%s')
			</if>
			<if test=" startdefined17!= null and startdefined17 !='' ">
				AND r.defined17 >=
				 str_to_date(concat(#{startdefined17,jdbcType=VARCHAR}, '00:00:00'),
	                                       '%Y-%m-%d %H:%i:%s')
			</if>
			<if test=" enddefined17 != null and enddefined17 !='' ">
				AND r.defined17 <![CDATA[ <= ]]>
				str_to_date(concat(#{enddefined17,jdbcType=VARCHAR}, '23:59:59'),
	                                       '%Y-%m-%d %H:%i:%s')
			</if>	
			<if test=" startdefined18!= null and startdefined18 !='' ">
				AND r.defined18 >=
				 str_to_date(concat(#{startdefined18,jdbcType=VARCHAR}, '00:00:00'),
	                                       '%Y-%m-%d %H:%i:%s')
			</if>
			<if test=" enddefined18 != null and enddefined18 !='' ">
				AND r.defined18 <![CDATA[ <= ]]>
				str_to_date(concat(#{enddefined18,jdbcType=VARCHAR}, '23:59:59'),
	                                       '%Y-%m-%d %H:%i:%s')
			</if>
			order by r.input_date desc,r.res_cust_id
			limit #{page.currentResult,jdbcType=DECIMAL},#{page.showCount,jdbcType=DECIMAL}
			
	</select> -->
	
	<!-- 获取公司所有资源信息count -->
	<select id="findResCount" resultType="Integer"
		parameterType="com.qftx.tsm.cust.dto.ResCustDto">
			SELECT
			count(1)
			FROM tsm_res_cust_info r
			WHERE r.org_id=#{orgId,jdbcType=VARCHAR}
			<if test="resIds != null and resIds.size() > 0">
		   		AND r.RES_CUST_ID IN 
		   			<foreach collection="resIds" item="rid" open="(" separator="," close=")">
		   				#{rid}
		   			</foreach>
		   	</if>
			<if test="qKeyWord != null and qKeyWord != ''">
	       		<choose>
	       			<when test="queryType == 'name'">
	                    and r.name LIKE CONCAT('%',#{qKeyWord},'%') 
	       			</when>
	       			<when test="queryType == 'company'">
	       			    and r.company LIKE CONCAT('%',#{qKeyWord},'%')
	       			</when>	
	       			<when test="queryType == 'mainLinkman' and (state == null or state == 0)">
	       			    and r.main_linkman LIKE CONCAT('%',#{qKeyWord},'%')
	       			</when>	
                    <otherwise>
                       and ${queryType} LIKE CONCAT('%',#{qKeyWord},'%')
                    </otherwise>			       		     	       				       			
	       		</choose>
	        </if>
			<if test="deptIds!=null">
				AND r.import_dept_id IN 
					<foreach collection="deptIds" item="deptId" open="(" separator=","
						close=")">
						#{deptId}
					</foreach>	
			</if>
			<if test="deptIds==null">
				AND r.input_acc =#{inputAcc}
			</if>
			<if test="ownerAccs!=null">
				AND r.owner_acc IN 
				<foreach collection="ownerAccs" item="shareAcc" open="(" separator=","
					close=")">
					#{shareAcc}
				</foreach>				
			</if>			
			<if test="startDate!=null and startDate!='' ">
		       <![CDATA[
		        AND r.input_date>=str_to_date(  CONCAT(#{startDate},' 00:00:00'), '%Y-%m-%d %H:%i:%s') 	       	
			   ]]>
			</if>
			<if test="endDate!=null and endDate!=''">
			   <![CDATA[
			   AND r.input_date<=str_to_date(  CONCAT(#{endDate},' 23:59:59'), '%Y-%m-%d %H:%i:%s') 	 
			   ]]>
			</if>
			<choose>
				<when test="resGroupIds != null and resGroupIds.size() > 0">
					AND r.res_group_id in 
					<foreach collection="resGroupIds" item="rgid" open="(" separator="," close=")">
		   				#{rgid}
		   			</foreach>
				</when>
				<when test="resGroupIds == null"></when>
				<otherwise>
					AND r.res_group_id in ('')
				</otherwise>
			</choose>
			<if test=" companyTrade != null and companyTrade != '' ">
				AND r.company_trade = #{companyTrade,jdbcType=VARCHAR}
			</if>
			<if test=" provinceId != null and provinceId != '' ">
				AND r.province_id = #{provinceId,jdbcType=VARCHAR}
			</if>
			<if test=" cityId != null and cityId != '' ">
				AND r.city_id = #{cityId,jdbcType=VARCHAR}
			</if>
			<if test=" countyId != null and countyId != '' ">
				AND r.county_id = #{countyId,jdbcType=VARCHAR}
			</if>
			and r.is_del=0
			<if test="qStatus==1">
				AND r.status=1 and  r.type =1
			</if>
			<if test="qStatus==2"> 
				AND r.status in( 2,3)  and  r.type =1
			</if>
			<if test="qStatus==3">
				AND r.status in( 2,3) and  ifNull(r.is_concat,0)=0  and  r.type =1
			</if>
			<if test="qStatus==4">
			    AND r.status in( 2,3) and r.is_concat=1  and  r.type =1
			</if>
			<if test="qStatus==5">
				AND ( r.status=3 || r.status=2 ) and r.type =2
			</if>
			<if test="qStatus==6">
				AND  r.status=6  and  r.type =2
			</if>
			<if test="qStatus==7">
				and r.status=7   and  r.type =2
			</if>
			<if test="qStatus==8">
				and r.status=8   and  r.type =2
			</if>
			<if test="qStatus==9">
				and  ( r.status=4   or r.status = 5)
			</if>
			<if test="defined1 != null and defined1 != ''">
				AND r.defined1 =#{defined1}
			</if>	
			<if test="defined2 != null and defined2 != ''">
				AND r.defined2 =#{defined2}
			</if>	
			<if test="defined3 != null and defined3 != ''">
				AND r.defined3 =#{defined3}
			</if>	
			<if test="defined4 != null and defined4 != ''">
				AND r.defined4 =#{defined4}
			</if>	
			<if test="defined5 != null and defined5 != ''">
				AND r.defined5 =#{defined5}
			</if>	
			<if test="defined6 != null and defined6 != ''">
				AND r.defined6 =#{defined6}
			</if>	
			<if test="defined7 != null and defined7 != ''">
				AND r.defined7 =#{defined7}
			</if>	
			<if test="defined8 != null and defined8 != ''">
				AND r.defined8 =#{defined8}
			</if>	
			<if test="defined9 != null and defined9 != ''">
				AND r.defined9 =#{defined9}
			</if>	
			<if test="defined10 != null and defined10 != ''">
				AND r.defined10 =#{defined10}
			</if>	
			<if test="defined11 != null and defined11 != ''">
				AND r.defined11 =#{defined11}
			</if>	
			<if test="defined12 != null and defined12 != ''">
				AND r.defined12 =#{defined12}
			</if>	
			<if test="defined13 != null and defined13 != ''">
				AND r.defined13 =#{defined13}
			</if>	
			<if test="defined14 != null and defined14 != ''">
				AND r.defined14 =#{defined14}
			</if>	
			<if test="defined15 != null and defined15 != ''">
				AND r.defined15 =#{defined15}
			</if>
			<if test=" startdefined16!= null and startdefined16 !='' ">
				AND r.defined16 >=
				 str_to_date(concat(#{startdefined16,jdbcType=VARCHAR}, '00:00:00'),
	                                       '%Y-%m-%d %H:%i:%s')
			</if>
			<if test=" enddefined16 != null and enddefined16 !='' ">
				AND r.defined16 <![CDATA[ <= ]]>
				str_to_date(concat(#{enddefined16,jdbcType=VARCHAR}, '23:59:59'),
	                                       '%Y-%m-%d %H:%i:%s')
			</if>
			<if test=" startdefined17!= null and startdefined17 !='' ">
				AND r.defined17 >=
				 str_to_date(concat(#{startdefined17,jdbcType=VARCHAR}, '00:00:00'),
	                                       '%Y-%m-%d %H:%i:%s')
			</if>
			<if test=" enddefined17 != null and enddefined17 !='' ">
				AND r.defined17 <![CDATA[ <= ]]>
				str_to_date(concat(#{enddefined17,jdbcType=VARCHAR}, '23:59:59'),
	                                       '%Y-%m-%d %H:%i:%s')
			</if>	
			<if test=" startdefined18!= null and startdefined18 !='' ">
				AND r.defined18 >=
				 str_to_date(concat(#{startdefined18,jdbcType=VARCHAR}, '00:00:00'),
	                                       '%Y-%m-%d %H:%i:%s')
			</if>
			<if test=" enddefined18 != null and enddefined18 !='' ">
				AND r.defined18 <![CDATA[ <= ]]>
				str_to_date(concat(#{enddefined18,jdbcType=VARCHAR}, '23:59:59'),
	                                       '%Y-%m-%d %H:%i:%s')
			</if>
	</select>
		
	<!-- 查询可以分配的资源 -->
	<select id="findResListByMap" resultMap="BaseResultMap" parameterType="map">
		  		   select r.res_cust_id
		           from tsm_res_cust_info r
		           where r.org_id = #{orgId} 
		           and r.type = 1
		           and r.is_del = 0
		           <if test="groupId!=null and groupId!=''">
						AND r.RES_GROUP_ID =#{groupId}
				   </if>
		           <if test="deptIds!=null">
						AND r.import_dept_id IN
						<foreach collection="deptIds" item="deptId" open="(" separator=","
							close=")">
							#{deptId}
						</foreach>	
					</if>
					<if test="starttime!=null and starttime!='' ">
					<![CDATA[
					    AND r.INPUT_DATE>=str_to_date(#{starttime}, '%Y-%m-%d %H:%i:%s') 	       		
			        ]]>
					</if>
					<if test="endtime!=null and endtime!=''">
					<![CDATA[
			             AND r.INPUT_DATE<=str_to_date(#{endtime}, '%Y-%m-%d %H:%i:%s') 	       						 
			        ]]>
					</if>		           
		            and r.status = 1
		         	order by r.input_date DESC,r.RES_CUST_ID desc
		   			limit 0,#{everyNum,jdbcType=DECIMAL}
	</select>
	<!-- 查询可以回收的资源 -->
	<select id="findRecyleRes" parameterType="map" resultMap="BaseResultMap">
			SELECT
					r.res_cust_id
				FROM
					tsm_res_cust_info r
				WHERE
					r.is_del = 0
				AND r.org_id = #{orgId}
				AND r. STATUS = 2
				AND r.type = 1
				AND r.owner_acc = #{ownerAcc}
				<if test="resGroupId != null and resGroupId != ''">
					 AND r.res_group_id = #{resGroupId,jdbcType=VARCHAR} 
				</if>
				<choose>
				  <when test='concatStatus=="1"'>
				     and r.is_concat =1
				  </when>
				  <when test='concatStatus=="2"'>
				     and r.is_concat !=1
				  </when>
				</choose>
				LIMIT #{ableRecyleRes}
	</select>
	
	<!-- 获取最大回收资源 -->
	<select id="findMaxRecyleRes" parameterType="map" resultType="int">
		SELECT
			count(r.res_cust_id) cont 
		FROM
			tsm_res_cust_info r
		WHERE
			r.is_del = 0
		AND r.org_id = #{orgId}
		AND r. STATUS = 2
		AND r.type = 1
		AND r.owner_acc = #{ownerAcc}
		<if test="resGroupId != null and resGroupId != ''">
			 AND r.res_group_id = #{resGroupId,jdbcType=VARCHAR} 
		</if>
		<choose>
			  <when test='concatStatus=="1"'>
			     and r.is_concat =1
			  </when>
			  <when test='concatStatus=="2"'>
			     and r.is_concat !=1
			  </when>
		</choose>
	</select>
	
	<!-- 资源分配和回收时修改资源 -->
	<update id="updateOptRes" parameterType="map">
                 update tsm_res_cust_info r set
                    r.status=#{status} ,
                    r.update_date=now(),
                    r.update_acc=#{updateAcc},
                    r.filter_type=0,
                    r.opreate_type=${opreateType},
                    <if test="type==2">
                         r.owner_start_date = null,
                         r.owner_acc = null,
                         r.LAST_CUST_FOLLOW_ID = null,
                         r.NEXTFOLLOW_DATE =null,
                         r.ACTION_DATE = null,
                         r.last_log_id = null,
                         r.last_Loss_Date = null,
                         r.last_Option_Id = null,
                         r.owner_start_date = null,
                         r.effective_followup_date = null,
                         r.life_code = null,
                         r.followup_date = null     
                    </if>
                    <if test="type==1">
                         r.owner_start_date = now(),
	                     r.last_cust_follow_id = null,
	                     r.action_date = null,
	                     r.nextfollow_date = null,
	                     r.AMOYTOCUSTOMER_DATE = null,
	                     r.effective_followup_date=null,
	                     r.followup_date = null ,                         
                         r.owner_acc =#{ownerAcc},
                         r.life_code=#{lifeCode}
                    </if>                   
                   where r.res_cust_id=#{custId} and r.org_id=#{orgId}  
	</update>
		
	<!-- 根据id获取资源dto -->
	<select id="findResById"  parameterType="map" resultMap="ResCustResultMap">
	   select <include refid="Base_Column_List" /> from tsm_res_cust_info t where  t.org_id=#{orgId} and t.res_cust_id=#{resId}
	</select>
	
	<!-- 根据id获取资源dto -->
	<select id="findResCallByCustId"  parameterType="map" resultMap="ResCustResultMap">
	   select t.TYPE,t.STATUS,t.NAME,t.COMPANY,t.main_linkman,t.last_Option_Id,t.IS_concat from tsm_res_cust_info t where  t.org_id=#{orgId} and t.res_cust_id=#{resCustId}
	</select>
	
	<!-- 获取该资源拨打电话的数量 -->
	<select id="getResCallNum" parameterType="map" resultMap="resCallNumMap">
            select t.id,t.cust_id,
		       IFNULL(t.call_connect, 0) call_connect,
		       IFNULL(t.call_total, 0) call_total,
		       t.org_id
		  from tsm_call_count_cust t
		 where t.org_id=#{orgId} and t.cust_id=#{resId,jdbcType=VARCHAR}
		   limit 0,1
	</select>	
	
	<!-- 取得个人客户数 -->
	<select id="findMyCustSum" parameterType="map" resultType="Integer">
		select count(1) from tsm_res_cust_info a
		where 
		org_id=#{orgId}
		and a.status = 3 and
		a.is_del = 0 and a.type = 2
		and a.owner_acc =
		#{ownerAcc,jdbcType=VARCHAR}
	</select>
	
	<!-- 根据资源id获取组名 -->
	<select id="findGroupNameByResId"  resultType="string" parameterType="map">
	    select g.group_name group_name
		  from tsm_res_cust_info t left join tsm_res_group g on t.org_id=#{orgId}  and g.org_id=#{orgId} and  t.res_group_id = g.res_group_id
		 where 
		    t.org_id=#{orgId}
		    and t.res_cust_id = #{resId}
	</select>

	<!-- 获取淘客户页面延后资源列表 -->
	<select id="findDelayCustList" parameterType="map" resultMap="BaseResultMap">
		select * from ( select t.res_cust_id,t.name,t.CALL_DATE_POSTPONED,t.reason_for_calldelay,t.telphone,t.mobilephone
		from
		tsm_res_cust_info t
		where
		 t.org_id = #{orgId}		
		and t.owner_acc = #{account}
		and t.FILTER_TYPE =2
		and t.status in (2,3)
		and t.type = 1
		and t.is_del = 0
		) s
         order by CALL_DATE_POSTPONED asc  limit 0,#{length}
	</select>
	
	<!-- 更新资源客户信息（资源状态、所有者、筛选类型、筛选次数 资源与客户通用 ）(沟通失败、信息错误、非目标客户操作时,将开始拥有时间更新为空) -->
	<update id="updateResCustInfo" parameterType="com.qftx.tsm.cust.bean.ResCustInfoBean">
		update tsm_res_cust_info set
		<if test="status != null">
			status = #{status,jdbcType=DECIMAL},
		</if>
		<if test="opreateType != null">
			OPREATE_TYPE = #{opreateType,jdbcType=DECIMAL},
		</if>
		<if test="filterType != null">
			filter_type = #{filterType,jdbcType=DECIMAL},
		</if>
		<if test="recuclingTypeDetails != null">
			RECUCLING_TYPE_DETAILS =
			#{recuclingTypeDetails,jdbcType=DECIMAL},
		</if>
		<if test="ownerAcc != null">
			owner_acc = #{ownerAcc,jdbcType=VARCHAR},
		</if>
		<if test="status == 5">
			OWNER_START_DATE = null,
		</if>
		<if test="reasonForCalldelay != null and reasonForCalldelay =='cancel'">
			REASON_FOR_CALLDELAY = null,CALL_DATE_POSTPONED = null,
		</if>
		update_acc = #{updateAcc,jdbcType=VARCHAR},
		update_date =
		#{updateDate,jdbcType=TIMESTAMP}
		where  org_id=#{orgId} and res_cust_id = #{resCustId,jdbcType=VARCHAR} 
	</update>	
	
		<!-- 修改延后呼叫的原因和待呼叫的时间 -->
	<update id="modifyDelayCallReason" parameterType="java.util.Map">
		update
		TSM_RES_CUST_INFO t set t.filter_type=2 ,t.update_date=now(),t.update_acc=#{account}, t.CALL_DATE_POSTPONED= str_to_date(#{waitDate},'%Y-%m-%d %H:%i:%s'),t.REASON_FOR_CALLDELAY=#{delayReason} where
		t.RES_CUST_ID=#{resCustId} and t.org_id =#{orgId}
	</update>
	
	<!-- 设置重点关注 -->
	<select id="updateMajorId" parameterType="map">
	     update tsm_res_cust_info t set t.IS_MAJOR=#{isMajor} where t.res_cust_id=#{custId} and t.org_id=#{orgId}
	</select>
	<!-- ============================================================================= -->
	<!-- ============================================================================= -->
	<!-- ==============================新的淘客户======================================= -->
	<!-- ============================================================================= -->
	<!-- ============================================================================= -->
	<!-- ============================================================================= -->

	<select id="findResListCount" parameterType="map" resultType="int">
            select count(t.RES_CUST_ID)
			  from 
			  tsm_res_cust_info t 			  
			  where 	
	    		   t.org_id=#{orgId}
	    		   <if test="ids != null and ids.size() > 0">
	    		   	and t.res_cust_id in 
					<foreach collection="ids" item="id" open="(" separator=","
						close=")">
						#{id}
					</foreach>	
	    		   </if>
	    		   and t.filter_type  &lt; 2
	    		   and t.owner_acc = #{ownerAcc}
				   and t.type = 1
				   and t.status in (2, 3)
				   and t.is_del = 0

				   <choose>
					   <when test='isConcat==0'>
					      and  is_concat=0
					   </when>
					   <when test='isConcat==1'>
					       and  is_concat=1
					   </when>
				   </choose>

		           <if test='resourceGroupId != null  and resourceGroupId !="all" and resourceGroupId !="today" and resourceGroupId !="temp"'>
		              and t.res_group_id = #{resourceGroupId}
		           </if>					   	   
	</select>	

	
<!-- 找出所有满足条件的资源 -->
	<select id="findTaoResList" parameterType="map" resultMap="taoResDtoList">
            select t.IS_PRECEDENCE,t.name,t.MAIN_LINKMAN,t.OWNER_ACC,t.RES_CUST_ID,0 as iscall, if(LENGTH(t.MOBILEPHONE)>0,t.MOBILEPHONE,t.TELPHONE) phone,action_date 
			  from 
			  tsm_res_cust_info t 			  
			  where 	
	    		    t.org_id=#{orgId}
	    		    <if test="ids != null and ids.size() > 0">
	    		   	and t.res_cust_id in 
					<foreach collection="ids" item="id" open="(" separator=","
						close=")">
						#{id}
					</foreach>	
	    		   </if>
	    		   and t.filter_type  &lt; 2
	    		   and t.owner_acc = #{ownerAcc}
				   and t.type = 1
				   and t.status in (2, 3)

				   and t.is_del = 0

				   <choose>
					   <when test='isConcat==0'>
					      and  is_concat=0
					   </when>
					   <when test='isConcat==1'>
					       and  is_concat=1
					   </when>
				   </choose>

		           <if test='resourceGroupId != null  and resourceGroupId !="all" and resourceGroupId !="today" and resourceGroupId !="temp"'>
		              and t.res_group_id = #{resourceGroupId}
		           </if>					   
				   <if test='orderType =="is_precedence desc"'>
				       and IS_PRECEDENCE=1 
				  </if>			   
			<choose>
				 <when test="orderType==null or orderType==''">
					 order by owner_start_date desc ,
				 </when>
				 <otherwise>
					 order by ${orderType},
				 </otherwise>
			</choose>
			 t.RES_CUST_ID desc
			   limit #{startLength},#{length}
	</select>	

	<!-- 个人 -->
	<select id="findPCustIdByPhone" parameterType="map" resultType="String">
			SELECT
				t.RES_CUST_ID
			FROM
				tsm_res_cust_info t
			WHERE
				t.org_id = #{orgId}
			AND t.OWNER_ACC = #{ownerAcc}
			and t.is_del=0
			AND T.STATUS  IN (2,3,6,7,8)
			AND 
				t.MOBILEPHONE = #{phone}
			union
			
			SELECT
				t.RES_CUST_ID
			FROM
				tsm_res_cust_info t
			WHERE
				t.org_id = #{orgId}
			AND t.OWNER_ACC = #{ownerAcc}
			and t.is_del=0
			AND T.STATUS  IN (2,3,6,7,8)
			AND t.TELPHONE = #{phone}
		
		 limit 0,1	 			
			 
	</select>
	
    <!-- 企业 -->	
	<select id="findCustIdByPhone" parameterType="map" resultType="String">
		SELECT
			s.rci_id
		FROM
			(
				SELECT
					rci_id
				FROM
					tsm_res_cust_info_detail d
				WHERE
					d.org_id = #{orgId}
				AND d.telphone = #{phone}
				union 
				SELECT
					rci_id
				FROM
					tsm_res_cust_info_detail d
				WHERE
					d.org_id = #{orgId}
				AND  d.telphonebak = #{phone}
			) s
		INNER JOIN tsm_res_cust_info t ON t.org_id = #{orgId}
		AND s.rci_id = t.res_cust_id
		and t.OWNER_ACC=#{ownerAcc}
		AND T.STATUS  IN (2,3,6,7,8)
		AND T.IS_DEL=0
			LIMIT 0,1	 
	</select>	
	<select id="findCustNum" parameterType="map" resultType="int">
		select IFNULL(count(1),0)
		  from tsm_res_cust_info t
		 where t.owner_acc = #{ownerAcc}
		   and t.status = 3
		   and t.is_del = 0
		   and t.org_id=#{orgId}
		   and t.type = 2
	</select>
	
	
		<!-- 个人 -->
	<select id="findComPCustIdByPhone" parameterType="map" resultType="String">
			SELECT
				t.RES_CUST_ID
			FROM
				tsm_res_cust_info t
			WHERE
				t.org_id = #{orgId}
			AND t.COMMON_ACC = #{ownerAcc}
			and t.is_del=0
			AND T.STATUS  IN (2,3,6,7,8)
			AND 
				t.MOBILEPHONE = #{phone}
			union
			
			SELECT
				t.RES_CUST_ID
			FROM
				tsm_res_cust_info t
			WHERE
				t.org_id = #{orgId}
			AND t.COMMON_ACC = #{ownerAcc}
			and t.is_del=0
			AND T.STATUS  IN (2,3,6,7,8)
			AND t.TELPHONE = #{phone}
		
		 limit 0,1	 			
			 
	</select>
	
    <!-- 企业 -->	
	<select id="findComMonCustIdByPhone" parameterType="map" resultType="String">
		SELECT
			s.rci_id
		FROM
			(
				SELECT
					rci_id
				FROM
					tsm_res_cust_info_detail d
				WHERE
					d.org_id = #{orgId}
				AND d.telphone = #{phone}
				union 
				SELECT
					rci_id
				FROM
					tsm_res_cust_info_detail d
				WHERE
					d.org_id = #{orgId}
				AND  d.telphonebak = #{phone}
			) s
		INNER JOIN tsm_res_cust_info t ON t.org_id = #{orgId}
		AND s.rci_id = t.res_cust_id
		AND t.COMMON_ACC=#{ownerAcc}
		AND T.STATUS  IN (2,3,6,7,8)
		AND T.IS_DEL=0
			LIMIT 0,1	 
	</select>	

	
	<!-- 手机去重验证 -->
	<select id="findDPPhone" parameterType="java.util.Map"
		resultMap="BaseResultMap">
		<choose>
		   <when test="isState==1">
			     SELECT
					t.TYPE,
					t. STATUS,
					t.RES_CUST_ID,
					t.OWNER_ACC
				 FROM
				 (
					SELECT
						d.rci_id,d.org_id
					FROM
						tsm_res_cust_info_detail d
					WHERE
						d.org_id = #{orgId}
					<if test="resCustId != null and resCustId != ''">
						and d.rci_id != #{resCustId,jdbcType=VARCHAR}
					</if>					
					AND d.is_del = 0
					AND d.telphone = #{phone}
					
			       union 
			       
					SELECT
						d.rci_id,d.org_id
					FROM
						tsm_res_cust_info_detail d
					WHERE
						d.org_id = #{orgId}
					<if test="resCustId != null and resCustId != ''">
						and d.rci_id != #{resCustId,jdbcType=VARCHAR}
					</if>					
					AND d.is_del = 0
					AND  d.telphonebak = #{phone}
				) d LEFT JOIN  tsm_res_cust_info t on t.org_id= #{orgId} and t.RES_CUST_ID = d.rci_id
	           where 
	            d.org_id=#{orgId} and t.org_id=#{orgId}
	           	<if test="validateType != null and validateType == 2">
					AND t.status = 6
				</if>
				<if test="validateType != null and validateType == 3">
					AND t.TYPE = 2
				</if>
				<if test="resCustId != null and resCustId != ''">
					and t.RES_CUST_ID != #{resCustId,jdbcType=VARCHAR}
				</if>	
				and t.is_del=0		
		   </when>
		   <otherwise>
				SELECT
					t.type,
					t. STATUS,
					t.res_cust_id,
					t.OWNER_ACC
				FROM
					tsm_res_cust_info t
				WHERE
					t.org_id = #{orgId}
					<if test="validateType != null and validateType == 2">
						AND t.status = 6
					</if>
					<if test="validateType != null and validateType == 3">
						AND t.TYPE = 2
					</if>
					<if test="resCustId != null and resCustId != ''">
						and t.RES_CUST_ID != #{resCustId,jdbcType=VARCHAR}
					</if>
                       and t.MOBILEPHONE = #{phone} 						
				    AND t.IS_DEL = 0
				union
					SELECT
						t.type,
						t. STATUS,
						t.res_cust_id,
						t.OWNER_ACC
					FROM
						tsm_res_cust_info t
					WHERE
						t.org_id = #{orgId}
						<if test="validateType != null and validateType == 2">
							AND t.status = 6
						</if>
						<if test="validateType != null and validateType == 3">
							AND t.TYPE = 2
						</if>
						<if test="resCustId != null and resCustId != ''">
							and t.RES_CUST_ID != #{resCustId,jdbcType=VARCHAR}
						</if>
                        and  t.TELPHONE=#{phone} 					
					    AND t.IS_DEL = 0		   
		   </otherwise>
		</choose>
	</select>	

	<!-- 客户单位名称去重 -->
	<select id="findDPUnit" parameterType="java.util.Map"
		resultMap="BaseResultMap">
			SELECT
				t.TYPE,t.STATUS,t.RES_CUST_ID,t.OWNER_ACC
			FROM
				tsm_res_cust_info t
			WHERE
			 t.org_id = #{orgId}
			 AND t.IS_DEL = 0
			<if test="validateType != null and validateType == 1">
				AND t.status = 6
			</if>
			<if test="validateType != null and validateType == 2">
				AND t.TYPE = 2
			</if>
	<!-- 		<if test="resCustId != null and resCustId != ''">
				and t.RES_CUST_ID != #{resCustId,jdbcType=VARCHAR}
			</if>
 -->
            <choose>
                <when test="isState==1">
                     and name=#{company}
                </when>
                <otherwise>
                     and company=#{company}
                </otherwise>
            </choose>
           
	</select>
	
	<!-- 客户单位主页去重 -->
	<select id="findDPUnitHome" parameterType="java.util.Map"
		resultMap="BaseResultMap">
			SELECT
				t.TYPE,t.STATUS,t.RES_CUST_ID,t.OWNER_ACC
			FROM
				tsm_res_cust_info t
			WHERE
			 t.org_id = #{orgId}
			 AND t.IS_DEL = 0
			<if test="validateType != null and validateType == 1">
				AND t.status = 6
			</if>
			<if test="validateType != null and validateType == 2">
				AND t.TYPE = 2
			</if>
<!--
			<if test="resCustId != null and resCustId != ''">
				and t.RES_CUST_ID != #{resCustId,jdbcType=VARCHAR}
			</if>
 -->
            and t.unithome = #{unitHome,jdbcType=VARCHAR}
	</select>
	<!-- 根据资源id获取更近信息 -->
	<select id="findOptionName" parameterType="map" resultType="string">
		SELECT
			p.OPTION_NAME
		FROM
			tsm_res_cust_info t
		LEFT JOIN tsm_data_optionlist p ON t.last_Option_Id = p.OPTIONLIST_ID
		AND p.org_id = #{orgId}
		WHERE
			t.org_id = #{orgId}
		AND t.RES_CUST_ID = #{custId}     
	</select>
	
	<select id="findResCustById" resultType="map" parameterType="map">
	     select t.RES_CUST_ID  as resId from tsm_res_cust_info t where t.org_id=#{orgId} and t.RES_CUST_ID=#{resId}
	</select>
	
	
	<update id="updateResByassignCust" parameterType="map">
		UPDATE TSM_RES_CUST_INFO
			SET followup_date = NULL,
			 effective_followup_date = NULL,
			 last_Option_Id = NULL,
			 last_Loss_Date = NULL,
			 last_log_id = NULL,
			 ACTION_DATE = NULL,
			 owner_acc = #{ownerAcc},
			 LAST_CUST_FOLLOW_ID = NULL,
			 UPDATE_ACC = #{account}, UPDATE_DATE = now(),
			 STATUS = 2,
			 FILTER_TYPE = 0,
			 source = 2,
			 OWNER_START_DATE = now(),
			 action_Date = null,
			 owner_action_date = null,
			 IS_concat = 0,
			 OPREATE_TYPE = 3,
			 life_code =#{lifeCode}
			 
			WHERE
				org_id = #{orgId}
			AND RES_CUST_ID IN 
				<foreach collection="ids" item="id" open="(" separator=","
					close=")">
					#{id}
				</foreach>	
	</update>

	<update id="updateResByRecyleCust" parameterType="map">
		UPDATE TSM_RES_CUST_INFO
		SET followup_date = NULL,
		 <if test="newResGroupId != null and newResGroupId != ''">
		 	res_group_id = #{newResGroupId},
		 </if>
		 life_code = NULL,
		 effective_followup_date = NULL,
		 last_Option_Id = NULL,
		 last_Loss_Date = NULL,
		 last_log_id = NULL,
		 owner_acc = NULL,
		 LAST_CUST_FOLLOW_ID = NULL,
		 UPDATE_ACC = #{account}, UPDATE_DATE = now(),
		 STATUS = 1,
		 is_concat=0,
		 action_date =null,
		 FILTER_TYPE = 0,
		 OWNER_START_DATE = NULL,
		 OWNER_ACTION_DATE = NULL,
		 OPREATE_TYPE = 7
		WHERE
		org_id = #{orgId}
		AND RES_CUST_ID IN 
			<foreach collection="ids" item="id" open="(" separator=","
				close=")">
				#{id}
			</foreach>	
     </update>
     
          <!-- 延后呼叫列表 -->
     <select id="findDelayResCountList" parameterType="map" resultType="int">
			SELECT count(1)
			FROM
				tsm_res_cust_info t 
			where t.org_id=#{orgId}
			and t.OWNER_ACC=#{ownerAcc}
			and t.status in (2,3)
			and t.type = 1
			and t.is_del = 0
			and FILTER_TYPE = 2
     </select>
     
     <!-- 延后呼叫列表 -->
     <select id="findDelayResList" parameterType="map" resultMap="taoResDtoList">
			SELECT
				t. NAME,
				t.MAIN_LINKMAN,
				t.OWNER_ACC,
				t.RES_CUST_ID,
				0 AS STATUS,
				0 AS iscall,
			    DATE_FORMAT(t.CALL_DATE_POSTPONED ,'%m-%d %H:%i') as CALL_DATE_POSTPONED,t.reason_for_calldelay,
			IF (
				t.MOBILEPHONE IS NOT NULL,
				t.MOBILEPHONE,
				t.TELPHONE
			) phone
			FROM
				tsm_res_cust_info t 
			where t.org_id=#{orgId}
			and t.OWNER_ACC=#{ownerAcc}
			and t.status in (2,3)
			and t.type = 1
			and t.is_del = 0
		    and FILTER_TYPE = 2
			 order by CALL_DATE_POSTPONED asc  limit 0,#{length}
     </select>
     
     <!-- 根据资源ids查下列表 -->
     <select id="findResListByIds" parameterType="map"  resultMap="BaseResultMap">
          select t.RES_CUST_ID,t.RES_GROUP_ID,t.owner_acc,t.status,t.type,t.company,t.name from tsm_res_cust_info t
             where t.org_id=#{orgId} 
             and t.RES_CUST_ID in 
			 <foreach collection="list" item="id" open="(" separator=","
				close=")">
				#{id}
			 </foreach>	
		     and t.IS_DEL=0       
     </select>
     	<update id="changeResImportDept" parameterType="map">
		UPDATE TSM_RES_CUST_INFO
		SET import_dept_id = #{deptId}
		WHERE
		org_id = #{orgId}
		AND import_dept_id IN 
			<foreach collection="deptIds" item="id" open="(" separator=","
				close=")">
				#{id}
			</foreach>	
     </update>
     
     <!-- 根据资源ids查下列表 -->
     <select id="queryResByNameOrCompany" parameterType="map"  resultMap="BaseResultMap">
          select trci.RES_CUST_ID,trci.name,trci.company from (
          select t.RES_CUST_ID,t.name,t.company from tsm_res_cust_info t
             where t.org_id=#{orgId} 
             and t.type = 2
             and t.status in (2,3,6,7,8)
		     and t.IS_DEL=0       
            <if test="ownerAccs.size() > 0">
            	and owner_acc in
            	<foreach collection="ownerAccs" item="acc" open="(" separator="," close=")">
					#{acc}
				</foreach>
            </if>
			<if test="queryText != null and queryText != ''">
	       		and t.name LIKE CONCAT('%',#{queryText},'%')
	        </if>
	        <if test="queryText != null and queryText != '' and state == 0">
	        	union
				select t.RES_CUST_ID,t.name,t.company from tsm_res_cust_info t
	             where t.org_id=#{orgId} 
	             and t.type = 2
	             and t.status in (2,3,6,7,8)
			     and t.IS_DEL=0 
			     <if test="ownerAccs.size() > 0">
	            	and owner_acc in
	            	<foreach collection="ownerAccs" item="acc" open="(" separator="," close=")">
						#{acc}
					</foreach>
	             </if>
			     <if test="queryText != null and queryText != ''">
		       		and t.company LIKE CONCAT('%',#{queryText},'%')
		         </if>      	        
	        </if>)trci
	        <choose>
	        	<when test="state == 0">
	        		order by trci.company asc
	        	</when>
	        	<when test="state == 1">
	        		order by trci.name asc
	        	</when>
	        </choose>
	        limit 30
     </select>
     
     
     <update id="updateResByDeptId" parameterType="map">
		UPDATE TSM_RES_CUST_INFO
		SET UPDATE_ACC = #{account}, 
		UPDATE_DATE = now(),
		import_dept_id = #{deptId}
		WHERE
		ORG_ID = #{orgId}
		AND RES_CUST_ID IN 
		<foreach collection="ids" item="id" open="(" separator="," close=")">
			#{id}
		</foreach>	
     </update>
     
</mapper>



